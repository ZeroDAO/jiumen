import{c as pt}from"./@antv-806868f3.js";var $e={ALT:1,CAT:2,REP:3,RNM:4,TRG:5,TBS:6,TLS:7,UDT:11,AND:12,NOT:13,BKR:14,BKA:15,BKN:16,ABG:17,AEN:18,ACTIVE:100,MATCH:101,EMPTY:102,NOMATCH:103,SEM_PRE:200,SEM_POST:201,SEM_OK:300,SEM_SKIP:301,ATTR_N:400,ATTR_R:401,ATTR_MR:402,LOOKAROUND_NONE:500,LOOKAROUND_AHEAD:501,LOOKAROUND_BEHIND:502,BKR_MODE_UM:601,BKR_MODE_PM:602,BKR_MODE_CS:603,BKR_MODE_CI:604},me={},Xe={CLASS_MONOSPACE:"apg-mono",CLASS_ACTIVE:"apg-active",CLASS_EMPTY:"apg-empty",CLASS_MATCH:"apg-match",CLASS_NOMATCH:"apg-nomatch",CLASS_LOOKAHEAD:"apg-lh-match",CLASS_LOOKBEHIND:"apg-lb-match",CLASS_REMAINDER:"apg-remainder",CLASS_CTRLCHAR:"apg-ctrl-char",CLASS_LINEEND:"apg-line-end",CLASS_ERROR:"apg-error",CLASS_PHRASE:"apg-phrase",CLASS_EMPTYPHRASE:"apg-empty-phrase",CLASS_STATE:"apg-state",CLASS_STATS:"apg-stats",CLASS_TRACE:"apg-trace",CLASS_GRAMMAR:"apg-grammar",CLASS_RULES:"apg-rules",CLASS_RULESLINK:"apg-rules-link",CLASS_ATTRIBUTES:"apg-attrs"},De={},ke={};const bt=pt,je=4294967292,qe=4294967293,Ze=4294967294,Tt=4294967295,j=[0,1,3,7,15,31,63,127,255,511,1023],Be=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"],Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),Ae=[];Ft.forEach(i=>{Ae.push(i.charCodeAt(0))});ke.utf8={encode(i){const t=[];return i.forEach(e=>{if(e>=0&&e<=127)t.push(e);else if(e<=2047)t.push(192+(e>>6&j[5])),t.push(128+(e&j[6]));else if(e<55296||e>57343&&e<=65535)t.push(224+(e>>12&j[4])),t.push(128+(e>>6&j[6])),t.push(128+(e&j[6]));else if(e>=65536&&e<=1114111){const n=e>>16&j[5];t.push(240+(n>>2)),t.push(128+((n&j[2])<<4)+(e>>12&j[4])),t.push(128+(e>>6&j[6])),t.push(128+(e&j[6]))}else throw new RangeError(`utf8.encode: character out of range: char: ${e}`)}),Buffer.from(t)},decode(i,t){function e(b,p){if((p&192)!==128)return qe;const I=((b&j[5])<<6)+(p&j[6]);return I<128?je:I}function n(b,p,I){if((I&192)!==128||(p&192)!==128)return qe;const l=((b&j[4])<<12)+((p&j[6])<<6)+(I&j[6]);return l<2048?je:l>=55296&&l<=57343?Ze:l}function s(b,p,I,l){if((l&192)!==128||(I&192)!==128||(p&192)!==128)return qe;const S=(((b&j[3])<<2)+(p>>4&j[2])<<16)+((p&j[4])<<12)+((I&j[6])<<6)+(l&j[6]);return S<65536?je:S>1114111?Ze:S}let a,h,c,L,P,m;const d=i.length;let O=t?3:0;const H=[];for(;O<d;){h=i[O],a=Tt;const b=!0;for(;b;){if(h>=0&&h<=127){a=h,m=1;break}if(c=O+1,c<d&&h>=194&&h<=223){a=e(h,i[c]),m=2;break}if(L=O+2,L<d&&h>=224&&h<=239){a=n(h,i[c],i[L]),m=3;break}if(P=O+3,P<d&&h>=240&&h<=244){a=s(h,i[c],i[L],i[P]),m=4;break}break}if(a>1114111){const p=`byte[${O}]`;throw a===Tt?new RangeError(`utf8.decode: ill-formed UTF8 byte sequence found at: ${p}`):a===qe?new RangeError(`utf8.decode: illegal trailing byte found at: ${p}`):a===Ze?new RangeError(`utf8.decode: code point out of range found at: ${p}`):a===je?new RangeError(`utf8.decode: non-shortest form found at: ${p}`):new RangeError(`utf8.decode: unrecognized error found at: ${p}`)}H.push(a),O+=m}return H}};ke.utf16be={encode(i){const t=[];let e,n,s;for(let a=0;a<i.length;a+=1)if(e=i[a],e>=0&&e<=55295||e>=57344&&e<=65535)t.push(e>>8&j[8]),t.push(e&j[8]);else if(e>=65536&&e<=1114111)s=e-65536,n=55296+(s>>10),s=56320+(s&j[10]),t.push(n>>8&j[8]),t.push(n&j[8]),t.push(s>>8&j[8]),t.push(s&j[8]);else throw new RangeError(`utf16be.encode: UTF16BE value out of range: char[${a}]: ${e}`);return Buffer.from(t)},decode(i,t){if(i.length%2>0)throw new RangeError(`utf16be.decode: data length must be even multiple of 2: length: ${i.length}`);const e=[],n=i.length;let s=t?2:0,a=0,h,c,L,P,m,d;for(;s<n;){for(;;){if(L=s+1,L<n){if(m=(i[s]<<8)+i[L],m<55296||m>57343){h=m,c=2;break}if(P=s+3,P<n&&(d=(i[s+2]<<8)+i[P],m<=56319&&d>=56320&&d<=57343)){h=65536+(m-55296<<10)+(d-56320),c=4;break}}throw new RangeError(`utf16be.decode: ill-formed UTF16BE byte sequence found: byte[${s}]`)}e[a++]=h,s+=c}return e}};ke.utf16le={encode(i){const t=[];let e,n,s;for(let a=0;a<i.length;a+=1)if(e=i[a],e>=0&&e<=55295||e>=57344&&e<=65535)t.push(e&j[8]),t.push(e>>8&j[8]);else if(e>=65536&&e<=1114111)s=e-65536,n=55296+(s>>10),s=56320+(s&j[10]),t.push(n&j[8]),t.push(n>>8&j[8]),t.push(s&j[8]),t.push(s>>8&j[8]);else throw new RangeError(`utf16le.encode: UTF16LE value out of range: char[${a}]: ${e}`);return Buffer.from(t)},decode(i,t){if(i.length%2>0)throw new RangeError(`utf16le.decode: data length must be even multiple of 2: length: ${i.length}`);const e=[],n=i.length;let s=t?2:0,a=0,h,c,L,P,m,d;for(;s<n;){for(;;){if(L=s+1,L<n){if(m=(i[L]<<8)+i[s],m<55296||m>57343){h=m,c=2;break}if(P=s+3,P<n&&(d=(i[P]<<8)+i[s+2],m<=56319&&d>=56320&&d<=57343)){h=65536+(m-55296<<10)+(d-56320),c=4;break}}throw new RangeError(`utf16le.decode: ill-formed UTF16LE byte sequence found: byte[${s}]`)}e[a++]=h,s+=c}return e}};ke.utf32be={encode(i){const t=Buffer.alloc(i.length*4);let e=0;return i.forEach(n=>{if(n>=55296&&n<=57343||n>1114111)throw new RangeError(`utf32be.encode: UTF32BE character code out of range: char[${e/4}]: ${n}`);t[e++]=n>>24&j[8],t[e++]=n>>16&j[8],t[e++]=n>>8&j[8],t[e++]=n&j[8]}),t},decode(i,t){if(i.length%4>0)throw new RangeError(`utf32be.decode: UTF32BE byte length must be even multiple of 4: length: ${i.length}`);const e=[];let n=t?4:0;for(;n<i.length;n+=4){const s=(i[n]<<24)+(i[n+1]<<16)+(i[n+2]<<8)+i[n+3];if(s>=55296&&s<=57343||s>1114111)throw new RangeError(`utf32be.decode: UTF32BE character code out of range: char[${n/4}]: ${s}`);e.push(s)}return e}};ke.utf32le={encode(i){const t=Buffer.alloc(i.length*4);let e=0;return i.forEach(n=>{if(n>=55296&&n<=57343||n>1114111)throw new RangeError(`utf32le.encode: UTF32LE character code out of range: char[${e/4}]: ${n}`);t[e++]=n&j[8],t[e++]=n>>8&j[8],t[e++]=n>>16&j[8],t[e++]=n>>24&j[8]}),t},decode(i,t){if(i.length%4>0)throw new RangeError(`utf32be.decode: UTF32LE byte length must be even multiple of 4: length: ${i.length}`);const e=[];let n=t?4:0;for(;n<i.length;n+=4){const s=(i[n+3]<<24)+(i[n+2]<<16)+(i[n+1]<<8)+i[n];if(s>=55296&&s<=57343||s>1114111)throw new RangeError(`utf32le.encode: UTF32LE character code out of range: char[${n/4}]: ${s}`);e.push(s)}return e}};ke.uint7={encode(i){const t=Buffer.alloc(i.length);for(let e=0;e<i.length;e+=1){if(i[e]>127)throw new RangeError(`uint7.encode: UINT7 character code out of range: char[${e}]: ${i[e]}`);t[e]=i[e]}return t},decode(i){const t=[];for(let e=0;e<i.length;e+=1){if(i[e]>127)throw new RangeError(`uint7.decode: UINT7 character code out of range: byte[${e}]: ${i[e]}`);t[e]=i[e]}return t}};ke.uint8={encode(i){const t=Buffer.alloc(i.length);for(let e=0;e<i.length;e+=1){if(i[e]>255)throw new RangeError(`uint8.encode: UINT8 character code out of range: char[${e}]: ${i[e]}`);t[e]=i[e]}return t},decode(i){const t=[];for(let e=0;e<i.length;e+=1)t[e]=i[e];return t}};ke.uint16be={encode(i){const t=Buffer.alloc(i.length*2);let e=0;return i.forEach(n=>{if(n>65535)throw new RangeError(`uint16be.encode: UINT16BE character code out of range: char[${e/2}]: ${n}`);t[e++]=n>>8&j[8],t[e++]=n&j[8]}),t},decode(i){if(i.length%2>0)throw new RangeError(`uint16be.decode: UINT16BE byte length must be even multiple of 2: length: ${i.length}`);const t=[];for(let e=0;e<i.length;e+=2)t.push((i[e]<<8)+i[e+1]);return t}};ke.uint16le={encode(i){const t=Buffer.alloc(i.length*2);let e=0;return i.forEach(n=>{if(n>65535)throw new RangeError(`uint16le.encode: UINT16LE character code out of range: char[${e/2}]: ${n}`);t[e++]=n&j[8],t[e++]=n>>8&j[8]}),t},decode(i){if(i.length%2>0)throw new RangeError(`uint16le.decode: UINT16LE byte length must be even multiple of 2: length: ${i.length}`);const t=[];for(let e=0;e<i.length;e+=2)t.push((i[e+1]<<8)+i[e]);return t}};ke.uint32be={encode(i){const t=Buffer.alloc(i.length*4);let e=0;return i.forEach(n=>{t[e++]=n>>24&j[8],t[e++]=n>>16&j[8],t[e++]=n>>8&j[8],t[e++]=n&j[8]}),t},decode(i){if(i.length%4>0)throw new RangeError(`uint32be.decode: UINT32BE byte length must be even multiple of 4: length: ${i.length}`);const t=[];for(let e=0;e<i.length;e+=4)t.push((i[e]<<24)+(i[e+1]<<16)+(i[e+2]<<8)+i[e+3]);return t}};ke.uint32le={encode(i){const t=Buffer.alloc(i.length*4);let e=0;return i.forEach(n=>{t[e++]=n&j[8],t[e++]=n>>8&j[8],t[e++]=n>>16&j[8],t[e++]=n>>24&j[8]}),t},decode(i){if(i.length%4>0)throw new RangeError(`uint32le.decode: UINT32LE byte length must be even multiple of 4: length: ${i.length}`);const t=[];for(let e=0;e<i.length;e+=4)t.push((i[e+3]<<24)+(i[e+2]<<16)+(i[e+1]<<8)+i[e]);return t}};ke.string={encode(i){return bt.utf16le.encode(i).toString("utf16le")},decode(i){return bt.utf16le.decode(Buffer.from(i,"utf16le"),0)}};ke.escaped={encode(i){const t=[];for(let e=0;e<i.length;e+=1){const n=i[e];if(n===96)t.push(n),t.push(n);else if(n===10)t.push(n);else if(n>=32&&n<=126)t.push(n);else{let s="";if(n>=0&&n<=31)s+=`\`x${Be[n]}`;else if(n>=127&&n<=255)s+=`\`x${Be[n]}`;else if(n>=256&&n<=65535)s+=`\`u${Be[n>>8&j[8]]}${Be[n&j[8]]}`;else if(n>=65536&&n<=4294967295){s+="`u{";const h=n>>24&j[8];h>0&&(s+=Be[h]),s+=`${Be[n>>16&j[8]]+Be[n>>8&j[8]]+Be[n&j[8]]}}`}else throw new Error("escape.encode(char): char > 0xffffffff not allowed");Buffer.from(s).forEach(h=>{t.push(h)})}}return Buffer.from(t)},decode(i){function t(d){return d>=48&&d<=57||d>=65&&d<=70||d>=97&&d<=102}function e(d,O,H){const b={char:null,nexti:d+2,error:!0};if(d+1<O&&t(H[d])&&t(H[d+1])){const p=String.fromCodePoint(H[d],H[d+1]);b.char=parseInt(p,16),Number.isNaN(b.char)||(b.error=!1)}return b}function n(d,O,H){const b={char:null,nexti:d+4,error:!0};if(d+3<O&&t(H[d])&&t(H[d+1])&&t(H[d+2])&&t(H[d+3])){const p=String.fromCodePoint(H[d],H[d+1],H[d+2],H[d+3]);b.char=parseInt(p,16),Number.isNaN(b.char)||(b.error=!1)}return b}function s(d,O,H){const b={char:null,nexti:d+4,error:!0};let p="";for(;d<O&&t(H[d]);)p+=String.fromCodePoint(H[d]),d+=1;return b.char=parseInt(p,16),H[d]===125&&!Number.isNaN(b.char)&&(b.error=!1),b.nexti=d+1,b}const a=[],h=i.length;let c,L,P,m=0;for(;m<h;){for(;;){if(P=!0,i[m]!==96){a.push(i[m]),m+=1,P=!1;break}if(c=m+1,c>=h)break;if(i[c]===96){a.push(96),m+=2,P=!1;break}if(i[c]===120){if(L=e(c+1,h,i),L.error)break;a.push(L.char),m=L.nexti,P=!1;break}if(i[c]===117){if(i[c+1]===123){if(L=s(c+2,h,i),L.error)break;a.push(L.char),m=L.nexti,P=!1;break}if(L=n(c+1,h,i),L.error)break;a.push(L.char),m=L.nexti,P=!1;break}break}if(P)throw new Error(`escaped.decode: ill-formed escape sequence at buf[${m}]`)}return a}};const Ge=13,Ce=10;ke.lineEnds={crlf(i){const t=[];let e=0;for(;e<i.length;)switch(i[e]){case Ge:e+1<i.length&&i[e+1]===Ce?e+=2:e+=1,t.push(Ge),t.push(Ce);break;case Ce:t.push(Ge),t.push(Ce),e+=1;break;default:t.push(i[e]),e+=1;break}return t.length>0&&t[t.length-1]!==Ce&&(t.push(Ge),t.push(Ce)),t},lf(i){const t=[];let e=0;for(;e<i.length;)switch(i[e]){case Ge:e+1<i.length&&i[e+1]===Ce?e+=2:e+=1,t.push(Ce);break;case Ce:t.push(Ce),e+=1;break;default:t.push(i[e]),e+=1;break}return t.length>0&&t[t.length-1]!==Ce&&t.push(Ce),t}};ke.base64={encode(i){if(i.length===0)return Buffer.alloc(0);let t,e,n,s=i.length%3;s=s>0?3-s:0;let a=(i.length+s)/3;const h=Buffer.alloc(a*4);s>0&&(a-=1),t=0,e=0;for(let c=0;c<a;c+=1)n=i[t++]<<16,n+=i[t++]<<8,n+=i[t++],h[e++]=Ae[n>>18&j[6]],h[e++]=Ae[n>>12&j[6]],h[e++]=Ae[n>>6&j[6]],h[e++]=Ae[n&j[6]];if(s===0)return h;if(s===1)return n=i[t++]<<16,n+=i[t]<<8,h[e++]=Ae[n>>18&j[6]],h[e++]=Ae[n>>12&j[6]],h[e++]=Ae[n>>6&j[6]],h[e]=Ae[64],h;if(s===2)return n=i[t]<<16,h[e++]=Ae[n>>18&j[6]],h[e++]=Ae[n>>12&j[6]],h[e++]=Ae[64],h[e]=Ae[64],h},decode(i){function t(m){const d=[];let O=0;for(let H=0;H<m.length;H+=1){const b=m[H],p=!0;for(;p&&!(b===32||b===9||b===10||b===13);){if(b>=65&&b<=90){d.push(b-65);break}if(b>=97&&b<=122){d.push(b-71);break}if(b>=48&&b<=57){d.push(b+4);break}if(b===43){d.push(62);break}if(b===47){d.push(63);break}if(b===61){d.push(64),O+=1;break}throw new RangeError(`base64.decode: invalid character buf[${H}]: ${b}`)}}if(d.length%4>0)throw new RangeError(`base64.decode: string length not integral multiple of 4: ${d.length}`);switch(O){case 0:break;case 1:if(d[d.length-1]!==64)throw new RangeError("base64.decode: one tail character found: not last character");break;case 2:if(d[d.length-1]!==64||d[d.length-2]!==64)throw new RangeError("base64.decode: two tail characters found: not last characters");break;default:throw new RangeError(`base64.decode: more than two tail characters found: ${O}`)}return{tail:O,buf:Buffer.from(d)}}if(i.length===0)return Buffer.alloc(0);const e=t(i),{tail:n}=e,s=e.buf;let a,h,c,L=s.length/4;const P=Buffer.alloc(L*3-n);n>0&&(L-=1),h=0,a=0;for(let m=0;m<L;m+=1)c=s[a++]<<18,c+=s[a++]<<12,c+=s[a++]<<6,c+=s[a++],P[h++]=c>>16&j[8],P[h++]=c>>8&j[8],P[h++]=c&j[8];return n===1&&(c=s[a++]<<18,c+=s[a++]<<12,c+=s[a]<<6,P[h++]=c>>16&j[8],P[h]=c>>8&j[8]),n===2&&(c=s[a++]<<18,c+=s[a++]<<12,P[h]=c>>16&j[8]),P},toString(i){if(i.length%4>0)throw new RangeError(`base64.toString: input buffer length not multiple of 4: ${i.length}`);let t="",e=0;function n(a,h,c,L){switch(e){case 76:t+=`\r
${a}${h}${c}${L}`,e=4;break;case 75:t+=`${a}\r
${h}${c}${L}`,e=3;break;case 74:t+=`${a+h}\r
${c}${L}`,e=2;break;case 73:t+=`${a+h+c}\r
${L}`,e=1;break;default:t+=a+h+c+L,e+=4;break}}function s(a){return a>=65&&a<=90||a>=97&&a<=122||a>=48&&a<=57||a===43||a===47||a===61}for(let a=0;a<i.length;a+=4){for(let h=a;h<a+4;h+=1)if(!s(i[h]))throw new RangeError(`base64.toString: buf[${h}]: ${i[h]} : not valid base64 character code`);n(String.fromCharCode(i[a]),String.fromCharCode(i[a+1]),String.fromCharCode(i[a+2]),String.fromCharCode(i[a+3]))}return t}};const Et=pt,ce=ke,Ye="UTF8",ft="UTF16",Se="UTF16BE",Oe="UTF16LE",dt="UTF32",Me="UTF32BE",Le="UTF32LE",Ue="UINT7",Rt="ASCII",Nt="BINARY",ve="UINT8",Bt="UINT16",We="UINT16LE",Ke="UINT16BE",_t="UINT32",Je="UINT32LE",Ie="UINT32BE",Qe="ESCAPED",_e="STRING",Ut=function(t){t.type=Ye;const e=t.data;t.bom=0,e.length>=3&&e[0]===239&&e[1]===187&&e[2]===191&&(t.bom=3)},vt=function(t){const e=t.data;switch(t.bom=0,t.type){case ft:t.type=Se,e.length>=2&&(e[0]===254&&e[1]===255?t.bom=2:e[0]===255&&e[1]===254&&(t.type=Oe,t.bom=2));break;case Se:if(t.type=Se,e.length>=2){if(e[0]===254&&e[1]===255)t.bom=2;else if(e[0]===255&&e[1]===254)throw new TypeError(`src type: "${Se}" specified but BOM is for "${Oe}"`)}break;case Oe:if(t.type=Oe,e.length>=0){if(e[0]===254&&e[1]===255)throw new TypeError(`src type: "${Oe}" specified but BOM is for "${Se}"`);e[0]===255&&e[1]===254&&(t.bom=2)}break;default:throw new TypeError(`UTF16 BOM: src type "${t.type}" unrecognized`)}},Kt=function(t){const e=t.data;switch(t.bom=0,t.type){case dt:t.type=Me,e.length>=4&&(e[0]===0&&e[1]===0&&e[2]===254&&e[3]===255&&(t.bom=4),e[0]===255&&e[1]===254&&e[2]===0&&e[3]===0&&(t.type=Le,t.bom=4));break;case Me:if(t.type=Me,e.length>=4&&(e[0]===0&&e[1]===0&&e[2]===254&&e[3]===255&&(t.bom=4),e[0]===255&&e[1]===254&&e[2]===0&&e[3]===0))throw new TypeError(`src type: ${Me} specified but BOM is for ${Le}"`);break;case Le:if(t.type=Le,e.length>=4){if(e[0]===0&&e[1]===0&&e[2]===254&&e[3]===255)throw new TypeError(`src type: "${Le}" specified but BOM is for "${Me}"`);e[0]===255&&e[1]===254&&e[2]===0&&e[3]===0&&(t.bom=4)}break;default:throw new TypeError(`UTF32 BOM: src type "${t.type}" unrecognized`)}},It=function(t,e){function n(a){const h={type:"",base64:!1},L=/^(base64:)?([a-zA-Z0-9]+)$/i.exec(a);return L&&(L[2]&&(h.type=L[2].toUpperCase()),L[1]&&(h.base64=!0)),h}if(typeof t!="string"||t==="")throw new TypeError(`type: "${t}" not recognized`);const s=n(t.toUpperCase());if(s.base64){if(s.type===_e)throw new TypeError(`type: "${t} "BASE64:" prefix not allowed with type ${_e}`);if(Buffer.isBuffer(e))s.data=ce.base64.decode(e);else if(typeof e=="string"){const a=Buffer.from(e,"ascii");s.data=ce.base64.decode(a)}else throw new TypeError(`type: "${t} unrecognized data type: typeof(data): ${typeof e}`)}else s.data=e;switch(s.type){case Ye:Ut(s);break;case ft:case Se:case Oe:vt(s);break;case dt:case Me:case Le:Kt(s);break;case Bt:s.type=Ke;break;case _t:s.type=Ie;break;case Rt:s.type=Ue;break;case Nt:s.type=ve;break;case Ue:case ve:case We:case Ke:case Je:case Ie:case _e:case Qe:break;default:throw new TypeError(`type: "${t}" not recognized`)}if(s.type===_e){if(typeof s.data!="string")throw new TypeError(`type: "${t}" but data is not a string`)}else if(!Buffer.isBuffer(s.data))throw new TypeError(`type: "${t}" but data is not a Buffer`);return s},Gt=function(t,e){function n(a){let h,c;const L={crlf:!1,lf:!1,base64:!1,type:""},P=!0;for(;P;){if(c=a,h=a.slice(0,5),h==="CRLF:"){L.crlf=!0,c=a.slice(5);break}if(h=a.slice(0,3),h==="LF:"){L.lf=!0,c=a.slice(3);break}break}return h=c.split(":"),h.length===1?L.type=h[0]:h.length===2&&h[1]==="BASE64"&&(L.base64=!0,L.type=h[0]),L}if(!Array.isArray(e))throw new TypeError(`dst chars: not array: "${typeof e}`);if(typeof t!="string")throw new TypeError(`dst type: not string: "${typeof t}`);const s=n(t.toUpperCase());switch(s.type){case Ye:case Se:case Oe:case Me:case Le:case Ue:case ve:case We:case Ke:case Je:case Ie:case Qe:break;case _e:if(s.base64)throw new TypeError(`":BASE64" suffix not allowed with type ${_e}`);break;case Rt:s.type=Ue;break;case Nt:s.type=ve;break;case ft:s.type=Se;break;case dt:s.type=Me;break;case Bt:s.type=Ke;break;case _t:s.type=Ie;break;default:throw new TypeError(`dst type unrecognized: "${t}" : must have form [crlf:|lf:]type[:base64]`)}return s},et=function(t,e){switch(t){case Ye:return ce.utf8.encode(e);case Se:return ce.utf16be.encode(e);case Oe:return ce.utf16le.encode(e);case Me:return ce.utf32be.encode(e);case Le:return ce.utf32le.encode(e);case Ue:return ce.uint7.encode(e);case ve:return ce.uint8.encode(e);case Ke:return ce.uint16be.encode(e);case We:return ce.uint16le.encode(e);case Ie:return ce.uint32be.encode(e);case Je:return ce.uint32le.encode(e);case _e:return ce.string.encode(e);case Qe:return ce.escaped.encode(e);default:throw new TypeError(`encode type "${t}" not recognized`)}},Dt=function(t){switch(t.type){case Ye:return ce.utf8.decode(t.data,t.bom);case Oe:return ce.utf16le.decode(t.data,t.bom);case Se:return ce.utf16be.decode(t.data,t.bom);case Me:return ce.utf32be.decode(t.data,t.bom);case Le:return ce.utf32le.decode(t.data,t.bom);case Ue:return ce.uint7.decode(t.data);case ve:return ce.uint8.decode(t.data);case Ke:return ce.uint16be.decode(t.data);case We:return ce.uint16le.decode(t.data);case Ie:return ce.uint32be.decode(t.data);case Je:return ce.uint32le.decode(t.data);case _e:return ce.string.decode(t.data);case Qe:return ce.escaped.decode(t.data);default:throw new TypeError(`decode type "${t.type}" not recognized`)}};De.decode=function(t,e){const n=It(t,e);return Dt(n)};De.encode=function(t,e){let n,s;const a=Gt(t,e);return a.crlf?(n=ce.lineEnds.crlf(e),s=et(a.type,n)):a.lf?(n=ce.lineEnds.lf(e),s=et(a.type,n)):s=et(a.type,e),a.base64&&(s=ce.base64.encode(s)),s};De.convert=function(t,e,n){return Et.encode(n,Et.decode(t,e))};var Ht=function(){return`/* This file automatically generated by jsonToless() and LESS. */
.apg-mono {
  font-family: monospace;
}
.apg-active {
  font-weight: bold;
  color: #000000;
}
.apg-match {
  font-weight: bold;
  color: #264BFF;
}
.apg-empty {
  font-weight: bold;
  color: #0fbd0f;
}
.apg-nomatch {
  font-weight: bold;
  color: #FF4000;
}
.apg-lh-match {
  font-weight: bold;
  color: #1A97BA;
}
.apg-lb-match {
  font-weight: bold;
  color: #5F1687;
}
.apg-remainder {
  font-weight: bold;
  color: #999999;
}
.apg-ctrl-char {
  font-weight: bolder;
  font-style: italic;
  font-size: 0.6em;
}
.apg-line-end {
  font-weight: bold;
  color: #000000;
}
.apg-error {
  font-weight: bold;
  color: #FF4000;
}
.apg-phrase {
  color: #000000;
  background-color: #8caae6;
}
.apg-empty-phrase {
  color: #0fbd0f;
}
table.apg-state {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: left;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-state th,
table.apg-state td {
  text-align: left;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-state th:nth-last-child(2),
table.apg-state td:nth-last-child(2) {
  text-align: right;
}
table.apg-state caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-stats {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-stats th,
table.apg-stats td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-stats caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-trace {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-trace caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-trace th,
table.apg-trace td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-trace th:last-child,
table.apg-trace th:nth-last-child(2),
table.apg-trace td:last-child,
table.apg-trace td:nth-last-child(2) {
  text-align: left;
}
table.apg-grammar {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-grammar caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-grammar th,
table.apg-grammar td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-grammar th:last-child,
table.apg-grammar td:last-child {
  text-align: left;
}
table.apg-rules {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-rules caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-rules th,
table.apg-rules td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-rules a {
  color: #003399 !important;
}
table.apg-rules a:hover {
  color: #8caae6 !important;
}
table.apg-attrs {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: center;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-attrs caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-attrs th,
table.apg-attrs td {
  text-align: center;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-attrs th:nth-child(1),
table.apg-attrs th:nth-child(2),
table.apg-attrs th:nth-child(3) {
  text-align: right;
}
table.apg-attrs td:nth-child(1),
table.apg-attrs td:nth-child(2),
table.apg-attrs td:nth-child(3) {
  text-align: right;
}
table.apg-attrs a {
  color: #003399 !important;
}
table.apg-attrs a:hover {
  color: #8caae6 !important;
}
`};const we=Xe,mt=De,Yt=Ht,de=$e,He="utilities.js: ",Re=pt,Pe=function(i,t,e){let n,s=t;const a=!0;for(;a;){if(i<=0){s=0,n=0;break}if(typeof s!="number"){s=0,n=i;break}if(s>=i){s=i,n=i;break}if(typeof e!="number"){n=i;break}if(n=s+e,n>i){n=i;break}break}return{beg:s,end:n}};me.htmlToPage=function(i,t){let e;if(typeof i!="string")throw new Error(`${He}htmlToPage: input HTML is not a string`);typeof t!="string"?e="htmlToPage":e=t;let n="";return n+=`<!DOCTYPE html>
`,n+=`<html lang="en">
`,n+=`<head>
`,n+=`<meta charset="utf-8">
`,n+=`<title>${e}</title>
`,n+=`<style>
`,n+=Yt(),n+=`</style>
`,n+=`</head>
<body>
`,n+=`<p>${new Date}</p>
`,n+=i,n+=`</body>
</html>
`,n};me.parserResultToHtml=function(i,t){let e=null;typeof t=="string"&&t!==""&&(e=t);let n,s;i.success===!0?n=`<span class="${we.CLASS_MATCH}">true</span>`:n=`<span class="${we.CLASS_NOMATCH}">false</span>`,i.state===de.EMPTY?s=`<span class="${we.CLASS_EMPTY}">EMPTY</span>`:i.state===de.MATCH?s=`<span class="${we.CLASS_MATCH}">MATCH</span>`:i.state===de.NOMATCH?s=`<span class="${we.CLASS_NOMATCH}">NOMATCH</span>`:s=`<span class="${we.CLASS_NOMATCH}">unrecognized</span>`;let a="";return a+=`<table class="${we.CLASS_STATE}">
`,e&&(a+=`<caption>${e}</caption>
`),a+=`<tr><th>state item</th><th>value</th><th>description</th></tr>
`,a+=`<tr><td>parser success</td><td>${n}</td>
`,a+=`<td><span class="${we.CLASS_MATCH}">true</span> if the parse succeeded,
`,a+=` <span class="${we.CLASS_NOMATCH}">false</span> otherwise`,a+=`<br><i>NOTE: for success, entire string must be matched</i></td></tr>
`,a+=`<tr><td>parser state</td><td>${s}</td>
`,a+=`<td><span class="${we.CLASS_EMPTY}">EMPTY</span>, `,a+=`<span class="${we.CLASS_MATCH}">MATCH</span> or 
`,a+=`<span class="${we.CLASS_NOMATCH}">NOMATCH</span></td></tr>
`,a+=`<tr><td>string length</td><td>${i.length}</td><td>length of the input (sub)string</td></tr>
`,a+=`<tr><td>matched length</td><td>${i.matched}</td><td>number of input string characters matched</td></tr>
`,a+=`<tr><td>max matched</td><td>${i.maxMatched}</td><td>maximum number of input string characters matched</td></tr>
`,a+=`<tr><td>max tree depth</td><td>${i.maxTreeDepth}</td><td>maximum depth of the parse tree reached</td></tr>
`,a+=`<tr><td>node hits</td><td>${i.nodeHits}</td><td>number of parse tree node hits (opcode function calls)</td></tr>
`,a+=`<tr><td>input length</td><td>${i.inputLength}</td><td>length of full input string</td></tr>
`,a+=`<tr><td>sub-string begin</td><td>${i.subBegin}</td><td>sub-string first character index</td></tr>
`,a+=`<tr><td>sub-string end</td><td>${i.subEnd}</td><td>sub-string end-of-string index</td></tr>
`,a+=`<tr><td>sub-string length</td><td>${i.subLength}</td><td>sub-string length</td></tr>
`,a+=`</table>
`,a};me.charsToString=function(i,t,e){let n,s;if(typeof t=="number"){if(t>=i.length)return"";n=t<0?0:t}else n=0;if(typeof e=="number"){if(e<=0)return"";s=e>i.length-n?i.length:n+e}else s=i.length;return n<s?mt.encode("UTF16LE",i.slice(n,s)).toString("utf16le"):""};me.stringToChars=function(i){return mt.decode("STRING",i)};me.opcodeToString=function(i){let t="unknown";switch(i){case de.ALT:t="ALT";break;case de.CAT:t="CAT";break;case de.RNM:t="RNM";break;case de.UDT:t="UDT";break;case de.AND:t="AND";break;case de.NOT:t="NOT";break;case de.REP:t="REP";break;case de.TRG:t="TRG";break;case de.TBS:t="TBS";break;case de.TLS:t="TLS";break;case de.BKR:t="BKR";break;case de.BKA:t="BKA";break;case de.BKN:t="BKN";break;case de.ABG:t="ABG";break;case de.AEN:t="AEN";break;default:throw new Error("unrecognized opcode")}return t};me.stateToString=function(i){let t="unknown";switch(i){case de.ACTIVE:t="ACTIVE";break;case de.MATCH:t="MATCH";break;case de.EMPTY:t="EMPTY";break;case de.NOMATCH:t="NOMATCH";break;default:throw new Error("unrecognized state")}return t};me.asciiChars=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","TAB","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","&nbsp;","!","&#34;","#","$","%","&#38;","&#39;","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","&#60;","=","&#62;","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","&#92;","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL"];me.charToHex=function(i){let t=i.toString(16).toUpperCase();switch(t.length){case 1:case 3:case 7:t=`0${t}`;break;case 2:case 6:t=`00${t}`;break;case 4:break;case 5:t=`000${t}`;break;default:throw new Error("unrecognized option")}return t};me.charsToDec=function(i,t,e){let n="";if(!Array.isArray(i))throw new Error(`${He}charsToDec: input must be an array of integers`);const s=Pe(i.length,t,e);if(s.end>s.beg){n+=i[s.beg];for(let a=s.beg+1;a<s.end;a+=1)n+=`,${i[a]}`}return n};me.charsToHex=function(i,t,e){let n="";if(!Array.isArray(i))throw new Error(`${He}charsToHex: input must be an array of integers`);const s=Pe(i.length,t,e);if(s.end>s.beg){n+=`\\x${Re.charToHex(i[s.beg])}`;for(let a=s.beg+1;a<s.end;a+=1)n+=`,\\x${Re.charToHex(i[a])}`}return n};me.charsToHtmlEntities=function(i,t,e){let n="";if(!Array.isArray(i))throw new Error(`${He}charsToHex: input must be an array of integers`);const s=Pe(i.length,t,e);if(s.end>s.beg)for(let a=s.beg;a<s.end;a+=1)n+=`&#x${i[a].toString(16)};`;return n};function Vt(i){return!(i>=55296&&i<=57343||i>1114111)}me.charsToUnicode=function(i,t,e){let n="";if(!Array.isArray(i))throw new Error(`${He}charsToUnicode: input must be an array of integers`);const s=Pe(i.length,t,e);if(s.end>s.beg)for(let a=s.beg;a<s.end;a+=1)Vt(i[a])?n+=`&#${i[a]};`:n+=` U+${Re.charToHex(i[a])}`;return n};me.charsToJsUnicode=function(i,t,e){let n="";if(!Array.isArray(i))throw new Error(`${He}charsToJsUnicode: input must be an array of integers`);const s=Pe(i.length,t,e);if(s.end>s.beg){n+=`\\u${Re.charToHex(i[s.beg])}`;for(let a=s.beg+1;a<s.end;a+=1)n+=`,\\u${Re.charToHex(i[a])}`}return n};me.charsToAscii=function(i,t,e){let n="";if(!Array.isArray(i))throw new Error(`${He}charsToAscii: input must be an array of integers`);const s=Pe(i.length,t,e);for(let a=s.beg;a<s.end;a+=1){const h=i[a];h>=32&&h<=126?n+=String.fromCharCode(h):n+=`\\x${Re.charToHex(h)}`}return n};me.charsToAsciiHtml=function(i,t,e){if(!Array.isArray(i))throw new Error(`${He}charsToAsciiHtml: input must be an array of integers`);let n="",s;const a=Pe(i.length,t,e);for(let h=a.beg;h<a.end;h+=1)s=i[h],s<32||s===127?n+=`<span class="${we.CLASS_CTRLCHAR}">${Re.asciiChars[s]}</span>`:s>127?n+=`<span class="${we.CLASS_CTRLCHAR}">U+${Re.charToHex(s)}</span>`:n+=Re.asciiChars[s];return n};me.stringToAsciiHtml=function(i){const t=mt.decode("STRING",i);return this.charsToAsciiHtml(t)};var zt=function(){const t=$e,e=me,n="ast.js: ",s=this;let a=null,h=null,c=null,L=0;const P=[],m=[],d=[],O=[];this.callbacks=[],this.astObject="astObject",this.init=function(p,I,l){d.length=0,O.length=0,P.length=0,L=0,a=p,h=I,c=l;let S;const q=[];for(S=0;S<a.length;S+=1)q.push(a[S].lower);for(S=0;S<h.length;S+=1)q.push(h[S].lower);for(L=a.length+h.length,S=0;S<L;S+=1)P[S]=!1,m[S]=null;for(const z in s.callbacks){const J=z.toLowerCase();if(S=q.indexOf(J),S<0)throw new Error(`${n}init: node '${z}' not a rule or udt name`);typeof s.callbacks[z]=="function"&&(P[S]=!0,m[S]=s.callbacks[z]),s.callbacks[z]===!0&&(P[S]=!0)}},this.ruleDefined=function(p){return P[p]!==!1},this.udtDefined=function(p){return P[a.length+p]!==!1},this.down=function(p,I){const l=O.length;return d.push(l),O.push({name:I,thisIndex:l,thatIndex:null,state:t.SEM_PRE,callbackIndex:p,phraseIndex:null,phraseLength:null,stack:d.length}),l},this.up=function(p,I,l,S){const q=O.length,z=d.pop();return O.push({name:I,thisIndex:q,thatIndex:z,state:t.SEM_POST,callbackIndex:p,phraseIndex:l,phraseLength:S,stack:d.length}),O[z].thatIndex=q,O[z].phraseIndex=l,O[z].phraseLength=S,q},this.translate=function(p){let I,l,S;for(let q=0;q<O.length;q+=1)S=O[q],l=m[S.callbackIndex],S.state===t.SEM_PRE?l!==null&&(I=l(t.SEM_PRE,c,S.phraseIndex,S.phraseLength,p),I===t.SEM_SKIP&&(q=S.thatIndex)):l!==null&&l(t.SEM_POST,c,S.phraseIndex,S.phraseLength,p)},this.setLength=function(p){O.length=p,p>0?d.length=O[p-1].stack:d.length=0},this.getLength=function(){return O.length};function H(b){let p="";for(let I=0;I<b;I+=1)p+=" ";return p}this.toXml=function(p){let I=e.charsToDec,l="decimal integer character codes";if(typeof p=="string"&&p.length>=3){const z=p.slice(0,3).toLowerCase();z==="asc"?(I=e.charsToAscii,l="ASCII for printing characters, hex for non-printing"):z==="hex"?(I=e.charsToHex,l="hexadecimal integer character codes"):z==="uni"&&(I=e.charsToUnicode,l="Unicode UTF-32 integer character codes")}let S="",q=0;return S+=`<?xml version="1.0" encoding="utf-8"?>
`,S+=`<root nodes="${O.length/2}" characters="${c.length}">
`,S+=`<!-- input string, ${l} -->
`,S+=H(q+2),S+=I(c),S+=`
`,O.forEach(z=>{z.state===t.SEM_PRE?(q+=1,S+=H(q),S+=`<node name="${z.name}" index="${z.phraseIndex}" length="${z.phraseLength}">
`,S+=H(q+2),S+=I(c,z.phraseIndex,z.phraseLength),S+=`
`):(S+=H(q),S+=`</node><!-- name="${z.name}" -->
`,q-=1)}),S+=`</root>
`,S},this.phrases=function(){const p={};let I,l;for(I=0;I<O.length;I+=1)l=O[I],l.state===t.SEM_PRE&&(Array.isArray(p[l.name])||(p[l.name]=[]),p[l.name].push({index:l.phraseIndex,length:l.phraseLength}));return p}},Pt=function(){const t="circular-buffer.js: ";let e=-1,n=0;this.init=function(a){if(typeof a!="number"||a<=0)throw new Error(`${t}init: circular buffer size must an integer > 0`);n=Math.ceil(a),e=-1},this.increment=function(){return e+=1,(e+n)%n},this.maxSize=function(){return n},this.items=function(){return e+1},this.getListIndex=function(a){return e===-1||a<0||a>e||e-a>=n?-1:(a+n)%n},this.forEach=function(a){if(e!==-1){if(e<n){for(let h=0;h<=e;h+=1)a(h,h);return}for(let h=e-n+1;h<=e;h+=1){const c=(h+n)%n;a(c,h)}}}},jt=function(){const t=$e,e=me,n="parser.js: ",s=this;let a;this.ast=null,this.stats=null,this.trace=null,this.callbacks=[];let h=null,c=null,L,P,m,d,O=0,H=0,b=0,p=null,I=null,l=null,S=null,q=null,z=0,J=1/0,k=1/0;const D=function(g,r,u){const _=`${n}evaluateRule(): `;if(g>=l.length)throw new Error(`${_}rule index: ${g} out of range`);if(r>=m)throw new Error(`${_}phrase index: ${r} out of range`);const{length:N}=h;h.push({type:t.RNM,index:g}),a(N,r,u),h.pop()},ee=function(x,g,r){const u=`${n}evaluateUdt(): `;if(x>=S.length)throw new Error(`${u}udt index: ${x} out of range`);if(g>=m)throw new Error(`${u}phrase index: ${g} out of range`);const{length:_}=h;h.push({type:t.UDT,empty:S[x].empty,index:x}),a(_,g,r),h.pop()},oe=function(){O=0,H=0,b=0,z=0,d=[{lookAround:t.LOOKAROUND_NONE,anchor:0,charsEnd:0,charsLength:0}],l=null,S=null,c=null,L=0,P=0,m=0,p=null,I=null,q=null,h=null},C=function(){const x=[],g=function(){const u={};l.forEach(_=>{_.isBkr&&(u[_.lower]=null)}),S.length>0&&S.forEach(_=>{_.isBkr&&(u[_.lower]=null)}),x.push(u)},r=function(){const u=x[x.length-1],_={};for(const N in u)_[N]=u[N];return _};this.push=function(){x.push(r())},this.pop=function(_){let N=_;if(N||(N=x.length-1),N<1||N>x.length)throw new Error(`${n}backRef.pop(): bad length: ${N}`);return x.length=N,x[x.length-1]},this.length=function(){return x.length},this.savePhrase=function(_,N,G){x[x.length-1][_]={phraseIndex:N,phraseLength:G}},this.getPhrase=function(u){return x[x.length-1][u]},g()},$=function(){const g=this;this.state=t.ACTIVE,this.phraseLength=0,this.ruleIndex=0,this.udtIndex=0,this.lookAround=d[d.length-1],this.uFrame=new C,this.pFrame=new C,this.evaluateRule=D,this.evaluateUdt=ee,this.refresh=function(){g.state=t.ACTIVE,g.phraseLength=0,g.lookAround=d[d.length-1]}},M=function(){return d[d.length-1]},w=function(){return d.length>1},K=function(){return d[d.length-1].lookAround===t.LOOKAROUND_BEHIND},ie=function(){const x=`${n}initializeAst(): `,g=!0;for(;g;){if(s.ast===void 0){s.ast=null;break}if(s.ast===null)break;if(s.ast.astObject!=="astObject")throw new Error(`${x}ast object not recognized`);break}s.ast!==null&&s.ast.init(l,S,c)},le=function(){const x=`${n}initializeTrace(): `,g=!0;for(;g;){if(s.trace===void 0){s.trace=null;break}if(s.trace===null)break;if(s.trace.traceObject!=="traceObject")throw new Error(`${x}trace object not recognized`);break}s.trace!==null&&s.trace.init(l,S,c)},se=function(){const x=`${n}initializeStats(): `,g=!0;for(;g;){if(s.stats===void 0){s.stats=null;break}if(s.stats===null)break;if(s.stats.statsObject!=="statsObject")throw new Error(`${x}stats object not recognized`);break}s.stats!==null&&s.stats.init(l,S)},ge=function(x){const g=`${n}initializeGrammar(): `;if(!x)throw new Error(`${g}grammar object undefined`);if(x.grammarObject!=="grammarObject")throw new Error(`${g}bad grammar object`);l=x.rules,S=x.udts},ye=function(x){const g=`${n}initializeStartRule(): `;let r=null;if(typeof x=="number"){if(x>=l.length)throw new Error(`${g}start rule index too large: max: ${l.length}: index: ${x}`);r=x}else if(typeof x=="string"){const u=x.toLowerCase();for(let _=0;_<l.length;_+=1)if(u===l[_].lower){r=l[_].index;break}if(r===null)throw new Error(`${g}start rule name '${x}' not recognized`)}else throw new Error(`${g}type of start rule '${typeof x}' not recognized`);return r},Y=function(g,r,u){const _=`${n}initializeInputChars(): `;let N=g,G=r,te=u;if(N===void 0)throw new Error(`${_}input string is undefined`);if(N===null)throw new Error(`${_}input string is null`);if(typeof N=="string")N=e.stringToChars(N);else if(!Array.isArray(N))throw new Error(`${_}input string is not a string or array`);if(N.length>0&&typeof N[0]!="number")throw new Error(`${_}input string not an array of integers`);if(typeof G!="number")G=0;else if(G=Math.floor(G),G<0||G>N.length)throw new Error(`${_}input beginning index out of range: ${G}`);if(typeof te!="number")te=N.length-G;else if(te=Math.floor(te),te<0||te>N.length-G)throw new Error(`${_}input length out of range: ${te}`);c=N,L=G,P=te,m=L+P},X=function(){const x=`${n}initializeCallbacks(): `;let g;for(p=[],I=[],g=0;g<l.length;g+=1)p[g]=null;for(g=0;g<S.length;g+=1)I[g]=null;let r;const u=[];for(g=0;g<l.length;g+=1)u.push(l[g].lower);for(g=0;g<S.length;g+=1)u.push(S[g].lower);for(const _ in s.callbacks){if(g=u.indexOf(_.toLowerCase()),g<0)throw new Error(`${x}syntax callback '${_}' not a rule or udt name`);if(r=s.callbacks[_],r||(r=null),typeof r=="function"||r===null)g<l.length?p[g]=r:I[g-l.length]=r;else throw new Error(`${x}syntax callback[${_}] must be function reference or 'false' (false/null/undefined/etc.)`)}for(g=0;g<S.length;g+=1)if(I[g]===null)throw new Error(`${x}all UDT callbacks must be defined. UDT callback[${S[g].lower}] not a function reference`)};this.setMaxTreeDepth=function(x){if(typeof x!="number")throw new Error(`parser: max tree depth must be integer > 0: ${x}`);if(J=Math.floor(x),J<=0)throw new Error(`parser: max tree depth must be integer > 0: ${x}`)},this.setMaxNodeHits=function(x){if(typeof x!="number")throw new Error(`parser: max node hits must be integer > 0: ${x}`);if(k=Math.floor(x),k<=0)throw new Error(`parser: max node hits must be integer > 0: ${x}`)};const V=function(x,g,r){let u;const _=`${n}parse(): `;ge(x);const N=ye(g);X(),le(),se(),ie();const G=new $;switch(r!=null&&(q=r),h=[{type:t.RNM,index:N}],a(0,L,G),h=null,G.state){case t.ACTIVE:throw new Error(`${_}final state should never be 'ACTIVE'`);case t.NOMATCH:u=!1;break;case t.EMPTY:case t.MATCH:G.phraseLength===P?u=!0:u=!1;break;default:throw new Error("unrecognized state")}return{success:u,state:G.state,length:P,matched:G.phraseLength,maxMatched:z,maxTreeDepth:H,nodeHits:b,inputLength:c.length,subBegin:L,subEnd:m,subLength:P}};this.parseSubstring=function(g,r,u,_,N,G){return oe(),Y(u,_,N),V(g,r,G)},this.parse=function(g,r,u,_){return oe(),Y(u,0,u.length),V(g,r,_)};const T=function(x,g,r){const u=h[x];for(let _=0;_<u.children.length&&(a(u.children[_],g,r),r.state===t.NOMATCH);_+=1);},he=function(x,g,r){let u,_,N,G;const te=h[x],be=r.uFrame.length(),fe=r.pFrame.length();s.ast&&(_=s.ast.getLength()),u=!0,N=g,G=0;for(let ae=0;ae<te.children.length;ae+=1)if(a(te.children[ae],N,r),r.state===t.NOMATCH){u=!1;break}else N+=r.phraseLength,G+=r.phraseLength;u?(r.state=G===0?t.EMPTY:t.MATCH,r.phraseLength=G):(r.state=t.NOMATCH,r.phraseLength=0,r.uFrame.pop(be),r.pFrame.pop(fe),s.ast&&s.ast.setLength(_))},Te=function(x,g,r){let u,_,N,G;const te=h[x];_=g,N=0,G=0;const be=r.uFrame.length(),fe=r.pFrame.length();s.ast&&(u=s.ast.getLength());const ae=!0;for(;ae&&!(_>=m||(a(x+1,_,r),r.state===t.NOMATCH)||r.state===t.EMPTY||(G+=1,N+=r.phraseLength,_+=r.phraseLength,G===te.max)););r.state===t.EMPTY||G>=te.min?(r.state=N===0?t.EMPTY:t.MATCH,r.phraseLength=N):(r.state=t.NOMATCH,r.phraseLength=0,r.uFrame.pop(be),r.pFrame.pop(fe),s.ast&&s.ast.setLength(u))},xe=function(x,g,r,u){if(g.phraseLength>r){let _=`${n}opRNM(${x.name}): callback function error: `;throw _+=`sysData.phraseLength: ${g.phraseLength}`,_+=` must be <= remaining chars: ${r}`,new Error(_)}switch(g.state){case t.ACTIVE:if(u!==!0)throw new Error(`${n}opRNM(${x.name}): callback function return error. ACTIVE state not allowed.`);break;case t.EMPTY:g.phraseLength=0;break;case t.MATCH:g.phraseLength===0&&(g.state=t.EMPTY);break;case t.NOMATCH:g.phraseLength=0;break;default:throw new Error(`${n}opRNM(${x.name}): callback function return error. Unrecognized return state: ${g.state}`)}},ue=function(x,g,r){let u,_,N,G,te,be;const fe=h[x],ae=l[fe.index],Ee=p[ae.index],Ne=!w();if(Ne&&(_=s.ast&&s.ast.ruleDefined(fe.index),_&&(u=s.ast.getLength(),s.ast.down(fe.index,l[fe.index].name)),G=r.uFrame.length(),te=r.pFrame.length(),r.uFrame.push(),r.pFrame.push(),be=r.pFrame,r.pFrame=new C),Ee===null)N=h,h=ae.opcodes,a(0,g,r),h=N;else{const gt=m-g;r.ruleIndex=ae.index,Ee(r,c,g,q),xe(ae,r,gt,!0),r.state===t.ACTIVE&&(N=h,h=ae.opcodes,a(0,g,r),h=N,r.ruleIndex=ae.index,Ee(r,c,g,q),xe(ae,r,gt,!1))}Ne&&(_&&(r.state===t.NOMATCH?s.ast.setLength(u):s.ast.up(fe.index,ae.name,g,r.phraseLength)),r.pFrame=be,r.state===t.NOMATCH?(r.uFrame.pop(G),r.pFrame.pop(te)):ae.isBkr&&(r.pFrame.savePhrase(ae.lower,g,r.phraseLength),r.uFrame.savePhrase(ae.lower,g,r.phraseLength)))},E=function(x,g,r){if(g.phraseLength>r){let u=`${n}opUDT(${x.name}): callback function error: `;throw u+=`sysData.phraseLength: ${g.phraseLength}`,u+=` must be <= remaining chars: ${r}`,new Error(u)}switch(g.state){case t.ACTIVE:throw new Error(`${n}opUDT(${x.name}): callback function return error. ACTIVE state not allowed.`);case t.EMPTY:if(x.empty===!1)throw new Error(`${n}opUDT(${x.name}): callback function return error. May not return EMPTY.`);g.phraseLength=0;break;case t.MATCH:if(g.phraseLength===0){if(x.empty===!1)throw new Error(`${n}opUDT(${x.name}): callback function return error. May not return EMPTY.`);g.state=t.EMPTY}break;case t.NOMATCH:g.phraseLength=0;break;default:throw new Error(`${n}opUDT(${x.name}): callback function return error. Unrecognized return state: ${g.state}`)}},f=function(x,g,r){let u,_,N,G,te,be;const fe=h[x],ae=S[fe.index];r.UdtIndex=ae.index;const Ee=!w();Ee&&(N=s.ast&&s.ast.udtDefined(fe.index),N&&(_=l.length+fe.index,u=s.ast.getLength(),s.ast.down(_,ae.name)),G=r.uFrame.length(),te=r.pFrame.length(),r.uFrame.push(),r.pFrame.push(),be=r.pFrame,r.pFrame=new C);const Ne=m-g;I[fe.index](r,c,g,q),E(ae,r,Ne),Ee&&(N&&(r.state===t.NOMATCH?s.ast.setLength(u):s.ast.up(_,ae.name,g,r.phraseLength)),r.pFrame=be,r.state===t.NOMATCH?(r.uFrame.pop(G),r.pFrame.pop(te)):ae.isBkr&&(r.pFrame.savePhrase(ae.lower,g,r.phraseLength),r.uFrame.savePhrase(ae.lower,g,r.phraseLength)))},A=function(x,g,r){d.push({lookAround:t.LOOKAROUND_AHEAD,anchor:g,charsEnd:m,charsLength:P}),m=c.length,P=c.length-L,a(x+1,g,r);const u=d.pop();switch(m=u.charsEnd,P=u.charsLength,r.phraseLength=0,r.state){case t.EMPTY:r.state=t.EMPTY;break;case t.MATCH:r.state=t.EMPTY;break;case t.NOMATCH:r.state=t.NOMATCH;break;default:throw new Error(`opAND: invalid state ${r.state}`)}},v=function(x,g,r){d.push({lookAround:t.LOOKAROUND_AHEAD,anchor:g,charsEnd:m,charsLength:P}),m=c.length,P=c.length-L,a(x+1,g,r);const u=d.pop();switch(m=u.charsEnd,P=u.charsLength,r.phraseLength=0,r.state){case t.EMPTY:case t.MATCH:r.state=t.NOMATCH;break;case t.NOMATCH:r.state=t.EMPTY;break;default:throw new Error(`opNOT: invalid state ${r.state}`)}},W=function(x,g,r){const u=h[x];r.state=t.NOMATCH,g<m&&u.min<=c[g]&&c[g]<=u.max&&(r.state=t.MATCH,r.phraseLength=1)},Q=function(x,g,r){let u;const _=h[x],N=_.string.length;if(r.state=t.NOMATCH,g+N<=m){for(u=0;u<N;u+=1)if(c[g+u]!==_.string[u])return;r.state=t.MATCH,r.phraseLength=N}},ne=function(x,g,r){let u,_;const N=h[x];r.state=t.NOMATCH;const G=N.string.length;if(G===0){r.state=t.EMPTY;return}if(g+G<=m){for(u=0;u<G;u+=1)if(_=c[g+u],_>=65&&_<=90&&(_+=32),_!==N.string[u])return;r.state=t.MATCH,r.phraseLength=G}},B=function(x,g,r){r.state=t.NOMATCH,r.phraseLength=0,r.state=g===0?t.EMPTY:t.NOMATCH},U=function(x,g,r){r.state=t.NOMATCH,r.phraseLength=0,r.state=g===c.length?t.EMPTY:t.NOMATCH},y=function(x,g,r){let u,_,N,G;const te=h[x];r.state=t.NOMATCH,te.index<l.length?G=l[te.index].lower:G=S[te.index-l.length].lower;const be=te.bkrMode===t.BKR_MODE_PM?r.pFrame.getPhrase(G):r.uFrame.getPhrase(G),fe=te.bkrCase===t.BKR_MODE_CI;if(be===null)return;const ae=be.phraseIndex,Ee=be.phraseLength;if(Ee===0){r.state=t.EMPTY;return}if(g+Ee<=m){if(fe){for(u=0;u<Ee;u+=1)if(_=c[g+u],N=c[ae+u],_>=65&&_<=90&&(_+=32),N>=65&&N<=90&&(N+=32),_!==N)return;r.state=t.MATCH,r.phraseLength=Ee}else for(u=0;u<Ee;u+=1)if(_=c[g+u],N=c[ae+u],_!==N)return;r.state=t.MATCH,r.phraseLength=Ee}},F=function(x,g,r){switch(d.push({lookAround:t.LOOKAROUND_BEHIND,anchor:g}),a(x+1,g,r),d.pop(),r.phraseLength=0,r.state){case t.EMPTY:r.state=t.EMPTY;break;case t.MATCH:r.state=t.EMPTY;break;case t.NOMATCH:r.state=t.NOMATCH;break;default:throw new Error(`opBKA: invalid state ${r.state}`)}},o=function(x,g,r){switch(d.push({lookAround:t.LOOKAROUND_BEHIND,anchor:g}),a(x+1,g,r),d.pop(),r.phraseLength=0,r.state){case t.EMPTY:case t.MATCH:r.state=t.NOMATCH;break;case t.NOMATCH:r.state=t.EMPTY;break;default:throw new Error(`opBKN: invalid state ${r.state}`)}},R=function(x,g,r){let u,_,N,G;const te=h[x],be=r.uFrame.length(),fe=r.pFrame.length();s.ast&&(_=s.ast.getLength()),u=!0,N=g,G=0;for(let ae=te.children.length-1;ae>=0;ae-=1)if(a(te.children[ae],N,r),N-=r.phraseLength,G+=r.phraseLength,r.state===t.NOMATCH){u=!1;break}u?(r.state=G===0?t.EMPTY:t.MATCH,r.phraseLength=G):(r.state=t.NOMATCH,r.phraseLength=0,r.uFrame.pop(be),r.pFrame.pop(fe),s.ast&&s.ast.setLength(_))},Z=function(x,g,r){let u,_,N,G;const te=h[x];_=g,N=0,G=0;const be=r.uFrame.length(),fe=r.pFrame.length();s.ast&&(u=s.ast.getLength());const ae=!0;for(;ae&&!(_<=0||(a(x+1,_,r),r.state===t.NOMATCH)||r.state===t.EMPTY||(G+=1,N+=r.phraseLength,_-=r.phraseLength,G===te.max)););r.state===t.EMPTY||G>=te.min?(r.state=N===0?t.EMPTY:t.MATCH,r.phraseLength=N):(r.state=t.NOMATCH,r.phraseLength=0,r.uFrame.pop(be),r.pFrame.pop(fe),s.ast&&s.ast.setLength(u))},re=function(x,g,r){const u=h[x];if(r.state=t.NOMATCH,r.phraseLength=0,g>0){const _=c[g-1];u.min<=_&&_<=u.max&&(r.state=t.MATCH,r.phraseLength=1)}},pe=function(x,g,r){let u;const _=h[x];r.state=t.NOMATCH;const N=_.string.length,G=g-N;if(G>=0){for(u=0;u<N;u+=1)if(c[G+u]!==_.string[u])return;r.state=t.MATCH,r.phraseLength=N}},Fe=function(x,g,r){let u;const _=h[x];r.state=t.NOMATCH;const N=_.string.length;if(N===0){r.state=t.EMPTY;return}const G=g-N;if(G>=0){for(let te=0;te<N;te+=1)if(u=c[G+te],u>=65&&u<=90&&(u+=32),u!==_.string[te])return;r.state=t.MATCH,r.phraseLength=N}},ze=function(x,g,r){let u,_,N,G;const te=h[x];r.state=t.NOMATCH,r.phraseLength=0,te.index<l.length?G=l[te.index].lower:G=S[te.index-l.length].lower;const be=te.bkrMode===t.BKR_MODE_PM?r.pFrame.getPhrase(G):r.uFrame.getPhrase(G),fe=te.bkrCase===t.BKR_MODE_CI;if(be===null)return;const ae=be.phraseIndex,Ee=be.phraseLength;if(Ee===0){r.state=t.EMPTY,r.phraseLength=0;return}const Ne=g-Ee;if(Ne>=0){if(fe){for(u=0;u<Ee;u+=1)if(_=c[Ne+u],N=c[ae+u],_>=65&&_<=90&&(_+=32),N>=65&&N<=90&&(N+=32),_!==N)return;r.state=t.MATCH,r.phraseLength=Ee}else for(u=0;u<Ee;u+=1)if(_=c[Ne+u],N=c[ae+u],_!==N)return;r.state=t.MATCH,r.phraseLength=Ee}};a=function(g,r,u){let _=!0;const N=h[g];if(b+=1,b>k)throw new Error(`parser: maximum number of node hits exceeded: ${k}`);if(O+=1,O>H&&(H=O,H>J))throw new Error(`parser: maximum parse tree depth exceeded: ${J}`);if(u.refresh(),s.trace!==null){const G=M();s.trace.down(N,u.state,r,u.phraseLength,G.anchor,G.lookAround)}if(K())switch(N.type){case t.ALT:T(g,r,u);break;case t.CAT:R(g,r,u);break;case t.REP:Z(g,r,u);break;case t.RNM:ue(g,r,u);break;case t.UDT:f(g,r,u);break;case t.AND:A(g,r,u);break;case t.NOT:v(g,r,u);break;case t.TRG:re(g,r,u);break;case t.TBS:pe(g,r,u);break;case t.TLS:Fe(g,r,u);break;case t.BKR:ze(g,r,u);break;case t.BKA:F(g,r,u);break;case t.BKN:o(g,r,u);break;case t.ABG:B(g,r,u);break;case t.AEN:U(g,r,u);break;default:_=!1;break}else switch(N.type){case t.ALT:T(g,r,u);break;case t.CAT:he(g,r,u);break;case t.REP:Te(g,r,u);break;case t.RNM:ue(g,r,u);break;case t.UDT:f(g,r,u);break;case t.AND:A(g,r,u);break;case t.NOT:v(g,r,u);break;case t.TRG:W(g,r,u);break;case t.TBS:Q(g,r,u);break;case t.TLS:ne(g,r,u);break;case t.BKR:y(g,r,u);break;case t.BKA:F(g,r,u);break;case t.BKN:o(g,r,u);break;case t.ABG:B(g,r,u);break;case t.AEN:U(g,r,u);break;default:_=!1;break}if(!w()&&r+u.phraseLength>z&&(z=r+u.phraseLength),s.stats!==null&&s.stats.collect(N,u),s.trace!==null){const G=M();s.trace.up(N,u.state,r,u.phraseLength,G.anchor,G.lookAround)}return O-=1,_}},qt=function(){const t=$e,e=me,n=Xe,s="stats.js: ";let a=[],h=[];const c=[];let L;const P=[],m=[];this.statsObject="statsObject";const d="stats",O=function(k,D){return k.lower<D.lower?-1:k.lower>D.lower?1:0},H=function(k,D){return k.total<D.total?1:k.total>D.total?-1:O(k,D)},b=function(k,D){return k.index<D.index?-1:k.index>D.index?1:0},p=function(){this.empty=0,this.match=0,this.nomatch=0,this.total=0},I=function(){c.length=0,L=new p,c[t.ALT]=new p,c[t.CAT]=new p,c[t.REP]=new p,c[t.RNM]=new p,c[t.TRG]=new p,c[t.TBS]=new p,c[t.TLS]=new p,c[t.UDT]=new p,c[t.AND]=new p,c[t.NOT]=new p,c[t.BKR]=new p,c[t.BKA]=new p,c[t.BKN]=new p,c[t.ABG]=new p,c[t.AEN]=new p,P.length=0;for(let k=0;k<a.length;k+=1)P.push({empty:0,match:0,nomatch:0,total:0,name:a[k].name,lower:a[k].lower,index:a[k].index});if(h.length>0){m.length=0;for(let k=0;k<h.length;k+=1)m.push({empty:0,match:0,nomatch:0,total:0,name:h[k].name,lower:h[k].lower,index:h[k].index})}},l=function(k,D){switch(k.total+=1,D){case t.EMPTY:k.empty+=1;break;case t.MATCH:k.match+=1;break;case t.NOMATCH:k.nomatch+=1;break;default:throw new Error(`${s}collect(): incStat(): unrecognized state: ${D}`)}},S=function(k,D){let ee="";return ee+="<tr>",ee+=`<td class="${n.CLASS_ACTIVE}">${k}</td>`,ee+=`<td class="${n.CLASS_EMPTY}">${D.empty}</td>`,ee+=`<td class="${n.CLASS_MATCH}">${D.match}</td>`,ee+=`<td class="${n.CLASS_NOMATCH}">${D.nomatch}</td>`,ee+=`<td class="${n.CLASS_ACTIVE}">${D.total}</td>`,ee+=`</tr>
`,ee},q=function(){let k="";return k+=S("ALT",c[t.ALT]),k+=S("CAT",c[t.CAT]),k+=S("REP",c[t.REP]),k+=S("RNM",c[t.RNM]),k+=S("TRG",c[t.TRG]),k+=S("TBS",c[t.TBS]),k+=S("TLS",c[t.TLS]),k+=S("UDT",c[t.UDT]),k+=S("AND",c[t.AND]),k+=S("NOT",c[t.NOT]),k+=S("BKR",c[t.BKR]),k+=S("BKA",c[t.BKA]),k+=S("BKN",c[t.BKN]),k+=S("ABG",c[t.ABG]),k+=S("AEN",c[t.AEN]),k+=S("totals",L),k},z=function(){let k="";k+=`<tr><th></th><th></th><th></th><th></th><th></th></tr>
`,k+=`<tr><th>rules</th><th></th><th></th><th></th><th></th></tr>
`;for(let D=0;D<a.length;D+=1)P[D].total>0&&(k+="<tr>",k+=`<td class="${n.CLASS_ACTIVE}">${P[D].name}</td>`,k+=`<td class="${n.CLASS_EMPTY}">${P[D].empty}</td>`,k+=`<td class="${n.CLASS_MATCH}">${P[D].match}</td>`,k+=`<td class="${n.CLASS_NOMATCH}">${P[D].nomatch}</td>`,k+=`<td class="${n.CLASS_ACTIVE}">${P[D].total}</td>`,k+=`</tr>
`);if(h.length>0){k+=`<tr><th></th><th></th><th></th><th></th><th></th></tr>
`,k+=`<tr><th>udts</th><th></th><th></th><th></th><th></th></tr>
`;for(let D=0;D<h.length;D+=1)m[D].total>0&&(k+="<tr>",k+=`<td class="${n.CLASS_ACTIVE}">${m[D].name}</td>`,k+=`<td class="${n.CLASS_EMPTY}">${m[D].empty}</td>`,k+=`<td class="${n.CLASS_MATCH}">${m[D].match}</td>`,k+=`<td class="${n.CLASS_NOMATCH}">${m[D].nomatch}</td>`,k+=`<td class="${n.CLASS_ACTIVE}">${m[D].total}</td>`,k+=`</tr>
`)}return k};this.validate=function(k){let D=!1;return typeof k=="string"&&d===k&&(D=!0),D},this.init=function(k,D){a=k,h=D,I()},this.collect=function(k,D){l(L,D.state,D.phraseLength),l(c[k.type],D.state,D.phraseLength),k.type===t.RNM&&l(P[k.index],D.state,D.phraseLength),k.type===t.UDT&&l(m[k.index],D.state,D.phraseLength)},this.toHtml=function(k,D){let ee="";ee+=`<table class="${n.CLASS_STATS}">
`,typeof D=="string"&&(ee+=`<caption>${D}</caption>
`),ee+=`<tr><th class="${n.CLASS_ACTIVE}">ops</th>
`,ee+=`<th class="${n.CLASS_EMPTY}">EMPTY</th>
`,ee+=`<th class="${n.CLASS_MATCH}">MATCH</th>
`,ee+=`<th class="${n.CLASS_NOMATCH}">NOMATCH</th>
`,ee+=`<th class="${n.CLASS_ACTIVE}">totals</th></tr>
`;const oe=!0;for(;oe;){if(k===void 0){ee+=q();break}if(k===null){ee+=q();break}if(k==="ops"){ee+=q();break}if(k==="index"){P.sort(b),m.length>0&&m.sort(b),ee+=q(),ee+=z();break}if(k==="hits"){P.sort(H),m.length>0&&m.sort(b),ee+=q(),ee+=z();break}if(k==="alpha"){P.sort(O),m.length>0&&m.sort(O),ee+=q(),ee+=z();break}break}return ee+=`</table>
`,ee},this.toHtmlPage=function(k,D,ee){return e.htmlToPage(this.toHtml(k,D),ee)}},Xt=function(){const t=me,e=Xe,n=new Pt,s=$e,a="trace.js: ",h=this,c=16,L=10,P=8,m=32,d=80,O=5,H=[];let b=5e3,p=-1,I=0,l=0;const S=[];let q=null,z=null,J=null;const k=[],D=[],ee=`<span class="${e.CLASS_LINEEND}">&bull;</span>`,oe=`<span class="${e.CLASS_LINEEND}">&hellip;</span>`,C=`<span class="${e.CLASS_EMPTY}">&#120634;</span>`,$=function(){const E=function(A){k[s.ALT]=A,k[s.CAT]=A,k[s.REP]=A,k[s.TLS]=A,k[s.TBS]=A,k[s.TRG]=A,k[s.AND]=A,k[s.NOT]=A,k[s.BKR]=A,k[s.BKA]=A,k[s.BKN]=A,k[s.ABG]=A,k[s.AEN]=A};let f=0;for(const A in h.filter.operators)f+=1;if(f===0){E(!1);return}for(const A in h.filter.operators){const v=A.toUpperCase();if(v==="<ALL>"){E(!0);return}if(v==="<NONE>"){E(!1);return}}E(!1);for(const A in h.filter.operators){const v=A.toUpperCase();if(v==="ALT")k[s.ALT]=h.filter.operators[A]===!0;else if(v==="CAT")k[s.CAT]=h.filter.operators[A]===!0;else if(v==="REP")k[s.REP]=h.filter.operators[A]===!0;else if(v==="AND")k[s.AND]=h.filter.operators[A]===!0;else if(v==="NOT")k[s.NOT]=h.filter.operators[A]===!0;else if(v==="TLS")k[s.TLS]=h.filter.operators[A]===!0;else if(v==="TBS")k[s.TBS]=h.filter.operators[A]===!0;else if(v==="TRG")k[s.TRG]=h.filter.operators[A]===!0;else if(v==="BKR")k[s.BKR]=h.filter.operators[A]===!0;else if(v==="BKA")k[s.BKA]=h.filter.operators[A]===!0;else if(v==="BKN")k[s.BKN]=h.filter.operators[A]===!0;else if(v==="ABG")k[s.ABG]=h.filter.operators[A]===!0;else if(v==="AEN")k[s.AEN]=h.filter.operators[A]===!0;else throw new Error(`${a}initOpratorFilter: '${A}' not a valid operator name. Must be <all>, <none>, alt, cat, rep, tls, tbs, trg, and, not, bkr, bka or bkn`)}},M=function(){const E=function(W){k[s.RNM]=W,k[s.UDT]=W;const Q=z.length+J.length;D.length=0;for(let ne=0;ne<Q;ne+=1)D.push(W)};let f,A;const v=[];for(A=0;A<z.length;A+=1)v.push(z[A].lower);for(A=0;A<J.length;A+=1)v.push(J[A].lower);D.length=0,f=0;for(const W in h.filter.rules)f+=1;if(f===0){E(!0);return}for(const W in h.filter.rules){const Q=W.toLowerCase();if(Q==="<all>"){E(!0);return}if(Q==="<none>"){E(!1);return}}E(!1),k[s.RNM]=!0,k[s.UDT]=!0;for(const W in h.filter.rules){const Q=W.toLowerCase();if(A=v.indexOf(Q),A<0)throw new Error(`${a}initRuleFilter: '${W}' not a valid rule or udt name`);D[A]=h.filter.rules[W]===!0}};this.traceObject="traceObject",this.filter={operators:[],rules:[]},this.setMaxRecords=function(E,f){if(p=-1,typeof E=="number"&&E>0)b=Math.ceil(E);else{b=0;return}typeof f=="number"&&(p=Math.floor(f),p<0&&(p=-1))},this.getMaxRecords=function(){return b},this.getLastRecord=function(){return p},this.init=function(E,f,A){H.length=0,S.length=0,I=0,l=0,q=A,z=E,J=f,$(),M(),n.init(b)};const w=function(E){let f=!1;return E.type===s.RNM?k[E.type]&&D[E.index]?f=!0:f=!1:E.type===s.UDT?k[E.type]&&D[z.length+E.index]?f=!0:f=!1:f=k[E.type],f},K=function(E){return p===-1||E<=p};this.down=function(E,f,A,v,W,Q){K(I)&&w(E)&&(S.push(I),H[n.increment()]={dirUp:!1,depth:l,thisLine:I,thatLine:void 0,opcode:E,state:f,phraseIndex:A,phraseLength:v,lookAnchor:W,lookAround:Q},I+=1,l+=1)},this.up=function(E,f,A,v,W,Q){if(K(I)&&w(E)){const ne=I,B=S.pop(),U=n.getListIndex(B);U!==-1&&(H[U].thatLine=ne),l-=1,H[n.increment()]={dirUp:!0,depth:l,thisLine:ne,thatLine:B,opcode:E,state:f,phraseIndex:A,phraseLength:v,lookAnchor:W,lookAround:Q},I+=1}};const ie=function(){function E(r,u){let _,N,G;if(u)switch(r.op={id:u.type,name:t.opcodeToString(u.type)},r.opData=void 0,u.type){case s.RNM:r.opData=z[u.index].name;break;case s.UDT:r.opData=J[u.index].name;break;case s.BKR:u.index<z.length?_=z[u.index].name:_=J[u.index-z.length].name,N=u.bkrCase===s.BKR_MODE_CI?"%i":"%s",G=u.bkrMode===s.BKR_MODE_UM?"%u":"%p",r.opData=`\\\\${N}${G}${_}`;break;case s.TLS:r.opData=[];for(let te=0;te<u.string.length;te+=1)r.opData.push(u.string[te]);break;case s.TBS:r.opData=[];for(let te=0;te<u.string.length;te+=1)r.opData.push(u.string[te]);break;case s.TRG:r.opData=[u.min,u.max];break;case s.REP:r.opData=[u.min,u.max];break;default:throw new Error("unrecognized opcode")}else r.op={id:void 0,name:void 0},r.opData=void 0}function f(r,u,_){return r===s.MATCH?{index:u,length:_}:r===s.NOMATCH?{index:u,length:0}:r===s.EMPTY?{index:u,length:0}:null}let A=-1;function v(r,u,_){const N={id:A++,branch:-1,parent:r,up:!1,down:!1,depth:_,children:[]};return u?(N.down=!0,N.state={id:u.state,name:t.stateToString(u.state)},N.phrase=null,E(N,u.opcode)):(N.state={id:void 0,name:void 0},N.phrase=f(),E(N,void 0)),N}function W(r,u){u&&(r.up=!0,r.state={id:u.state,name:t.stateToString(u.state)},r.phrase=f(u.state,u.phraseIndex,u.phraseLength),r.down||E(r,u.opcode))}let Q=0,ne=-1,B=1;function U(r){if(ne+=1,r.branch=B,ne>l&&(l=ne),r.children.length===0)Q+=1;else for(let u=0;u<r.children.length;u+=1)u>0&&(B+=1),r.children[u].leftMost=!1,r.children[u].rightMost=!1,r.leftMost&&(r.children[u].leftMost=u===0),r.rightMost&&(r.children[u].rightMost=u===r.children.length-1),U(r.children[u]);ne-=1}function y(r,u){let _;const N={};if(N.id=r.id,N.branch=r.branch,N.leftMost=r.leftMost,N.rightMost=r.rightMost,_=r.state.name?r.state.name:"ACTIVE",N.state={id:r.state.id,name:_},_=r.op.name?r.op.name:"?",N.op={id:r.op.id,name:_},typeof r.opData=="string")N.opData=r.opData;else if(Array.isArray(r.opData)){N.opData=[];for(let G=0;G<r.opData.length;G+=1)N.opData[G]=r.opData[G]}else N.opData=void 0;r.phrase?N.phrase={index:r.phrase.index,length:r.phrase.length}:N.phrase=null,N.depth=r.depth,N.children=[];for(let G=0;G<r.children.length;G+=1)r.children.length-1,N.children[G]=y(r.children[G]);return N}const F=[];let o,R,Z,re,pe=!0;const Fe=v(null,null,-1);for(F.push(Fe),R=Fe,n.forEach(r=>{if(re=H[r],pe&&(pe=!1,re.depth>0)){const u=re.dirUp?re.depth+1:re.depth;for(let _=0;_<u;_+=1)Z=R,R=v(R,null,_),F.push(R),Z.children.push(R)}re.dirUp?(R=F.pop(),W(R,re),R=F[F.length-1]):(Z=R,R=v(R,re,re.depth),F.push(R),Z.children.push(R))});F.length>1;)R=F.pop(),W(R,null);if(Fe.children.length===0)throw new Error("trace.toTree(): parse tree has no nodes");if(F.length===0)throw new Error("trace.toTree(): integrity check: dummy root node disappeared?");o=Fe.children[0];let ze=o;for(;o&&!o.down&&!o.up;)ze=o,o=o.children[0];o=ze,o.leftMost=!0,o.rightMost=!0,U(o),o.branch=0;const x={};x.string=[];for(let r=0;r<q.length;r+=1)x.string[r]=q[r];x.rules=[];for(let r=0;r<z.length;r+=1)x.rules[r]=z[r].name;x.udts=[];for(let r=0;r<J.length;r+=1)x.udts[r]=J[r].name;x.id={},x.id.ALT={id:s.ALT,name:"ALT"},x.id.CAT={id:s.CAT,name:"CAT"},x.id.REP={id:s.REP,name:"REP"},x.id.RNM={id:s.RNM,name:"RNM"},x.id.TLS={id:s.TLS,name:"TLS"},x.id.TBS={id:s.TBS,name:"TBS"},x.id.TRG={id:s.TRG,name:"TRG"},x.id.UDT={id:s.UDT,name:"UDT"},x.id.AND={id:s.AND,name:"AND"},x.id.NOT={id:s.NOT,name:"NOT"},x.id.BKR={id:s.BKR,name:"BKR"},x.id.BKA={id:s.BKA,name:"BKA"},x.id.BKN={id:s.BKN,name:"BKN"},x.id.ABG={id:s.ABG,name:"ABG"},x.id.AEN={id:s.AEN,name:"AEN"},x.id.ACTIVE={id:s.ACTIVE,name:"ACTIVE"},x.id.MATCH={id:s.MATCH,name:"MATCH"},x.id.EMPTY={id:s.EMPTY,name:"EMPTY"},x.id.NOMATCH={id:s.NOMATCH,name:"NOMATCH"},x.treeDepth=l,x.leafNodes=Q;let g;return o.down?o.up?g="none":g="right":o.up?g="left":g="both",x.branchesIncomplete=g,x.tree=y(o,o.depth),x};this.toTree=function(E){const f=ie();return E?JSON.stringify(f):f},this.toHtmlPage=function(E,f,A){return t.htmlToPage(this.toHtml(E,f),A)};const le=function(E,f){let A;switch(E){case c:A="hexadecimal";break;case L:A="decimal";break;case P:A="ASCII";break;case m:A="UNICODE";break;default:throw new Error(`${a}htmlHeader: unrecognized mode: ${E}`)}let v="";return v+=`<p>display mode: ${A}</p>
`,v+=`<table class="${e.CLASS_TRACE}">
`,typeof f=="string"&&(v+=`<caption>${f}</caption>`),v},se=function(){let E="";return E+=`</table>
`,E+=`<p class="${e.CLASS_MONOSPACE}">legend:<br>
`,E+=`(a)&nbsp;-&nbsp;line number<br>
`,E+=`(b)&nbsp;-&nbsp;matching line number<br>
`,E+=`(c)&nbsp;-&nbsp;phrase offset<br>
`,E+=`(d)&nbsp;-&nbsp;phrase length<br>
`,E+=`(e)&nbsp;-&nbsp;tree depth<br>
`,E+=`(f)&nbsp;-&nbsp;operator state<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_ACTIVE}">&darr;</span>&nbsp;&nbsp;phrase opened<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_MATCH}">&uarr;M</span> phrase matched<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_EMPTY}">&uarr;E</span> empty phrase matched<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_NOMATCH}">&uarr;N</span> phrase not matched<br>
`,E+=`operator&nbsp;-&nbsp;ALT, CAT, REP, RNM, TRG, TLS, TBS<sup>&dagger;</sup>, UDT, AND, NOT, BKA, BKN, BKR, ABG, AEN<sup>&Dagger;</sup><br>
`,E+=`phrase&nbsp;&nbsp;&nbsp;-&nbsp;up to ${d} characters of the phrase being matched<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_MATCH}">matched characters</span><br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_LOOKAHEAD}">matched characters in look ahead mode</span><br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_LOOKBEHIND}">matched characters in look behind mode</span><br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_REMAINDER}">remainder characters(not yet examined by parser)</span><br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${e.CLASS_CTRLCHAR}">control characters, TAB, LF, CR, etc. (ASCII mode only)</span><br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${C} empty string<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${ee} end of input string<br>
`,E+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${oe} input string display truncated<br>
`,E+=`</p>
`,E+=`<p class="${e.CLASS_MONOSPACE}">
`,E+=`<sup>&dagger;</sup>original ABNF operators:<br>
`,E+=`ALT - alternation<br>
`,E+=`CAT - concatenation<br>
`,E+=`REP - repetition<br>
`,E+=`RNM - rule name<br>
`,E+=`TRG - terminal range<br>
`,E+=`TLS - terminal literal string (case insensitive)<br>
`,E+=`TBS - terminal binary string (case sensitive)<br>
`,E+=`<br>
`,E+=`<sup>&Dagger;</sup>super set SABNF operators:<br>
`,E+=`UDT - user-defined terminal<br>
`,E+=`AND - positive look ahead<br>
`,E+=`NOT - negative look ahead<br>
`,E+=`BKA - positive look behind<br>
`,E+=`BKN - negative look behind<br>
`,E+=`BKR - back reference<br>
`,E+=`ABG - anchor - begin of input string<br>
`,E+=`AEN - anchor - end of input string<br>
`,E+=`</p>
`,E};this.indent=function(E){let f="";for(let A=0;A<E;A+=1)f+=".";return f};const ge=function(E,f){let A="";if(f.type===s.TRG)if(E===c||E===m){let v=f.min.toString(16).toUpperCase();v.length%2!==0&&(v=`0${v}`),A+=E===c?"%x":"U+",A+=v,v=f.max.toString(16).toUpperCase(),v.length%2!==0&&(v=`0${v}`),A+=`&ndash;${v}`}else A=`%d${f.min.toString(10)}&ndash;${f.max.toString(10)}`;return A},ye=function(E,f){let A="";if(f.type===s.REP)if(E===c){let v=f.min.toString(16).toUpperCase();v.length%2!==0&&(v=`0${v}`),A=`x${v}`,f.max<1/0?(v=f.max.toString(16).toUpperCase(),v.length%2!==0&&(v=`0${v}`)):v="inf",A+=`&ndash;${v}`}else f.max<1/0?A=`${f.min.toString(10)}&ndash;${f.max.toString(10)}`:A=`${f.min.toString(10)}&ndash;inf`;return A},Y=function(E,f){let A="";if(f.type===s.TBS){const v=Math.min(f.string.length,O*2);if(E===c||E===m){A+=E===c?"%x":"U+";for(let W=0;W<v;W+=1){let Q;W>0&&(A+="."),Q=f.string[W].toString(16).toUpperCase(),Q.length%2!==0&&(Q=`0${Q}`),A+=Q}}else{A="%d";for(let W=0;W<v;W+=1)W>0&&(A+="."),A+=f.string[W].toString(10)}v<f.string.length&&(A+=oe)}return A},X=function(E,f){let A="";if(f.type===s.TLS){const v=Math.min(f.string.length,O);if(E===c||E===L){let W,Q,ne;E===c?(A="%x",ne=16):(A="%d",ne=10);for(let B=0;B<v;B+=1)B>0&&(A+="."),Q=f.string[B],Q>=97&&Q<=122?(W=Q-32,A+=`${W.toString(ne)}/${Q.toString(ne)}`.toUpperCase()):Q>=65&&Q<=90?(W=Q,Q+=32,A+=`${W.toString(ne)}/${Q.toString(ne)}`.toUpperCase()):A+=Q.toString(ne).toUpperCase();v<f.string.length&&(A+=oe)}else{A='"';for(let W=0;W<v;W+=1)A+=t.asciiChars[f.string[W]];v<f.string.length&&(A+=oe),A+='"'}}return A},V=function(E,f,A,v,W){if(v===0)return"";let Q="";const ne=W?",":"";switch(E){case c:Q=ne+t.charsToHex(f,A,v);break;case L:if(W)return`,${t.charsToDec(f,A,v)}`;Q=ne+t.charsToDec(f,A,v);break;case m:Q=t.charsToUnicode(f,A,v);break;case P:default:Q=t.charsToAsciiHtml(f,A,v);break}return Q},T=function(E,f,A,v,W,Q){let ne="",B,U,y,F,o=ee;const R=`<span class="${e.CLASS_LOOKBEHIND}">`,Z=`<span class="${e.CLASS_REMAINDER}">`,re="</span>";let pe=!1;switch(A){case s.EMPTY:ne+=C;case s.NOMATCH:case s.MATCH:case s.ACTIVE:B=v-W,U=Q-B,y=Q,F=f.length-y;break;default:throw new Error("unrecognized state")}return o=ee,U>d?(U=d,o=oe,F=0):U+F>d&&(o=oe,F=d-U),U>0&&(ne+=R,ne+=V(E,f,B,U,pe),ne+=re,pe=!0),F>0&&(ne+=Z,ne+=V(E,f,y,F,pe),ne+=re),ne+o},he=function(E,f,A,v,W,Q){let ne="",B,U,y,F,o=ee;const R=`<span class="${e.CLASS_REMAINDER}">`,Z="</span>";let re=!1;switch(A){case s.EMPTY:ne+=C;case s.NOMATCH:case s.ACTIVE:B=v,U=0,y=v,F=f.length-y;break;case s.MATCH:B=v,U=W,y=v+U,F=f.length-y;break;default:throw new Error("unrecognized state")}return o=ee,U>d?(U=d,o=oe,F=0):U+F>d&&(o=oe,F=d-U),U>0&&(ne+=Q,ne+=V(E,f,B,U,re),ne+=Z,re=!0),F>0&&(ne+=R,ne+=V(E,f,y,F,re),ne+=Z),ne+o},Te=function(E,f,A,v,W){const Q=`<span class="${e.CLASS_LOOKAHEAD}">`;return he(E,f,A,v,W,Q)},xe=function(E,f,A,v,W){const Q=`<span class="${e.CLASS_MATCH}">`;return he(E,f,A,v,W,Q)},ue=function(E){if(z===null)return"";let f="",A,v,W,Q,ne,B;return f+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",f+=`<th>operator</th><th>phrase</th></tr>
`,n.forEach(U=>{const y=H[U];switch(A=y.thisLine,v=y.thatLine!==void 0?y.thatLine:"--",W=!1,Q=!1,ne=!1,y.lookAround===s.LOOKAROUND_AHEAD&&(W=!0,ne=!0,B=y.lookAnchor),(y.opcode.type===s.AND||y.opcode.type===s.NOT)&&(W=!0,ne=!0,B=y.phraseIndex),y.lookAround===s.LOOKAROUND_BEHIND&&(Q=!0,ne=!0,B=y.lookAnchor),(y.opcode.type===s.BKA||y.opcode.type===s.BKN)&&(Q=!0,ne=!0,B=y.phraseIndex),f+="<tr>",f+=`<td>${A}</td><td>${v}</td>`,f+=`<td>${y.phraseIndex}</td>`,f+=`<td>${y.phraseLength}</td>`,f+=`<td>${y.depth}</td>`,f+="<td>",y.state){case s.ACTIVE:f+=`<span class="${e.CLASS_ACTIVE}">&darr;&nbsp;</span>`;break;case s.MATCH:f+=`<span class="${e.CLASS_MATCH}">&uarr;M</span>`;break;case s.NOMATCH:f+=`<span class="${e.CLASS_NOMATCH}">&uarr;N</span>`;break;case s.EMPTY:f+=`<span class="${e.CLASS_EMPTY}">&uarr;E</span>`;break;default:f+=`<span class="${e.CLASS_ACTIVE}">--</span>`;break}if(f+="</td>",f+="<td>",f+=h.indent(y.depth),W?f+=`<span class="${e.CLASS_LOOKAHEAD}">`:Q&&(f+=`<span class="${e.CLASS_LOOKBEHIND}">`),f+=t.opcodeToString(y.opcode.type),y.opcode.type===s.RNM&&(f+=`(${z[y.opcode.index].name}) `),y.opcode.type===s.BKR){const F=y.opcode.bkrCase===s.BKR_MODE_CI?"%i":"%s",o=y.opcode.bkrMode===s.BKR_MODE_UM?"%u":"%p";f+=`(\\${F}${o}${z[y.opcode.index].name}) `}y.opcode.type===s.UDT&&(f+=`(${J[y.opcode.index].name}) `),y.opcode.type===s.TRG&&(f+=`(${ge(E,y.opcode)}) `),y.opcode.type===s.TBS&&(f+=`(${Y(E,y.opcode)}) `),y.opcode.type===s.TLS&&(f+=`(${X(E,y.opcode)}) `),y.opcode.type===s.REP&&(f+=`(${ye(E,y.opcode)}) `),ne&&(f+="</span>"),f+="</td>",f+="<td>",Q?f+=T(E,q,y.state,y.phraseIndex,y.phraseLength,B):W?f+=Te(E,q,y.state,y.phraseIndex,y.phraseLength):f+=xe(E,q,y.state,y.phraseIndex,y.phraseLength),f+=`</td></tr>
`}),f+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",f+=`<th>operator</th><th>phrase</th></tr>
`,f+=`</table>
`,f};this.toHtml=function(E,f){let A=P;if(typeof E=="string"&&E.length>=3){const W=E.toLowerCase().slice(0,3);W==="hex"?A=c:W==="dec"?A=L:W==="uni"&&(A=m)}let v="";return v+=le(A,f),v+=ue(A),v+=se(),v}},Ve={ast:zt,circular:Pt,ids:$e,parser:jt,stats:qt,trace:Xt,utils:me,emitcss:Ht,style:Xe},tt,yt;function Wt(){return yt||(yt=1,tt=function(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"file",lower:"file",index:0,isBkr:!1},this.rules[1]={name:"line",lower:"line",index:1,isBkr:!1},this.rules[2]={name:"line-text",lower:"line-text",index:2,isBkr:!1},this.rules[3]={name:"last-line",lower:"last-line",index:3,isBkr:!1},this.rules[4]={name:"valid",lower:"valid",index:4,isBkr:!1},this.rules[5]={name:"invalid",lower:"invalid",index:5,isBkr:!1},this.rules[6]={name:"end",lower:"end",index:6,isBkr:!1},this.rules[7]={name:"CRLF",lower:"crlf",index:7,isBkr:!1},this.rules[8]={name:"LF",lower:"lf",index:8,isBkr:!1},this.rules[9]={name:"CR",lower:"cr",index:9,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:2,children:[1,3]},this.rules[0].opcodes[1]={type:3,min:0,max:1/0},this.rules[0].opcodes[2]={type:4,index:1},this.rules[0].opcodes[3]={type:3,min:0,max:1},this.rules[0].opcodes[4]={type:4,index:3},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:2,children:[1,2]},this.rules[1].opcodes[1]={type:4,index:2},this.rules[1].opcodes[2]={type:4,index:6},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:3,min:0,max:1/0},this.rules[2].opcodes[1]={type:1,children:[2,3]},this.rules[2].opcodes[2]={type:4,index:4},this.rules[2].opcodes[3]={type:4,index:5},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:3,min:1,max:1/0},this.rules[3].opcodes[1]={type:1,children:[2,3]},this.rules[3].opcodes[2]={type:4,index:4},this.rules[3].opcodes[3]={type:4,index:5},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:1,children:[1,2]},this.rules[4].opcodes[1]={type:5,min:32,max:126},this.rules[4].opcodes[2]={type:6,string:[9]},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[5].opcodes[1]={type:5,min:0,max:8},this.rules[5].opcodes[2]={type:5,min:11,max:12},this.rules[5].opcodes[3]={type:5,min:14,max:31},this.rules[5].opcodes[4]={type:5,min:127,max:4294967295},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:1,children:[1,2,3]},this.rules[6].opcodes[1]={type:4,index:7},this.rules[6].opcodes[2]={type:4,index:8},this.rules[6].opcodes[3]={type:4,index:9},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:6,string:[13,10]},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:6,string:[10]},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:6,string:[13]},this.toString=function(){let e="";return e+=`file = *line [last-line]
`,e+=`line = line-text end
`,e+=`line-text = *(valid/invalid)
`,e+=`last-line = 1*(valid/invalid)
`,e+=`valid = %d32-126 / %d9
`,e+=`invalid = %d0-8 / %d11-12 /%d14-31 / %x7f-ffffffff
`,e+=`end = CRLF / LF / CR
`,e+=`CRLF = %d13.10
`,e+=`LF = %d10
`,e+=`CR = %d13
`,e}}),tt}var nt={},kt;function Jt(){if(kt)return nt;kt=1;const i=$e,t=me;function e(d,O,H,b,p){return d===i.SEM_PRE?(p.endLength=0,p.textLength=0,p.invalidCount=0):p.lines.push({lineNo:p.lines.length,beginChar:H,length:b,textLength:p.textLength,endType:p.endType,invalidChars:p.invalidCount}),i.SEM_OK}function n(d,O,H,b,p){return d===i.SEM_PRE&&(p.textLength=b),i.SEM_OK}function s(d,O,H,b,p){return d===i.SEM_PRE?(p.endLength=0,p.textLength=0,p.invalidCount=0):p.strict?(p.lines.push({lineNo:p.lines.length,beginChar:H,length:b,textLength:b,endType:"none",invalidChars:p.invalidCount}),p.errors.push({line:p.lineNo,char:H+b,msg:"no line end on last line - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})):(O.push(10),p.lines.push({lineNo:p.lines.length,beginChar:H,length:b+1,textLength:b,endType:"LF",invalidChars:p.invalidCount})),i.SEM_OK}function a(d,O,H,b,p){return d===i.SEM_PRE&&p.errors.push({line:p.lineNo,char:H,msg:`invalid character found '\\x${t.charToHex(O[H])}'`}),i.SEM_OK}function h(d,O,H,b,p){return d===i.SEM_POST&&(p.lineNo+=1),i.SEM_OK}function c(d,O,H,b,p){return d===i.SEM_PRE&&(p.endType="LF",p.strict&&p.errors.push({line:p.lineNo,char:H,msg:"line end character LF(\\n, \\x0A) - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})),i.SEM_OK}function L(d,O,H,b,p){return d===i.SEM_PRE&&(p.endType="CR",p.strict&&p.errors.push({line:p.lineNo,char:H,msg:"line end character CR(\\r, \\x0D) - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})),i.SEM_OK}function P(d,O,H,b,p){return d===i.SEM_PRE&&(p.endType="CRLF"),i.SEM_OK}const m=[];return m.line=e,m["line-text"]=n,m["last-line"]=s,m.invalid=a,m.end=h,m.lf=c,m.cr=L,m.crlf=P,nt.callbacks=m,nt}var st,xt;function Qt(){return xt||(xt=1,st=function(t,e,n,s){const a="scanner.js: ",h=Ve,c=new(Wt()),{callbacks:L}=Jt(),P=[],m=new h.parser;if(m.ast=new h.ast,m.ast.callbacks=L,s){if(s.traceObject!=="traceObject")throw new TypeError(`${a}trace argument is not a trace object`);m.trace=s}if(m.parse(c,"file",t).success!==!0){e.push({line:0,char:0,msg:"syntax analysis error analyzing input SABNF grammar"});return}const O={lines:P,lineNo:0,errors:e,strict:!!n};return m.ast.translate(O),P}),st}var rt,wt;function Zt(){return wt||(wt=1,rt=function(){const t="syntax-callbacks.js: ",e=Ve,n=e.ids;let s;const a=function(X,V,T,he){switch(X.state){case n.ACTIVE:he.altStack=[],he.repCount=0;break;case n.EMPTY:he.errors.push({line:0,char:0,msg:"grammar file is empty"});break;case n.MATCH:he.ruleCount===0&&he.errors.push({line:0,char:0,msg:"no rules defined"});break;case n.NOMATCH:throw new Error(`${t}synFile: grammar file NOMATCH: design error: should never happen.`);default:throw new Error(`${t}synFile: unrecognized case.`)}},h=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:T.altStack.length=0,s={groupOpen:null,groupError:!1,optionOpen:null,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},T.altStack.push(s);break;case n.EMPTY:throw new Error(`${t}synRule: EMPTY: rule cannot be empty`);case n.NOMATCH:break;case n.MATCH:T.ruleCount+=1;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},c=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Unrecognized SABNF line. Invalid rule, comment or blank line."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},L=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Rule names must be alphanum and begin with alphabetic character."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},P=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Expected '=' or '=/'. Not found."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},m=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"AND operator(&) found - strict ABNF specified."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},d=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"NOT operator(!) found - strict ABNF specified."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},O=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Positive look-behind operator(&&) found - strict ABNF specified."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},H=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Negative look-behind operator(!!) found - strict ABNF specified."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},b=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Beginning of string anchor(%^) found - strict ABNF specified."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},p=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"End of string anchor(%$) found - strict ABNF specified."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},I=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:if(T.strict){const he=e.utils.charsToString(X,V,Y.phraseLength);T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:`Back reference operator(${he}) found - strict ABNF specified.`})}break;default:throw new Error(`${t}synFile: unrecognized case.`)}},l=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:if(T.strict){const he=e.utils.charsToString(X,V,Y.phraseLength);T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:`UDT operator found(${he}) - strict ABNF specified.`})}break;default:throw new Error(`${t}synFile: unrecognized case.`)}},S=function(Y,X,V){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:s.tlsOpen=V;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},q=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:T.stringTabChar=!1;break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.stringTabChar!==!1&&T.errors.push({line:T.findLine(T.lines,T.stringTabChar),char:T.stringTabChar,msg:"Tab character (\\t, x09) not allowed in literal string (see 'quoted-string' definition, RFC 7405.)"});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},z=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.stringTabChar=V;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},J=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:T.errors.push({line:T.findLine(T.lines,s.tlsOpen),char:s.tlsOpen,msg:'Case-insensitive literal string("...") opened but not closed.'}),s.basicError=!0,s.tlsOpen=null;break;case n.MATCH:s.tlsOpen=null;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},k=function(Y,X,V){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:s.clsOpen=V;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},D=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:T.stringTabChar=!1;break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.stringTabChar!==!1&&T.errors.push({line:T.findLine(T.lines,T.stringTabChar),char:T.stringTabChar,msg:"Tab character (\\t, x09) not allowed in literal string."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},ee=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:T.errors.push({line:T.findLine(T.lines,s.clsOpen),char:s.clsOpen,msg:"Case-sensitive literal string('...') opened but not closed."}),s.clsOpen=null,s.basicError=!0;break;case n.MATCH:T.strict&&T.errors.push({line:T.findLine(T.lines,s.clsOpen),char:s.clsOpen,msg:"Case-sensitive string operator('...') found - strict ABNF specified."}),s.clsOpen=null;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},oe=function(Y,X,V){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:s.prosValOpen=V;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},C=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:T.stringTabChar=!1;break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.stringTabChar!==!1&&T.errors.push({line:T.findLine(T.lines,T.stringTabChar),char:T.stringTabChar,msg:"Tab character (\\t, x09) not allowed in prose value string."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},$=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:T.errors.push({line:T.findLine(T.lines,s.prosValOpen),char:s.prosValOpen,msg:"Prose value operator(<...>) opened but not closed."}),s.basicError=!0,s.prosValOpen=null;break;case n.MATCH:T.errors.push({line:T.findLine(T.lines,s.prosValOpen),char:s.prosValOpen,msg:"Prose value operator(<...>) found. The ABNF syntax is valid, but a parser cannot be generated from this grammar."}),s.prosValOpen=null;break;default:throw new Error(`${t}synFile: unrecognized case.`)}},M=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:s={groupOpen:V,groupError:!1,optionOpen:null,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},T.altStack.push(s);break;default:throw new Error(`${t}synFile: unrecognized case.`)}},w=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:T.errors.push({line:T.findLine(T.lines,s.groupOpen),char:s.groupOpen,msg:'Group "(...)" opened but not closed.'}),s=T.altStack.pop(),s.groupError=!0;break;case n.MATCH:s=T.altStack.pop();break;default:throw new Error(`${t}synFile: unrecognized case.`)}},K=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:s={groupOpen:null,groupError:!1,optionOpen:V,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},T.altStack.push(s);break;default:throw new Error(`${t}synFile: unrecognized case.`)}},ie=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:T.errors.push({line:T.findLine(T.lines,s.optionOpen),char:s.optionOpen,msg:'Option "[...]" opened but not closed.'}),s=T.altStack.pop(),s.optionError=!0;break;case n.MATCH:s=T.altStack.pop();break;default:throw new Error(`${t}synFile: unrecognized case.`)}},le=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:s.basicError===!1&&T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Unrecognized SABNF element."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},se=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:if(Y.phraseLength===1&&T.strict){const he=X[V]===13?"CR":"LF";T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:`Line end '${he}' found - strict ABNF specified, only CRLF allowed.`})}break;default:throw new Error(`${t}synFile: unrecognized case.`)}},ge=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:break;case n.MATCH:T.errors.push({line:T.findLine(T.lines,V,T.charsLength),char:V,msg:"Unrecognized grammar element or characters."});break;default:throw new Error(`${t}synFile: unrecognized case.`)}},ye=function(Y,X,V,T){switch(Y.state){case n.ACTIVE:break;case n.EMPTY:break;case n.NOMATCH:T.repCount+=1;break;case n.MATCH:T.repCount+=1;break;default:throw new Error(`${t}synFile: unrecognized case.`)}};this.callbacks=[],this.callbacks.andop=m,this.callbacks.basicelementerr=le,this.callbacks.clsclose=ee,this.callbacks.clsopen=k,this.callbacks.clsstring=D,this.callbacks.definedaserror=P,this.callbacks.file=a,this.callbacks.groupclose=w,this.callbacks.groupopen=M,this.callbacks.lineenderror=ge,this.callbacks.lineend=se,this.callbacks.notop=d,this.callbacks.optionclose=ie,this.callbacks.optionopen=K,this.callbacks.prosvalclose=$,this.callbacks.prosvalopen=oe,this.callbacks.prosvalstring=C,this.callbacks.repetition=ye,this.callbacks.rule=h,this.callbacks.ruleerror=c,this.callbacks.rulenameerror=L,this.callbacks.stringtab=z,this.callbacks.tlsclose=J,this.callbacks.tlsopen=S,this.callbacks.tlsstring=q,this.callbacks.udtop=l,this.callbacks.bkaop=O,this.callbacks.bknop=H,this.callbacks.bkrop=I,this.callbacks.abgop=b,this.callbacks.aenop=p}),rt}var it,At;function en(){return At||(At=1,it=function(){const t=Ve,e=t.ids,n=function(){this.names=[],this.add=function(y){let F=-1;return this.get(y)===-1&&(F={name:y,lower:y.toLowerCase(),index:this.names.length},this.names.push(F)),F},this.get=function(y){let F=-1;const o=y.toLowerCase();for(let R=0;R<this.names.length;R+=1)if(this.names[R].lower===o){F=this.names[R];break}return F}},s=function(U,y,F){let o=0;for(let R=y;R<y+F;R+=1)o=10*o+U[R]-48;return o},a=function(U,y,F){let o=0;for(let R=y;R<y+F;R+=1)o=2*o+U[R]-48;return o},h=function(U,y,F){let o=0;for(let R=y;R<y+F;R+=1){let Z=U[R];if(Z>=48&&Z<=57)Z-=48;else if(Z>=65&&Z<=70)Z-=55;else if(Z>=97&&Z<=102)Z-=87;else throw new Error("hexnum out of range");o=16*o+Z}return o};function c(B,U,y,F,o){const R=e.SEM_OK;if(B===e.SEM_PRE)o.ruleNames=new n,o.udtNames=new n,o.rules=[],o.udts=[],o.rulesLineMap=[],o.opcodes=[],o.altStack=[],o.topStack=null,o.topRule=null;else if(B===e.SEM_POST){let Z;o.rules.forEach(re=>{re.isBkr=!1,re.opcodes.forEach(pe=>{pe.type===e.RNM&&(Z=o.ruleNames.get(pe.index.name),Z===-1?(o.errors.push({line:o.findLine(o.lines,pe.index.phraseIndex,o.charsLength),char:pe.index.phraseIndex,msg:`Rule name '${pe.index.name}' used but not defined.`}),pe.index=-1):pe.index=Z.index)})}),o.udts.forEach(re=>{re.isBkr=!1}),o.rules.forEach(re=>{re.opcodes.forEach(pe=>{pe.type===e.BKR&&(re.hasBkr=!0,Z=o.ruleNames.get(pe.index.name),Z!==-1?(o.rules[Z.index].isBkr=!0,pe.index=Z.index):(Z=o.udtNames.get(pe.index.name),Z!==-1?(o.udts[Z.index].isBkr=!0,pe.index=o.rules.length+Z.index):(o.errors.push({line:o.findLine(o.lines,pe.index.phraseIndex,o.charsLength),char:pe.index.phraseIndex,msg:`Back reference name '${pe.index.name}' refers to undefined rule or unamed UDT.`}),pe.index=-1)))})})}return R}function L(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE&&(o.altStack.length=0,o.topStack=null,o.rulesLineMap.push({line:o.findLine(o.lines,y,o.charsLength),char:y})),R}function P(B,U,y,F,o){const R=e.SEM_OK;if(B===e.SEM_PRE)o.ruleName="",o.definedas="";else if(B===e.SEM_POST){let Z;o.definedas==="="?(Z=o.ruleNames.add(o.ruleName),Z===-1?(o.definedas=null,o.errors.push({line:o.findLine(o.lines,y,o.charsLength),char:y,msg:`Rule name '${o.ruleName}' previously defined.`})):(o.topRule={name:Z.name,lower:Z.lower,opcodes:[],index:Z.index},o.rules.push(o.topRule),o.opcodes=o.topRule.opcodes)):(Z=o.ruleNames.get(o.ruleName),Z===-1?(o.definedas=null,o.errors.push({line:o.findLine(o.lines,y,o.charsLength),char:y,msg:`Rule name '${o.ruleName}' for incremental alternate not previously defined.`})):(o.topRule=o.rules[Z.index],o.opcodes=o.topRule.opcodes))}return R}function m(B,U,y,F,o){let R=e.SEM_OK;if(B===e.SEM_PRE)for(;;){if(o.definedas===null){R=e.SEM_SKIP;break}if(o.topStack===null){if(o.definedas==="="){o.topStack={alt:{type:e.ALT,children:[]},cat:null},o.altStack.push(o.topStack),o.opcodes.push(o.topStack.alt);break}o.topStack={alt:o.opcodes[0],cat:null},o.altStack.push(o.topStack);break}o.topStack={alt:{type:e.ALT,children:[]},cat:null},o.altStack.push(o.topStack),o.opcodes.push(o.topStack.alt);break}else B===e.SEM_POST&&(o.altStack.pop(),o.altStack.length>0?o.topStack=o.altStack[o.altStack.length-1]:o.topStack=null);return R}function d(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE?(o.topStack.alt.children.push(o.opcodes.length),o.topStack.cat={type:e.CAT,children:[]},o.opcodes.push(o.topStack.cat)):B===e.SEM_POST&&(o.topStack.cat=null),R}function O(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE&&o.topStack.cat.children.push(o.opcodes.length),R}function H(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.REP,min:0,max:1,char:y}),R}function b(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE&&(o.ruleName=t.utils.charsToString(U,y,F)),R}function p(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.definedas="="),R}function I(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.definedas="=/"),R}function l(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE?(o.min=0,o.max=1/0,o.topRep={type:e.REP,min:0,max:1/0},o.opcodes.push(o.topRep)):B===e.SEM_POST&&(o.min>o.max&&o.errors.push({line:o.findLine(o.lines,y,o.charsLength),char:y,msg:`repetition min cannot be greater than max: min: ${o.min}: max: ${o.max}`}),o.topRep.min=o.min,o.topRep.max=o.max),R}function S(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.min=s(U,y,F)),R}function q(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.max=s(U,y,F)),R}function z(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.max=s(U,y,F),o.min=o.max),R}function J(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.AND}),R}function k(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.NOT}),R}function D(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.RNM,index:{phraseIndex:y,name:t.utils.charsToString(U,y,F)}}),R}function ee(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.ABG}),R}function oe(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.AEN}),R}function C(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.BKA}),R}function $(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.opcodes.push({type:e.BKN}),R}function M(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE?(o.ci=!0,o.cs=!1,o.um=!0,o.pm=!1):B===e.SEM_POST&&o.opcodes.push({type:e.BKR,bkrCase:o.cs===!0?e.BKR_MODE_CS:e.BKR_MODE_CI,bkrMode:o.pm===!0?e.BKR_MODE_PM:e.BKR_MODE_UM,index:{phraseIndex:o.bkrname.phraseIndex,name:t.utils.charsToString(U,o.bkrname.phraseIndex,o.bkrname.phraseLength)}}),R}function w(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.ci=!0),R}function K(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.cs=!0),R}function ie(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.um=!0),R}function le(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.pm=!0),R}function se(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.bkrname={phraseIndex:y,phraseLength:F}),R}function ge(B,U,y,F,o){const R=e.SEM_OK;if(B===e.SEM_POST){const Z=t.utils.charsToString(U,y,F);let re=o.udtNames.add(Z);if(re===-1){if(re=o.udtNames.get(Z),re===-1)throw new Error("semUdtEmpty: name look up error")}else o.udts.push({name:re.name,lower:re.lower,index:re.index,empty:!0});o.opcodes.push({type:e.UDT,empty:!0,index:re.index})}return R}function ye(B,U,y,F,o){const R=e.SEM_OK;if(B===e.SEM_POST){const Z=t.utils.charsToString(U,y,F);let re=o.udtNames.add(Z);if(re===-1){if(re=o.udtNames.get(Z),re===-1)throw new Error("semUdtNonEmpty: name look up error")}else o.udts.push({name:re.name,lower:re.lower,index:re.index,empty:!1});o.opcodes.push({type:e.UDT,empty:!1,index:re.index,syntax:null,semantic:null})}return R}function Y(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE&&(o.tlscase=!0),R}function X(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&F>0&&(U[y+1]===83||U[y+1]===115)&&(o.tlscase=!1),R}function V(B,U,y,F,o){const R=e.SEM_OK;if(B===e.SEM_POST)if(o.tlscase){const Z=U.slice(y,y+F);for(let re=0;re<Z.length;re+=1)Z[re]>=65&&Z[re]<=90&&(Z[re]+=32);o.opcodes.push({type:e.TLS,string:Z})}else o.opcodes.push({type:e.TBS,string:U.slice(y,y+F)});return R}function T(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(F<=2?o.opcodes.push({type:e.TLS,string:[]}):o.opcodes.push({type:e.TBS,string:U.slice(y+1,y+F-1)})),R}function he(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE?o.tbsstr=[]:B===e.SEM_POST&&o.opcodes.push({type:e.TBS,string:o.tbsstr}),R}function Te(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_PRE?(o.min=0,o.max=0):B===e.SEM_POST&&(o.min>o.max&&o.errors.push({line:o.findLine(o.lines,y,o.charsLength),char:y,msg:`TRG, (%dmin-max), min cannot be greater than max: min: ${o.min}: max: ${o.max}`}),o.opcodes.push({type:e.TRG,min:o.min,max:o.max})),R}function xe(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.min=s(U,y,F)),R}function ue(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.max=s(U,y,F)),R}function E(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.min=a(U,y,F)),R}function f(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.max=a(U,y,F)),R}function A(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.min=h(U,y,F)),R}function v(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&(o.max=h(U,y,F)),R}function W(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.tbsstr.push(s(U,y,F)),R}function Q(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.tbsstr.push(a(U,y,F)),R}function ne(B,U,y,F,o){const R=e.SEM_OK;return B===e.SEM_POST&&o.tbsstr.push(h(U,y,F)),R}this.callbacks=[],this.callbacks.abgop=ee,this.callbacks.aenop=oe,this.callbacks.alternation=m,this.callbacks.andop=J,this.callbacks.bmax=f,this.callbacks.bmin=E,this.callbacks.bkaop=C,this.callbacks.bknop=$,this.callbacks.bkrop=M,this.callbacks["bkr-name"]=se,this.callbacks.bstring=Q,this.callbacks.clsop=T,this.callbacks.ci=w,this.callbacks.cs=K,this.callbacks.um=ie,this.callbacks.pm=le,this.callbacks.concatenation=d,this.callbacks.defined=p,this.callbacks.dmax=ue,this.callbacks.dmin=xe,this.callbacks.dstring=W,this.callbacks.file=c,this.callbacks.incalt=I,this.callbacks.notop=k,this.callbacks.optionopen=H,this.callbacks["rep-max"]=q,this.callbacks["rep-min"]=S,this.callbacks["rep-min-max"]=z,this.callbacks.repetition=O,this.callbacks.repop=l,this.callbacks.rnmop=D,this.callbacks.rule=L,this.callbacks.rulelookup=P,this.callbacks.rulename=b,this.callbacks.tbsop=he,this.callbacks.tlscase=X,this.callbacks.tlsstring=V,this.callbacks.tlsop=Y,this.callbacks.trgop=Te,this.callbacks["udt-empty"]=ge,this.callbacks["udt-non-empty"]=ye,this.callbacks.xmax=v,this.callbacks.xmin=A,this.callbacks.xstring=ne}),it}var ot,Ct;function tn(){return Ct||(Ct=1,ot=function(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"File",lower:"file",index:0,isBkr:!1},this.rules[1]={name:"BlankLine",lower:"blankline",index:1,isBkr:!1},this.rules[2]={name:"Rule",lower:"rule",index:2,isBkr:!1},this.rules[3]={name:"RuleLookup",lower:"rulelookup",index:3,isBkr:!1},this.rules[4]={name:"RuleNameTest",lower:"rulenametest",index:4,isBkr:!1},this.rules[5]={name:"RuleName",lower:"rulename",index:5,isBkr:!1},this.rules[6]={name:"RuleNameError",lower:"rulenameerror",index:6,isBkr:!1},this.rules[7]={name:"DefinedAsTest",lower:"definedastest",index:7,isBkr:!1},this.rules[8]={name:"DefinedAsError",lower:"definedaserror",index:8,isBkr:!1},this.rules[9]={name:"DefinedAs",lower:"definedas",index:9,isBkr:!1},this.rules[10]={name:"Defined",lower:"defined",index:10,isBkr:!1},this.rules[11]={name:"IncAlt",lower:"incalt",index:11,isBkr:!1},this.rules[12]={name:"RuleError",lower:"ruleerror",index:12,isBkr:!1},this.rules[13]={name:"LineEndError",lower:"lineenderror",index:13,isBkr:!1},this.rules[14]={name:"Alternation",lower:"alternation",index:14,isBkr:!1},this.rules[15]={name:"Concatenation",lower:"concatenation",index:15,isBkr:!1},this.rules[16]={name:"Repetition",lower:"repetition",index:16,isBkr:!1},this.rules[17]={name:"Modifier",lower:"modifier",index:17,isBkr:!1},this.rules[18]={name:"Predicate",lower:"predicate",index:18,isBkr:!1},this.rules[19]={name:"BasicElement",lower:"basicelement",index:19,isBkr:!1},this.rules[20]={name:"BasicElementErr",lower:"basicelementerr",index:20,isBkr:!1},this.rules[21]={name:"Group",lower:"group",index:21,isBkr:!1},this.rules[22]={name:"GroupError",lower:"grouperror",index:22,isBkr:!1},this.rules[23]={name:"GroupOpen",lower:"groupopen",index:23,isBkr:!1},this.rules[24]={name:"GroupClose",lower:"groupclose",index:24,isBkr:!1},this.rules[25]={name:"Option",lower:"option",index:25,isBkr:!1},this.rules[26]={name:"OptionError",lower:"optionerror",index:26,isBkr:!1},this.rules[27]={name:"OptionOpen",lower:"optionopen",index:27,isBkr:!1},this.rules[28]={name:"OptionClose",lower:"optionclose",index:28,isBkr:!1},this.rules[29]={name:"RnmOp",lower:"rnmop",index:29,isBkr:!1},this.rules[30]={name:"BkrOp",lower:"bkrop",index:30,isBkr:!1},this.rules[31]={name:"bkrModifier",lower:"bkrmodifier",index:31,isBkr:!1},this.rules[32]={name:"cs",lower:"cs",index:32,isBkr:!1},this.rules[33]={name:"ci",lower:"ci",index:33,isBkr:!1},this.rules[34]={name:"um",lower:"um",index:34,isBkr:!1},this.rules[35]={name:"pm",lower:"pm",index:35,isBkr:!1},this.rules[36]={name:"bkr-name",lower:"bkr-name",index:36,isBkr:!1},this.rules[37]={name:"rname",lower:"rname",index:37,isBkr:!1},this.rules[38]={name:"uname",lower:"uname",index:38,isBkr:!1},this.rules[39]={name:"ename",lower:"ename",index:39,isBkr:!1},this.rules[40]={name:"UdtOp",lower:"udtop",index:40,isBkr:!1},this.rules[41]={name:"udt-non-empty",lower:"udt-non-empty",index:41,isBkr:!1},this.rules[42]={name:"udt-empty",lower:"udt-empty",index:42,isBkr:!1},this.rules[43]={name:"RepOp",lower:"repop",index:43,isBkr:!1},this.rules[44]={name:"AltOp",lower:"altop",index:44,isBkr:!1},this.rules[45]={name:"CatOp",lower:"catop",index:45,isBkr:!1},this.rules[46]={name:"StarOp",lower:"starop",index:46,isBkr:!1},this.rules[47]={name:"AndOp",lower:"andop",index:47,isBkr:!1},this.rules[48]={name:"NotOp",lower:"notop",index:48,isBkr:!1},this.rules[49]={name:"BkaOp",lower:"bkaop",index:49,isBkr:!1},this.rules[50]={name:"BknOp",lower:"bknop",index:50,isBkr:!1},this.rules[51]={name:"AbgOp",lower:"abgop",index:51,isBkr:!1},this.rules[52]={name:"AenOp",lower:"aenop",index:52,isBkr:!1},this.rules[53]={name:"TrgOp",lower:"trgop",index:53,isBkr:!1},this.rules[54]={name:"TbsOp",lower:"tbsop",index:54,isBkr:!1},this.rules[55]={name:"TlsOp",lower:"tlsop",index:55,isBkr:!1},this.rules[56]={name:"TlsCase",lower:"tlscase",index:56,isBkr:!1},this.rules[57]={name:"TlsOpen",lower:"tlsopen",index:57,isBkr:!1},this.rules[58]={name:"TlsClose",lower:"tlsclose",index:58,isBkr:!1},this.rules[59]={name:"TlsString",lower:"tlsstring",index:59,isBkr:!1},this.rules[60]={name:"StringTab",lower:"stringtab",index:60,isBkr:!1},this.rules[61]={name:"ClsOp",lower:"clsop",index:61,isBkr:!1},this.rules[62]={name:"ClsOpen",lower:"clsopen",index:62,isBkr:!1},this.rules[63]={name:"ClsClose",lower:"clsclose",index:63,isBkr:!1},this.rules[64]={name:"ClsString",lower:"clsstring",index:64,isBkr:!1},this.rules[65]={name:"ProsVal",lower:"prosval",index:65,isBkr:!1},this.rules[66]={name:"ProsValOpen",lower:"prosvalopen",index:66,isBkr:!1},this.rules[67]={name:"ProsValString",lower:"prosvalstring",index:67,isBkr:!1},this.rules[68]={name:"ProsValClose",lower:"prosvalclose",index:68,isBkr:!1},this.rules[69]={name:"rep-min",lower:"rep-min",index:69,isBkr:!1},this.rules[70]={name:"rep-min-max",lower:"rep-min-max",index:70,isBkr:!1},this.rules[71]={name:"rep-max",lower:"rep-max",index:71,isBkr:!1},this.rules[72]={name:"rep-num",lower:"rep-num",index:72,isBkr:!1},this.rules[73]={name:"dString",lower:"dstring",index:73,isBkr:!1},this.rules[74]={name:"xString",lower:"xstring",index:74,isBkr:!1},this.rules[75]={name:"bString",lower:"bstring",index:75,isBkr:!1},this.rules[76]={name:"Dec",lower:"dec",index:76,isBkr:!1},this.rules[77]={name:"Hex",lower:"hex",index:77,isBkr:!1},this.rules[78]={name:"Bin",lower:"bin",index:78,isBkr:!1},this.rules[79]={name:"dmin",lower:"dmin",index:79,isBkr:!1},this.rules[80]={name:"dmax",lower:"dmax",index:80,isBkr:!1},this.rules[81]={name:"bmin",lower:"bmin",index:81,isBkr:!1},this.rules[82]={name:"bmax",lower:"bmax",index:82,isBkr:!1},this.rules[83]={name:"xmin",lower:"xmin",index:83,isBkr:!1},this.rules[84]={name:"xmax",lower:"xmax",index:84,isBkr:!1},this.rules[85]={name:"dnum",lower:"dnum",index:85,isBkr:!1},this.rules[86]={name:"bnum",lower:"bnum",index:86,isBkr:!1},this.rules[87]={name:"xnum",lower:"xnum",index:87,isBkr:!1},this.rules[88]={name:"alphanum",lower:"alphanum",index:88,isBkr:!1},this.rules[89]={name:"owsp",lower:"owsp",index:89,isBkr:!1},this.rules[90]={name:"wsp",lower:"wsp",index:90,isBkr:!1},this.rules[91]={name:"space",lower:"space",index:91,isBkr:!1},this.rules[92]={name:"comment",lower:"comment",index:92,isBkr:!1},this.rules[93]={name:"LineEnd",lower:"lineend",index:93,isBkr:!1},this.rules[94]={name:"LineContinue",lower:"linecontinue",index:94,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:3,min:0,max:1/0},this.rules[0].opcodes[1]={type:1,children:[2,3,4]},this.rules[0].opcodes[2]={type:4,index:1},this.rules[0].opcodes[3]={type:4,index:2},this.rules[0].opcodes[4]={type:4,index:12},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:2,children:[1,5,7]},this.rules[1].opcodes[1]={type:3,min:0,max:1/0},this.rules[1].opcodes[2]={type:1,children:[3,4]},this.rules[1].opcodes[3]={type:6,string:[32]},this.rules[1].opcodes[4]={type:6,string:[9]},this.rules[1].opcodes[5]={type:3,min:0,max:1},this.rules[1].opcodes[6]={type:4,index:92},this.rules[1].opcodes[7]={type:4,index:93},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:2,children:[1,2,3,4]},this.rules[2].opcodes[1]={type:4,index:3},this.rules[2].opcodes[2]={type:4,index:89},this.rules[2].opcodes[3]={type:4,index:14},this.rules[2].opcodes[4]={type:1,children:[5,8]},this.rules[2].opcodes[5]={type:2,children:[6,7]},this.rules[2].opcodes[6]={type:4,index:89},this.rules[2].opcodes[7]={type:4,index:93},this.rules[2].opcodes[8]={type:2,children:[9,10]},this.rules[2].opcodes[9]={type:4,index:13},this.rules[2].opcodes[10]={type:4,index:93},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:2,children:[1,2,3]},this.rules[3].opcodes[1]={type:4,index:4},this.rules[3].opcodes[2]={type:4,index:89},this.rules[3].opcodes[3]={type:4,index:7},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:1,children:[1,2]},this.rules[4].opcodes[1]={type:4,index:5},this.rules[4].opcodes[2]={type:4,index:6},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:4,index:88},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:3,min:1,max:1/0},this.rules[6].opcodes[1]={type:1,children:[2,3]},this.rules[6].opcodes[2]={type:5,min:33,max:60},this.rules[6].opcodes[3]={type:5,min:62,max:126},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:1,children:[1,2]},this.rules[7].opcodes[1]={type:4,index:9},this.rules[7].opcodes[2]={type:4,index:8},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:3,min:1,max:2},this.rules[8].opcodes[1]={type:5,min:33,max:126},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:1,children:[1,2]},this.rules[9].opcodes[1]={type:4,index:11},this.rules[9].opcodes[2]={type:4,index:10},this.rules[10].opcodes=[],this.rules[10].opcodes[0]={type:6,string:[61]},this.rules[11].opcodes=[],this.rules[11].opcodes[0]={type:6,string:[61,47]},this.rules[12].opcodes=[],this.rules[12].opcodes[0]={type:2,children:[1,6]},this.rules[12].opcodes[1]={type:3,min:1,max:1/0},this.rules[12].opcodes[2]={type:1,children:[3,4,5]},this.rules[12].opcodes[3]={type:5,min:32,max:126},this.rules[12].opcodes[4]={type:6,string:[9]},this.rules[12].opcodes[5]={type:4,index:94},this.rules[12].opcodes[6]={type:4,index:93},this.rules[13].opcodes=[],this.rules[13].opcodes[0]={type:3,min:1,max:1/0},this.rules[13].opcodes[1]={type:1,children:[2,3,4]},this.rules[13].opcodes[2]={type:5,min:32,max:126},this.rules[13].opcodes[3]={type:6,string:[9]},this.rules[13].opcodes[4]={type:4,index:94},this.rules[14].opcodes=[],this.rules[14].opcodes[0]={type:2,children:[1,2]},this.rules[14].opcodes[1]={type:4,index:15},this.rules[14].opcodes[2]={type:3,min:0,max:1/0},this.rules[14].opcodes[3]={type:2,children:[4,5,6]},this.rules[14].opcodes[4]={type:4,index:89},this.rules[14].opcodes[5]={type:4,index:44},this.rules[14].opcodes[6]={type:4,index:15},this.rules[15].opcodes=[],this.rules[15].opcodes[0]={type:2,children:[1,2]},this.rules[15].opcodes[1]={type:4,index:16},this.rules[15].opcodes[2]={type:3,min:0,max:1/0},this.rules[15].opcodes[3]={type:2,children:[4,5]},this.rules[15].opcodes[4]={type:4,index:45},this.rules[15].opcodes[5]={type:4,index:16},this.rules[16].opcodes=[],this.rules[16].opcodes[0]={type:2,children:[1,3]},this.rules[16].opcodes[1]={type:3,min:0,max:1},this.rules[16].opcodes[2]={type:4,index:17},this.rules[16].opcodes[3]={type:1,children:[4,5,6,7]},this.rules[16].opcodes[4]={type:4,index:21},this.rules[16].opcodes[5]={type:4,index:25},this.rules[16].opcodes[6]={type:4,index:19},this.rules[16].opcodes[7]={type:4,index:20},this.rules[17].opcodes=[],this.rules[17].opcodes[0]={type:1,children:[1,5]},this.rules[17].opcodes[1]={type:2,children:[2,3]},this.rules[17].opcodes[2]={type:4,index:18},this.rules[17].opcodes[3]={type:3,min:0,max:1},this.rules[17].opcodes[4]={type:4,index:43},this.rules[17].opcodes[5]={type:4,index:43},this.rules[18].opcodes=[],this.rules[18].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[18].opcodes[1]={type:4,index:49},this.rules[18].opcodes[2]={type:4,index:50},this.rules[18].opcodes[3]={type:4,index:47},this.rules[18].opcodes[4]={type:4,index:48},this.rules[19].opcodes=[],this.rules[19].opcodes[0]={type:1,children:[1,2,3,4,5,6,7,8,9,10]},this.rules[19].opcodes[1]={type:4,index:40},this.rules[19].opcodes[2]={type:4,index:29},this.rules[19].opcodes[3]={type:4,index:53},this.rules[19].opcodes[4]={type:4,index:54},this.rules[19].opcodes[5]={type:4,index:55},this.rules[19].opcodes[6]={type:4,index:61},this.rules[19].opcodes[7]={type:4,index:30},this.rules[19].opcodes[8]={type:4,index:51},this.rules[19].opcodes[9]={type:4,index:52},this.rules[19].opcodes[10]={type:4,index:65},this.rules[20].opcodes=[],this.rules[20].opcodes[0]={type:3,min:1,max:1/0},this.rules[20].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[20].opcodes[2]={type:5,min:33,max:40},this.rules[20].opcodes[3]={type:5,min:42,max:46},this.rules[20].opcodes[4]={type:5,min:48,max:92},this.rules[20].opcodes[5]={type:5,min:94,max:126},this.rules[21].opcodes=[],this.rules[21].opcodes[0]={type:2,children:[1,2,3]},this.rules[21].opcodes[1]={type:4,index:23},this.rules[21].opcodes[2]={type:4,index:14},this.rules[21].opcodes[3]={type:1,children:[4,5]},this.rules[21].opcodes[4]={type:4,index:24},this.rules[21].opcodes[5]={type:4,index:22},this.rules[22].opcodes=[],this.rules[22].opcodes[0]={type:3,min:1,max:1/0},this.rules[22].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[22].opcodes[2]={type:5,min:33,max:40},this.rules[22].opcodes[3]={type:5,min:42,max:46},this.rules[22].opcodes[4]={type:5,min:48,max:92},this.rules[22].opcodes[5]={type:5,min:94,max:126},this.rules[23].opcodes=[],this.rules[23].opcodes[0]={type:2,children:[1,2]},this.rules[23].opcodes[1]={type:6,string:[40]},this.rules[23].opcodes[2]={type:4,index:89},this.rules[24].opcodes=[],this.rules[24].opcodes[0]={type:2,children:[1,2]},this.rules[24].opcodes[1]={type:4,index:89},this.rules[24].opcodes[2]={type:6,string:[41]},this.rules[25].opcodes=[],this.rules[25].opcodes[0]={type:2,children:[1,2,3]},this.rules[25].opcodes[1]={type:4,index:27},this.rules[25].opcodes[2]={type:4,index:14},this.rules[25].opcodes[3]={type:1,children:[4,5]},this.rules[25].opcodes[4]={type:4,index:28},this.rules[25].opcodes[5]={type:4,index:26},this.rules[26].opcodes=[],this.rules[26].opcodes[0]={type:3,min:1,max:1/0},this.rules[26].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[26].opcodes[2]={type:5,min:33,max:40},this.rules[26].opcodes[3]={type:5,min:42,max:46},this.rules[26].opcodes[4]={type:5,min:48,max:92},this.rules[26].opcodes[5]={type:5,min:94,max:126},this.rules[27].opcodes=[],this.rules[27].opcodes[0]={type:2,children:[1,2]},this.rules[27].opcodes[1]={type:6,string:[91]},this.rules[27].opcodes[2]={type:4,index:89},this.rules[28].opcodes=[],this.rules[28].opcodes[0]={type:2,children:[1,2]},this.rules[28].opcodes[1]={type:4,index:89},this.rules[28].opcodes[2]={type:6,string:[93]},this.rules[29].opcodes=[],this.rules[29].opcodes[0]={type:4,index:88},this.rules[30].opcodes=[],this.rules[30].opcodes[0]={type:2,children:[1,2,4]},this.rules[30].opcodes[1]={type:6,string:[92]},this.rules[30].opcodes[2]={type:3,min:0,max:1},this.rules[30].opcodes[3]={type:4,index:31},this.rules[30].opcodes[4]={type:4,index:36},this.rules[31].opcodes=[],this.rules[31].opcodes[0]={type:1,children:[1,7,13,19]},this.rules[31].opcodes[1]={type:2,children:[2,3]},this.rules[31].opcodes[2]={type:4,index:32},this.rules[31].opcodes[3]={type:3,min:0,max:1},this.rules[31].opcodes[4]={type:1,children:[5,6]},this.rules[31].opcodes[5]={type:4,index:34},this.rules[31].opcodes[6]={type:4,index:35},this.rules[31].opcodes[7]={type:2,children:[8,9]},this.rules[31].opcodes[8]={type:4,index:33},this.rules[31].opcodes[9]={type:3,min:0,max:1},this.rules[31].opcodes[10]={type:1,children:[11,12]},this.rules[31].opcodes[11]={type:4,index:34},this.rules[31].opcodes[12]={type:4,index:35},this.rules[31].opcodes[13]={type:2,children:[14,15]},this.rules[31].opcodes[14]={type:4,index:34},this.rules[31].opcodes[15]={type:3,min:0,max:1},this.rules[31].opcodes[16]={type:1,children:[17,18]},this.rules[31].opcodes[17]={type:4,index:32},this.rules[31].opcodes[18]={type:4,index:33},this.rules[31].opcodes[19]={type:2,children:[20,21]},this.rules[31].opcodes[20]={type:4,index:35},this.rules[31].opcodes[21]={type:3,min:0,max:1},this.rules[31].opcodes[22]={type:1,children:[23,24]},this.rules[31].opcodes[23]={type:4,index:32},this.rules[31].opcodes[24]={type:4,index:33},this.rules[32].opcodes=[],this.rules[32].opcodes[0]={type:6,string:[37,115]},this.rules[33].opcodes=[],this.rules[33].opcodes[0]={type:6,string:[37,105]},this.rules[34].opcodes=[],this.rules[34].opcodes[0]={type:6,string:[37,117]},this.rules[35].opcodes=[],this.rules[35].opcodes[0]={type:6,string:[37,112]},this.rules[36].opcodes=[],this.rules[36].opcodes[0]={type:1,children:[1,2,3]},this.rules[36].opcodes[1]={type:4,index:38},this.rules[36].opcodes[2]={type:4,index:39},this.rules[36].opcodes[3]={type:4,index:37},this.rules[37].opcodes=[],this.rules[37].opcodes[0]={type:4,index:88},this.rules[38].opcodes=[],this.rules[38].opcodes[0]={type:2,children:[1,2]},this.rules[38].opcodes[1]={type:6,string:[117,95]},this.rules[38].opcodes[2]={type:4,index:88},this.rules[39].opcodes=[],this.rules[39].opcodes[0]={type:2,children:[1,2]},this.rules[39].opcodes[1]={type:6,string:[101,95]},this.rules[39].opcodes[2]={type:4,index:88},this.rules[40].opcodes=[],this.rules[40].opcodes[0]={type:1,children:[1,2]},this.rules[40].opcodes[1]={type:4,index:42},this.rules[40].opcodes[2]={type:4,index:41},this.rules[41].opcodes=[],this.rules[41].opcodes[0]={type:2,children:[1,2]},this.rules[41].opcodes[1]={type:6,string:[117,95]},this.rules[41].opcodes[2]={type:4,index:88},this.rules[42].opcodes=[],this.rules[42].opcodes[0]={type:2,children:[1,2]},this.rules[42].opcodes[1]={type:6,string:[101,95]},this.rules[42].opcodes[2]={type:4,index:88},this.rules[43].opcodes=[],this.rules[43].opcodes[0]={type:1,children:[1,5,8,11,12]},this.rules[43].opcodes[1]={type:2,children:[2,3,4]},this.rules[43].opcodes[2]={type:4,index:69},this.rules[43].opcodes[3]={type:4,index:46},this.rules[43].opcodes[4]={type:4,index:71},this.rules[43].opcodes[5]={type:2,children:[6,7]},this.rules[43].opcodes[6]={type:4,index:69},this.rules[43].opcodes[7]={type:4,index:46},this.rules[43].opcodes[8]={type:2,children:[9,10]},this.rules[43].opcodes[9]={type:4,index:46},this.rules[43].opcodes[10]={type:4,index:71},this.rules[43].opcodes[11]={type:4,index:46},this.rules[43].opcodes[12]={type:4,index:70},this.rules[44].opcodes=[],this.rules[44].opcodes[0]={type:2,children:[1,2]},this.rules[44].opcodes[1]={type:6,string:[47]},this.rules[44].opcodes[2]={type:4,index:89},this.rules[45].opcodes=[],this.rules[45].opcodes[0]={type:4,index:90},this.rules[46].opcodes=[],this.rules[46].opcodes[0]={type:6,string:[42]},this.rules[47].opcodes=[],this.rules[47].opcodes[0]={type:6,string:[38]},this.rules[48].opcodes=[],this.rules[48].opcodes[0]={type:6,string:[33]},this.rules[49].opcodes=[],this.rules[49].opcodes[0]={type:6,string:[38,38]},this.rules[50].opcodes=[],this.rules[50].opcodes[0]={type:6,string:[33,33]},this.rules[51].opcodes=[],this.rules[51].opcodes[0]={type:6,string:[37,94]},this.rules[52].opcodes=[],this.rules[52].opcodes[0]={type:6,string:[37,36]},this.rules[53].opcodes=[],this.rules[53].opcodes[0]={type:2,children:[1,2]},this.rules[53].opcodes[1]={type:6,string:[37]},this.rules[53].opcodes[2]={type:1,children:[3,8,13]},this.rules[53].opcodes[3]={type:2,children:[4,5,6,7]},this.rules[53].opcodes[4]={type:4,index:76},this.rules[53].opcodes[5]={type:4,index:79},this.rules[53].opcodes[6]={type:6,string:[45]},this.rules[53].opcodes[7]={type:4,index:80},this.rules[53].opcodes[8]={type:2,children:[9,10,11,12]},this.rules[53].opcodes[9]={type:4,index:77},this.rules[53].opcodes[10]={type:4,index:83},this.rules[53].opcodes[11]={type:6,string:[45]},this.rules[53].opcodes[12]={type:4,index:84},this.rules[53].opcodes[13]={type:2,children:[14,15,16,17]},this.rules[53].opcodes[14]={type:4,index:78},this.rules[53].opcodes[15]={type:4,index:81},this.rules[53].opcodes[16]={type:6,string:[45]},this.rules[53].opcodes[17]={type:4,index:82},this.rules[54].opcodes=[],this.rules[54].opcodes[0]={type:2,children:[1,2]},this.rules[54].opcodes[1]={type:6,string:[37]},this.rules[54].opcodes[2]={type:1,children:[3,10,17]},this.rules[54].opcodes[3]={type:2,children:[4,5,6]},this.rules[54].opcodes[4]={type:4,index:76},this.rules[54].opcodes[5]={type:4,index:73},this.rules[54].opcodes[6]={type:3,min:0,max:1/0},this.rules[54].opcodes[7]={type:2,children:[8,9]},this.rules[54].opcodes[8]={type:6,string:[46]},this.rules[54].opcodes[9]={type:4,index:73},this.rules[54].opcodes[10]={type:2,children:[11,12,13]},this.rules[54].opcodes[11]={type:4,index:77},this.rules[54].opcodes[12]={type:4,index:74},this.rules[54].opcodes[13]={type:3,min:0,max:1/0},this.rules[54].opcodes[14]={type:2,children:[15,16]},this.rules[54].opcodes[15]={type:6,string:[46]},this.rules[54].opcodes[16]={type:4,index:74},this.rules[54].opcodes[17]={type:2,children:[18,19,20]},this.rules[54].opcodes[18]={type:4,index:78},this.rules[54].opcodes[19]={type:4,index:75},this.rules[54].opcodes[20]={type:3,min:0,max:1/0},this.rules[54].opcodes[21]={type:2,children:[22,23]},this.rules[54].opcodes[22]={type:6,string:[46]},this.rules[54].opcodes[23]={type:4,index:75},this.rules[55].opcodes=[],this.rules[55].opcodes[0]={type:2,children:[1,2,3,4]},this.rules[55].opcodes[1]={type:4,index:56},this.rules[55].opcodes[2]={type:4,index:57},this.rules[55].opcodes[3]={type:4,index:59},this.rules[55].opcodes[4]={type:4,index:58},this.rules[56].opcodes=[],this.rules[56].opcodes[0]={type:3,min:0,max:1},this.rules[56].opcodes[1]={type:1,children:[2,3]},this.rules[56].opcodes[2]={type:7,string:[37,105]},this.rules[56].opcodes[3]={type:7,string:[37,115]},this.rules[57].opcodes=[],this.rules[57].opcodes[0]={type:6,string:[34]},this.rules[58].opcodes=[],this.rules[58].opcodes[0]={type:6,string:[34]},this.rules[59].opcodes=[],this.rules[59].opcodes[0]={type:3,min:0,max:1/0},this.rules[59].opcodes[1]={type:1,children:[2,3,4]},this.rules[59].opcodes[2]={type:5,min:32,max:33},this.rules[59].opcodes[3]={type:5,min:35,max:126},this.rules[59].opcodes[4]={type:4,index:60},this.rules[60].opcodes=[],this.rules[60].opcodes[0]={type:6,string:[9]},this.rules[61].opcodes=[],this.rules[61].opcodes[0]={type:2,children:[1,2,3]},this.rules[61].opcodes[1]={type:4,index:62},this.rules[61].opcodes[2]={type:4,index:64},this.rules[61].opcodes[3]={type:4,index:63},this.rules[62].opcodes=[],this.rules[62].opcodes[0]={type:6,string:[39]},this.rules[63].opcodes=[],this.rules[63].opcodes[0]={type:6,string:[39]},this.rules[64].opcodes=[],this.rules[64].opcodes[0]={type:3,min:0,max:1/0},this.rules[64].opcodes[1]={type:1,children:[2,3,4]},this.rules[64].opcodes[2]={type:5,min:32,max:38},this.rules[64].opcodes[3]={type:5,min:40,max:126},this.rules[64].opcodes[4]={type:4,index:60},this.rules[65].opcodes=[],this.rules[65].opcodes[0]={type:2,children:[1,2,3]},this.rules[65].opcodes[1]={type:4,index:66},this.rules[65].opcodes[2]={type:4,index:67},this.rules[65].opcodes[3]={type:4,index:68},this.rules[66].opcodes=[],this.rules[66].opcodes[0]={type:6,string:[60]},this.rules[67].opcodes=[],this.rules[67].opcodes[0]={type:3,min:0,max:1/0},this.rules[67].opcodes[1]={type:1,children:[2,3,4]},this.rules[67].opcodes[2]={type:5,min:32,max:61},this.rules[67].opcodes[3]={type:5,min:63,max:126},this.rules[67].opcodes[4]={type:4,index:60},this.rules[68].opcodes=[],this.rules[68].opcodes[0]={type:6,string:[62]},this.rules[69].opcodes=[],this.rules[69].opcodes[0]={type:4,index:72},this.rules[70].opcodes=[],this.rules[70].opcodes[0]={type:4,index:72},this.rules[71].opcodes=[],this.rules[71].opcodes[0]={type:4,index:72},this.rules[72].opcodes=[],this.rules[72].opcodes[0]={type:3,min:1,max:1/0},this.rules[72].opcodes[1]={type:5,min:48,max:57},this.rules[73].opcodes=[],this.rules[73].opcodes[0]={type:4,index:85},this.rules[74].opcodes=[],this.rules[74].opcodes[0]={type:4,index:87},this.rules[75].opcodes=[],this.rules[75].opcodes[0]={type:4,index:86},this.rules[76].opcodes=[],this.rules[76].opcodes[0]={type:1,children:[1,2]},this.rules[76].opcodes[1]={type:6,string:[68]},this.rules[76].opcodes[2]={type:6,string:[100]},this.rules[77].opcodes=[],this.rules[77].opcodes[0]={type:1,children:[1,2]},this.rules[77].opcodes[1]={type:6,string:[88]},this.rules[77].opcodes[2]={type:6,string:[120]},this.rules[78].opcodes=[],this.rules[78].opcodes[0]={type:1,children:[1,2]},this.rules[78].opcodes[1]={type:6,string:[66]},this.rules[78].opcodes[2]={type:6,string:[98]},this.rules[79].opcodes=[],this.rules[79].opcodes[0]={type:4,index:85},this.rules[80].opcodes=[],this.rules[80].opcodes[0]={type:4,index:85},this.rules[81].opcodes=[],this.rules[81].opcodes[0]={type:4,index:86},this.rules[82].opcodes=[],this.rules[82].opcodes[0]={type:4,index:86},this.rules[83].opcodes=[],this.rules[83].opcodes[0]={type:4,index:87},this.rules[84].opcodes=[],this.rules[84].opcodes[0]={type:4,index:87},this.rules[85].opcodes=[],this.rules[85].opcodes[0]={type:3,min:1,max:1/0},this.rules[85].opcodes[1]={type:5,min:48,max:57},this.rules[86].opcodes=[],this.rules[86].opcodes[0]={type:3,min:1,max:1/0},this.rules[86].opcodes[1]={type:5,min:48,max:49},this.rules[87].opcodes=[],this.rules[87].opcodes[0]={type:3,min:1,max:1/0},this.rules[87].opcodes[1]={type:1,children:[2,3,4]},this.rules[87].opcodes[2]={type:5,min:48,max:57},this.rules[87].opcodes[3]={type:5,min:65,max:70},this.rules[87].opcodes[4]={type:5,min:97,max:102},this.rules[88].opcodes=[],this.rules[88].opcodes[0]={type:2,children:[1,4]},this.rules[88].opcodes[1]={type:1,children:[2,3]},this.rules[88].opcodes[2]={type:5,min:97,max:122},this.rules[88].opcodes[3]={type:5,min:65,max:90},this.rules[88].opcodes[4]={type:3,min:0,max:1/0},this.rules[88].opcodes[5]={type:1,children:[6,7,8,9]},this.rules[88].opcodes[6]={type:5,min:97,max:122},this.rules[88].opcodes[7]={type:5,min:65,max:90},this.rules[88].opcodes[8]={type:5,min:48,max:57},this.rules[88].opcodes[9]={type:6,string:[45]},this.rules[89].opcodes=[],this.rules[89].opcodes[0]={type:3,min:0,max:1/0},this.rules[89].opcodes[1]={type:4,index:91},this.rules[90].opcodes=[],this.rules[90].opcodes[0]={type:3,min:1,max:1/0},this.rules[90].opcodes[1]={type:4,index:91},this.rules[91].opcodes=[],this.rules[91].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[91].opcodes[1]={type:6,string:[32]},this.rules[91].opcodes[2]={type:6,string:[9]},this.rules[91].opcodes[3]={type:4,index:92},this.rules[91].opcodes[4]={type:4,index:94},this.rules[92].opcodes=[],this.rules[92].opcodes[0]={type:2,children:[1,2]},this.rules[92].opcodes[1]={type:6,string:[59]},this.rules[92].opcodes[2]={type:3,min:0,max:1/0},this.rules[92].opcodes[3]={type:1,children:[4,5]},this.rules[92].opcodes[4]={type:5,min:32,max:126},this.rules[92].opcodes[5]={type:6,string:[9]},this.rules[93].opcodes=[],this.rules[93].opcodes[0]={type:1,children:[1,2,3]},this.rules[93].opcodes[1]={type:6,string:[13,10]},this.rules[93].opcodes[2]={type:6,string:[10]},this.rules[93].opcodes[3]={type:6,string:[13]},this.rules[94].opcodes=[],this.rules[94].opcodes[0]={type:2,children:[1,5]},this.rules[94].opcodes[1]={type:1,children:[2,3,4]},this.rules[94].opcodes[2]={type:6,string:[13,10]},this.rules[94].opcodes[3]={type:6,string:[10]},this.rules[94].opcodes[4]={type:6,string:[13]},this.rules[94].opcodes[5]={type:1,children:[6,7]},this.rules[94].opcodes[6]={type:6,string:[32]},this.rules[94].opcodes[7]={type:6,string:[9]},this.toString=function(){let e="";return e+=`;
`,e+=`; ABNF for JavaScript APG 2.0 SABNF
`,e+=`; RFC 5234 with some restrictions and additions.
`,e+=`; Updated 11/24/2015 for RFC 7405 case-sensitive literal string notation
`,e+=`;  - accepts %s"string" as a case-sensitive string
`,e+=`;  - accepts %i"string" as a case-insensitive string
`,e+=`;  - accepts "string" as a case-insensitive string
`,e+=`;
`,e+=`; Some restrictions:
`,e+=`;   1. Rules must begin at first character of each line.
`,e+=`;      Indentations on first rule and rules thereafter are not allowed.
`,e+=`;   2. Relaxed line endings. CRLF, LF or CR are accepted as valid line ending.
`,e+=`;   3. Prose values, i.e. <prose value>, are accepted as valid grammar syntax.
`,e+=`;      However, a working parser cannot be generated from them.
`,e+=`;
`,e+=`; Super set (SABNF) additions:
`,e+=`;   1. Look-ahead (syntactic predicate) operators are accepted as element prefixes.
`,e+=`;      & is the positive look-ahead operator, succeeds and backtracks if the look-ahead phrase is found
`,e+=`;      ! is the negative look-ahead operator, succeeds and backtracks if the look-ahead phrase is NOT found
`,e+=`;      e.g. &%d13 or &rule or !(A / B)
`,e+=`;   2. User-Defined Terminals (UDT) of the form, u_name and e_name are accepted.
`,e+=`;      'name' is alpha followed by alpha/num/hyphen just like a rule name.
`,e+=`;      u_name may be used as an element but no rule definition is given.
`,e+=`;      e.g. rule = A / u_myUdt
`,e+=`;           A = "a"
`,e+=`;      would be a valid grammar.
`,e+=`;   3. Case-sensitive, single-quoted strings are accepted.
`,e+=`;      e.g. 'abc' would be equivalent to %d97.98.99
`,e+=`;      (kept for backward compatibility, but superseded by %s"abc")  
`,e+=`; New 12/26/2015
`,e+=`;   4. Look-behind operators are accepted as element prefixes.
`,e+=`;      && is the positive look-behind operator, succeeds and backtracks if the look-behind phrase is found
`,e+=`;      !! is the negative look-behind operator, succeeds and backtracks if the look-behind phrase is NOT found
`,e+=`;      e.g. &&%d13 or &&rule or !!(A / B)
`,e+=`;   5. Back reference operators, i.e. \\rulename, are accepted.
`,e+=`;      A back reference operator acts like a TLS or TBS terminal except that the phrase it attempts
`,e+=`;      to match is a phrase previously matched by the rule 'rulename'.
`,e+=`;      There are two modes of previous phrase matching - the parent-frame mode and the universal mode.
`,e+=`;      In universal mode, \\rulename matches the last match to 'rulename' regardless of where it was found.
`,e+=`;      In parent-frame mode, \\rulename matches only the last match found on the parent's frame or parse tree level.
`,e+=`;      Back reference modifiers can be used to specify case and mode.
`,e+=`;      \\A defaults to case-insensitive and universal mode, e.g. \\A === \\%i%uA
`,e+=`;      Modifiers %i and %s determine case-insensitive and case-sensitive mode, respectively.
`,e+=`;      Modifiers %u and %p determine universal mode and parent frame mode, respectively.
`,e+=`;      Case and mode modifiers can appear in any order, e.g. \\%s%pA === \\%p%sA. 
`,e+=`;   7. String begin anchor, ABG(%^) matches the beginning of the input string location.
`,e+=`;      Returns EMPTY or NOMATCH. Never consumes any characters.
`,e+=`;   8. String end anchor, AEN(%$) matches the end of the input string location.
`,e+=`;      Returns EMPTY or NOMATCH. Never consumes any characters.
`,e+=`;
`,e+=`File            = *(BlankLine / Rule / RuleError)
`,e+=`BlankLine       = *(%d32/%d9) [comment] LineEnd
`,e+=`Rule            = RuleLookup owsp Alternation ((owsp LineEnd)
`,e+=`                / (LineEndError LineEnd))
`,e+=`RuleLookup      = RuleNameTest owsp DefinedAsTest
`,e+=`RuleNameTest    = RuleName/RuleNameError
`,e+=`RuleName        = alphanum
`,e+=`RuleNameError   = 1*(%d33-60/%d62-126)
`,e+=`DefinedAsTest   = DefinedAs / DefinedAsError
`,e+=`DefinedAsError  = 1*2%d33-126
`,e+=`DefinedAs       = IncAlt / Defined
`,e+=`Defined         = %d61
`,e+=`IncAlt          = %d61.47
`,e+=`RuleError       = 1*(%d32-126 / %d9  / LineContinue) LineEnd
`,e+=`LineEndError    = 1*(%d32-126 / %d9  / LineContinue)
`,e+=`Alternation     = Concatenation *(owsp AltOp Concatenation)
`,e+=`Concatenation   = Repetition *(CatOp Repetition)
`,e+=`Repetition      = [Modifier] (Group / Option / BasicElement / BasicElementErr)
`,e+=`Modifier        = (Predicate [RepOp])
`,e+=`                / RepOp
`,e+=`Predicate       = BkaOp
`,e+=`                / BknOp
`,e+=`                / AndOp
`,e+=`                / NotOp
`,e+=`BasicElement    = UdtOp
`,e+=`                / RnmOp
`,e+=`                / TrgOp
`,e+=`                / TbsOp
`,e+=`                / TlsOp
`,e+=`                / ClsOp
`,e+=`                / BkrOp
`,e+=`                / AbgOp
`,e+=`                / AenOp
`,e+=`                / ProsVal
`,e+=`BasicElementErr = 1*(%d33-40/%d42-46/%d48-92/%d94-126)
`,e+=`Group           = GroupOpen  Alternation (GroupClose / GroupError)
`,e+=`GroupError      = 1*(%d33-40/%d42-46/%d48-92/%d94-126) ; same as BasicElementErr
`,e+=`GroupOpen       = %d40 owsp
`,e+=`GroupClose      = owsp %d41
`,e+=`Option          = OptionOpen Alternation (OptionClose / OptionError)
`,e+=`OptionError     = 1*(%d33-40/%d42-46/%d48-92/%d94-126) ; same as BasicElementErr
`,e+=`OptionOpen      = %d91 owsp
`,e+=`OptionClose     = owsp %d93
`,e+=`RnmOp           = alphanum
`,e+=`BkrOp           = %d92 [bkrModifier] bkr-name
`,e+=`bkrModifier     = (cs [um / pm]) / (ci [um / pm]) / (um [cs /ci]) / (pm [cs / ci])
`,e+=`cs              = '%s'
`,e+=`ci              = '%i'
`,e+=`um              = '%u'
`,e+=`pm              = '%p'
`,e+=`bkr-name        = uname / ename / rname
`,e+=`rname           = alphanum
`,e+=`uname           = %d117.95 alphanum
`,e+=`ename           = %d101.95 alphanum
`,e+=`UdtOp           = udt-empty
`,e+=`                / udt-non-empty
`,e+=`udt-non-empty   = %d117.95 alphanum
`,e+=`udt-empty       = %d101.95 alphanum
`,e+=`RepOp           = (rep-min StarOp rep-max)
`,e+=`                / (rep-min StarOp)
`,e+=`                / (StarOp rep-max)
`,e+=`                / StarOp
`,e+=`                / rep-min-max
`,e+=`AltOp           = %d47 owsp
`,e+=`CatOp           = wsp
`,e+=`StarOp          = %d42
`,e+=`AndOp           = %d38
`,e+=`NotOp           = %d33
`,e+=`BkaOp           = %d38.38
`,e+=`BknOp           = %d33.33
`,e+=`AbgOp           = %d37.94
`,e+=`AenOp           = %d37.36
`,e+=`TrgOp           = %d37 ((Dec dmin %d45 dmax) / (Hex xmin %d45 xmax) / (Bin bmin %d45 bmax))
`,e+=`TbsOp           = %d37 ((Dec dString *(%d46 dString)) / (Hex xString *(%d46 xString)) / (Bin bString *(%d46 bString)))
`,e+=`TlsOp           = TlsCase TlsOpen TlsString TlsClose
`,e+=`TlsCase         = ["%i" / "%s"]
`,e+=`TlsOpen         = %d34
`,e+=`TlsClose        = %d34
`,e+=`TlsString       = *(%d32-33/%d35-126/StringTab)
`,e+=`StringTab       = %d9
`,e+=`ClsOp           = ClsOpen ClsString ClsClose
`,e+=`ClsOpen         = %d39
`,e+=`ClsClose        = %d39
`,e+=`ClsString       = *(%d32-38/%d40-126/StringTab)
`,e+=`ProsVal         = ProsValOpen ProsValString ProsValClose
`,e+=`ProsValOpen     = %d60
`,e+=`ProsValString   = *(%d32-61/%d63-126/StringTab)
`,e+=`ProsValClose    = %d62
`,e+=`rep-min         = rep-num
`,e+=`rep-min-max     = rep-num
`,e+=`rep-max         = rep-num
`,e+=`rep-num         = 1*(%d48-57)
`,e+=`dString         = dnum
`,e+=`xString         = xnum
`,e+=`bString         = bnum
`,e+=`Dec             = (%d68/%d100)
`,e+=`Hex             = (%d88/%d120)
`,e+=`Bin             = (%d66/%d98)
`,e+=`dmin            = dnum
`,e+=`dmax            = dnum
`,e+=`bmin            = bnum
`,e+=`bmax            = bnum
`,e+=`xmin            = xnum
`,e+=`xmax            = xnum
`,e+=`dnum            = 1*(%d48-57)
`,e+=`bnum            = 1*%d48-49
`,e+=`xnum            = 1*(%d48-57 / %d65-70 / %d97-102)
`,e+=`;
`,e+=`; Basics
`,e+=`alphanum        = (%d97-122/%d65-90) *(%d97-122/%d65-90/%d48-57/%d45)
`,e+=`owsp            = *space
`,e+=`wsp             = 1*space
`,e+=`space           = %d32
`,e+=`                / %d9
`,e+=`                / comment
`,e+=`                / LineContinue
`,e+=`comment         = %d59 *(%d32-126 / %d9)
`,e+=`LineEnd         = %d13.10
`,e+=`                / %d10
`,e+=`                / %d13
`,e+=`LineContinue    = (%d13.10 / %d10 / %d13) (%d32 / %d9)
`,e}}),ot}var lt,St;function nn(){return St||(St=1,lt=function(){const t="parser: ",e=Ve,n=e.ids,s=new(Zt()),a=new(en()),h=new(tn()),c=new e.parser;c.ast=new e.ast,c.callbacks=s.callbacks,c.ast.callbacks=a.callbacks;const L=function(O,H,b){if(H<0||H>=b)return-1;for(let p=0;p<O.length;p+=1)if(H>=O[p].beginChar&&H<O[p].beginChar+O[p].length)return p;return-1},P=function(O,H){let b=-1;if(H<O.length){for(let p=H;p<O.length;p+=1)if(O[p]!==null){b=O[p];break}}return b},m=function(O){O.forEach(H=>{const b=[],p=[];let I=0;H.opcodes.forEach(l=>{l.type===n.ALT&&l.children.length===1||l.type===n.CAT&&l.children.length===1||l.type===n.REP&&l.min===1&&l.max===1?p.push(null):(p.push(I),b.push(l),I+=1)}),p.push(I),b.forEach(l=>{if(l.type===n.ALT||l.type===n.CAT)for(let S=0;S<l.children.length;S+=1)l.children[S]=P(p,l.children[S])}),H.opcodes=b})};this.syntax=function(O,H,b,p,I){if(I){if(I.traceObject!=="traceObject")throw new TypeError(`${t}trace argument is not a trace object`);c.trace=I}const l={};l.errors=b,l.strict=!!p,l.lines=H,l.findLine=L,l.charsLength=O.length,l.ruleCount=0,c.parse(h,"file",O,l).success||b.push({line:0,char:0,msg:"syntax analysis of input grammar failed"})},this.semantic=function(O,H,b){const p={};return p.errors=b,p.lines=H,p.findLine=L,p.charsLength=O.length,c.ast.translate(p),b.length?null:(m(p.rules),{rules:p.rules,udts:p.udts,lineMap:p.rulesLineMap})},this.generateSource=function(O,H,b,p,I){let l="",S,q,z,J=0,k=1/0,D=0;const ee=[],oe=[];let C=0,$=0,M=0,w=0,K=0,ie=0,le=0,se=0,ge=0,ye=0,Y=0,X=0,V=0,T=0,he=0;b.forEach(ue=>{ee.push(ue.lower),J+=ue.opcodes.length,ue.opcodes.forEach(E=>{switch(E.type){case n.ALT:C+=1;break;case n.CAT:$+=1;break;case n.RNM:M+=1;break;case n.UDT:w+=1;break;case n.REP:K+=1;break;case n.AND:ie+=1;break;case n.NOT:le+=1;break;case n.BKA:X+=1;break;case n.BKN:V+=1;break;case n.BKR:Y+=1;break;case n.ABG:T+=1;break;case n.AEN:he+=1;break;case n.TLS:for(se+=1,S=0;S<E.string.length;S+=1)E.string[S]<k&&(k=E.string[S]),E.string[S]>D&&(D=E.string[S]);break;case n.TBS:for(ge+=1,S=0;S<E.string.length;S+=1)E.string[S]<k&&(k=E.string[S]),E.string[S]>D&&(D=E.string[S]);break;case n.TRG:ye+=1,E.min<k&&(k=E.min),E.max>D&&(D=E.max);break;default:throw new Error("generateSource: unrecognized opcode")}})}),ee.sort(),p.length>0&&(p.forEach(ue=>{oe.push(ue.lower)}),oe.sort());let Te="module.exports";I&&typeof I=="string"&&(Te=`let ${I}`),l+=`// copyright: Copyright (c) 2021 Lowell D. Thomas, all rights reserved<br>
`,l+=`//   license: BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)<br>
`,l+=`//
`,l+=`// Generated by apg-js, Version 4.0.0 [apg-js](https://github.com/ldthomas/apg-js)
`,l+=`${Te} = function grammar(){
`,l+="  // ```\n",l+=`  // SUMMARY
`,l+=`  //      rules = ${b.length}
`,l+=`  //       udts = ${p.length}
`,l+=`  //    opcodes = ${J}
`,l+=`  //        ---   ABNF original opcodes
`,l+=`  //        ALT = ${C}
`,l+=`  //        CAT = ${$}
`,l+=`  //        REP = ${K}
`,l+=`  //        RNM = ${M}
`,l+=`  //        TLS = ${se}
`,l+=`  //        TBS = ${ge}
`,l+=`  //        TRG = ${ye}
`,l+=`  //        ---   SABNF superset opcodes
`,l+=`  //        UDT = ${w}
`,l+=`  //        AND = ${ie}
`,l+=`  //        NOT = ${le}
`,l+=`  //        BKA = ${X}
`,l+=`  //        BKN = ${V}
`,l+=`  //        BKR = ${Y}
`,l+=`  //        ABG = ${T}
`,l+=`  //        AEN = ${he}
`,l+="  // characters = [",se+ge+ye===0?l+=" none defined ]":l+=`${k} - ${D}]`,w>0&&(l+=" + user defined"),l+=`
`,l+="  // ```\n",l+=`  /* OBJECT IDENTIFIER (for internal parser use) */
`,l+=`  this.grammarObject = 'grammarObject';
`,l+=`
`,l+=`  /* RULES */
`,l+=`  this.rules = [];
`,b.forEach((ue,E)=>{let f="  this.rules[";f+=E,f+="] = {name: '",f+=ue.name,f+="', lower: '",f+=ue.lower,f+="', index: ",f+=ue.index,f+=", isBkr: ",f+=ue.isBkr,f+=`};
`,l+=f}),l+=`
`,l+=`  /* UDTS */
`,l+=`  this.udts = [];
`,p.length>0&&p.forEach((ue,E)=>{let f="  this.udts[";f+=E,f+="] = {name: '",f+=ue.name,f+="', lower: '",f+=ue.lower,f+="', index: ",f+=ue.index,f+=", empty: ",f+=ue.empty,f+=", isBkr: ",f+=ue.isBkr,f+=`};
`,l+=f}),l+=`
`,l+=`  /* OPCODES */
`,b.forEach((ue,E)=>{E>0&&(l+=`
`),l+=`  /* ${ue.name} */
`,l+=`  this.rules[${E}].opcodes = [];
`,ue.opcodes.forEach((f,A)=>{let v;switch(f.type){case n.ALT:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, children: [${f.children.toString()}]};// ALT
`;break;case n.CAT:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, children: [${f.children.toString()}]};// CAT
`;break;case n.RNM:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, index: ${f.index}};// RNM(${b[f.index].name})
`;break;case n.BKR:f.index>=b.length?(q=p[f.index-b.length].name,z=p[f.index-b.length].lower):(q=b[f.index].name,z=b[f.index].lower),v="%i",f.bkrCase===n.BKR_MODE_CS&&(v="%s"),f.bkrMode===n.BKR_MODE_UM?v+="%u":v+="%p",q=v+q,l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, index: ${f.index}, lower: '${z}', bkrCase: ${f.bkrCase}, bkrMode: ${f.bkrMode}};// BKR(\\${q})
`;break;case n.UDT:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, empty: ${f.empty}, index: ${f.index}};// UDT(${p[f.index].name})
`;break;case n.REP:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, min: ${f.min}, max: ${f.max}};// REP
`;break;case n.AND:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}};// AND
`;break;case n.NOT:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}};// NOT
`;break;case n.ABG:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}};// ABG(%^)
`;break;case n.AEN:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}};// AEN(%$)
`;break;case n.BKA:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}};// BKA
`;break;case n.BKN:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}};// BKN
`;break;case n.TLS:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, string: [${f.string.toString()}]};// TLS
`;break;case n.TBS:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, string: [${f.string.toString()}]};// TBS
`;break;case n.TRG:l+=`  this.rules[${E}].opcodes[${A}] = {type: ${f.type}, min: ${f.min}, max: ${f.max}};// TRG
`;break;default:throw new Error("parser.js: ~143: unrecognized opcode")}})}),l+=`
`,l+="  // The `toString()` function will display the original grammar file(s) that produced these opcodes.\n",l+=`  this.toString = function toString(){
`,l+=`    let str = "";
`;let xe;return H.forEach(ue=>{const E=ue.beginChar+ue.length;xe="",l+='    str += "';for(let f=ue.beginChar;f<E;f+=1){switch(O[f]){case 9:xe=" ";break;case 10:xe="\\n";break;case 13:xe="\\r";break;case 34:xe='\\"';break;case 92:xe="\\\\";break;default:xe=String.fromCharCode(O[f]);break}l+=xe}l+=`";
`}),l+=`    return str;
`,l+=`  }
`,l+=`}
`,l},this.generateObject=function(O,H,b){const p={},I=[],l=[],S=O.slice(0);return p.grammarObject="grammarObject",H.forEach(q=>{I.push(q.lower)}),I.sort(),b.length>0&&(b.forEach(q=>{l.push(q.lower)}),l.sort()),p.callbacks=[],I.forEach(q=>{p.callbacks[q]=!1}),b.length>0&&l.forEach(q=>{p.callbacks[q]=!1}),p.rules=H,p.udts=b,p.toString=function(){return S},p}}),lt}var at,Mt;function sn(){return Mt||(Mt=1,at=function(){const t=$e,e="rule-attributes.js";let n=null;function s(C){return C.left||C.nested||C.right||C.cyclic?!1:C.empty}function a(C){return!!(C.left||C.nested||C.right||C.cyclic)}function h(C,$){let M=0,w=0,K=0;for(M=0;M<$;M+=1)if(C[M].nested)return!0;for(M=0;M<$;M+=1)if(C[M].right&&!C[M].leaf){for(w=M+1;w<$;w+=1)if(!s(C[w]))return!0}for(M=$-1;M>=0;M-=1)if(C[M].left&&!C[M].leaf){for(w=M-1;w>=0;w-=1)if(!s(C[w]))return!0}for(M=0;M<$;M+=1)if(!C[M].empty&&!a(C[M])){for(w=M+1;w<$;w+=1)if(a(C[w])){for(K=w+1;K<$;K+=1)if(!C[K].empty&&!a(C[K]))return!0}}return!1}function c(C,$){for(let M=0;M<$;M+=1)if(!C[M].cyclic)return!1;return!0}function L(C,$){for(let M=0;M<$;M+=1){if(C[M].left)return!0;if(!C[M].empty)return!1}return!1}function P(C,$){for(let M=$-1;M>=0;M-=1){if(C[M].right)return!0;if(!C[M].empty)return!1}return!1}function m(C,$){for(let M=0;M<$;M+=1)if(!C[M].empty)return!1;return!0}function d(C,$){for(let M=0;M<$;M+=1)if(!C[M].finite)return!1;return!0}function O(C,$,M,w){let K=0;const ie=$[M],le=ie.children.length,se=[];for(K=0;K<le;K+=1)se.push(C.attrGen());for(K=0;K<le;K+=1)p(C,$,ie.children[K],se[K]);w.left=L(se,le),w.right=P(se,le),w.nested=h(se,le),w.empty=m(se,le),w.finite=d(se,le),w.cyclic=c(se,le)}function H(C,$,M,w){let K=0;const ie=$[M],le=ie.children.length,se=[];for(K=0;K<le;K+=1)se.push(C.attrGen());for(K=0;K<le;K+=1)p(C,$,ie.children[K],se[K]);for(w.left=!1,w.right=!1,w.nested=!1,w.empty=!1,w.finite=!1,w.cyclic=!1,K=0;K<le;K+=1)se[K].left&&(w.left=!0),se[K].nested&&(w.nested=!0),se[K].right&&(w.right=!0),se[K].empty&&(w.empty=!0),se[K].finite&&(w.finite=!0),se[K].cyclic&&(w.cyclic=!0)}function b(C,$,M,w){const K=$[M];K.index>=C.ruleCount?(w.empty=C.udts[K.index-C.ruleCount].empty,w.finite=!0):(I(C,K.index,w),w.left=!1,w.nested=!1,w.right=!1,w.cyclic=!1)}function p(C,$,M,w){C.attrInit(w);const K=$[M];switch(K.type){case t.ALT:H(C,$,M,w);break;case t.CAT:O(C,$,M,w);break;case t.REP:p(C,$,M+1,w),K.min===0&&(w.empty=!0,w.finite=!0);break;case t.RNM:I(C,$[M].index,w);break;case t.BKR:b(C,$,M,w);break;case t.AND:case t.NOT:case t.BKA:case t.BKN:p(C,$,M+1,w),w.empty=!0;break;case t.TLS:w.empty=!$[M].string.length,w.finite=!0,w.cyclic=!1;break;case t.TBS:case t.TRG:w.empty=!1,w.finite=!0,w.cyclic=!1;break;case t.UDT:w.empty=K.empty,w.finite=!0,w.cyclic=!1;break;case t.ABG:case t.AEN:w.empty=!0,w.finite=!0,w.cyclic=!1;break;default:throw new Error(`unknown opcode type: ${K}`)}}function I(C,$,M){const w=C.attrsWorking[$];w.isComplete?C.attrCopy(M,w):w.isOpen?$===C.startRule?$===C.startRule&&(M.left=!0,M.right=!0,M.cyclic=!0,M.leaf=!0):M.finite=!0:(w.isOpen=!0,p(C,w.rule.opcodes,0,M),w.left=M.left,w.right=M.right,w.nested=M.nested,w.empty=M.empty,w.finite=M.finite,w.cyclic=M.cyclic,w.leaf=!1,w.isOpen=!1,w.isComplete=!0)}const l=C=>{n=C;let $=0,M=0;const w=n.attrGen();for($=0;$<n.ruleCount;$+=1){for(M=0;M<n.ruleCount;M+=1)n.attrInit(n.attrsWorking[M]);n.startRule=$,I(n,$,w),n.attrCopy(n.attrs[$],n.attrsWorking[$])}n.attributesComplete=!0;let K=null;for($=0;$<n.ruleCount;$+=1)if(K=n.attrs[$],K.left||!K.finite||K.cyclic){const ie=n.attrGen(K.rule);n.attrCopy(ie,K),n.attrsErrors.push(ie),n.attrsErrorCount+=1}},S=C=>C?"t":"f",q=C=>C?"e":"f",z=C=>C?"t":"e",J=(C,$,M,w)=>{let K=`${C}:${$}:`;return K+=`${q(M.left)} `,K+=`${S(M.nested)} `,K+=`${S(M.right)} `,K+=`${q(M.cyclic)} `,K+=`${z(M.finite)} `,K+=`${S(M.empty)}:`,K+=`${n.typeToString(w.recursiveType)}:`,K+=w.recursiveType===t.ATTR_MR?w.groupNumber:"-",K+=`:${M.rule.name}
`,K},k=()=>{let C=`LEGEND - t=true, f=false, e=error
`;return C+=`sequence:rule index:left nested right cyclic finite empty:type:group number:rule name
`,C},D=()=>{let C=null,$=null,M="";if(M+=`RULE ATTRIBUTES WITH ERRORS
`,M+=k(),n.attrsErrorCount)for(let w=0;w<n.attrsErrorCount;w+=1)C=n.attrsErrors[w],$=n.ruleDeps[C.rule.index],M+=J(w,C.rule.index,C,$);else M+=`<none>
`;return M},ee=C=>{let $=0,M=0,w=null,K=null,ie="",{ruleIndexes:le}=n;for(C===97?le=n.ruleAlphaIndexes:C===116&&(le=n.ruleTypeIndexes),$=0;$<n.ruleCount;$+=1)M=le[$],w=n.attrs[M],K=n.ruleDeps[M],ie+=J($,M,w,K);return ie};return{ruleAttributes:l,showAttributes:(C="index")=>{if(!n.attributesComplete)throw new Error(`${e}:showAttributes: attributes not available`);let $="";const M=`RULE ATTRIBUTES
`;return C.charCodeAt(0)===97?($+=`alphabetical by rule name
`,$+=M,$+=k(),$+=ee(97)):C.charCodeAt(0)===116?($+=`ordered by rule type
`,$+=M,$+=k(),$+=ee(116)):($+=`ordered by rule index
`,$+=M,$+=k(),$+=ee()),$},showAttributeErrors:D}}()),at}var ct,$t;function rn(){return $t||($t=1,ct=(()=>{const i=$e;let t=null;const e=(h,c,L,P)=>{let m=0,d=0;const O=c[L];P[L]=!0;const H=O.rule.opcodes;for(m=0;m<H.length;m+=1){const b=H[m];if(b.type===i.RNM)for(O.refersTo[b.index]=!0,P[b.index]||e(h,c,b.index,P),d=0;d<h;d+=1)c[b.index].refersTo[d]&&(O.refersTo[d]=!0);else b.type===i.UDT?O.refersToUdt[b.index]=!0:b.type===i.BKR&&(b.index<h?(O.refersTo[b.index]=!0,P[b.index]||e(h,c,b.index,P)):O.refersToUdt[h-b.index]=!0)}},n=h=>{t=h;let c=0,L=0,P=0,m=null,d=null,O=!1;t.dependenciesComplete=!1;const H=t.falseArray(t.ruleCount);for(c=0;c<t.ruleCount;c+=1)t.falsifyArray(H),e(t.ruleCount,t.ruleDeps,c,H);for(c=0;c<t.ruleCount;c+=1)for(L=0;L<t.ruleCount;L+=1)c!==L&&t.ruleDeps[L].refersTo[c]&&(t.ruleDeps[c].referencedBy[L]=!0);for(c=0;c<t.ruleCount;c+=1)t.ruleDeps[c].recursiveType=i.ATTR_N,t.ruleDeps[c].refersTo[c]&&(t.ruleDeps[c].recursiveType=i.ATTR_R);for(P=-1,c=0;c<t.ruleCount;c+=1)if(m=t.ruleDeps[c],m.recursiveType===i.ATTR_R)for(O=!0,L=0;L<t.ruleCount;L+=1)c!==L&&(d=t.ruleDeps[L],d.recursiveType===i.ATTR_R&&m.refersTo[L]&&d.refersTo[c]&&(O&&(P+=1,m.recursiveType=i.ATTR_MR,m.groupNumber=P,O=!1),d.recursiveType=i.ATTR_MR,d.groupNumber=P));t.isMutuallyRecursive=P>-1,t.ruleAlphaIndexes.sort(t.compRulesAlpha),t.ruleTypeIndexes.sort(t.compRulesAlpha),t.ruleTypeIndexes.sort(t.compRulesType),t.isMutuallyRecursive&&t.ruleTypeIndexes.sort(t.compRulesGroup),t.udtCount&&t.udtAlphaIndexes.sort(t.compUdtsAlpha),t.dependenciesComplete=!0},s=(h=null)=>{let c=0,L=0,P=0,m=0;const d=t.ruleCount-1,O=t.udtCount-1,H=100;let b="",p="";const I="=> ",l="<= ";let S=!1,q=null,{ruleIndexes:z}=t,{udtIndexes:J}=t;for(h===97?(z=t.ruleAlphaIndexes,J=t.udtAlphaIndexes):h===116&&(z=t.ruleTypeIndexes,J=t.udtAlphaIndexes),c=0;c<t.ruleCount;c+=1){for(q=t.ruleDeps[z[c]],p=`${z[c]}:${t.typeToString(q.recursiveType)}:`,t.isMutuallyRecursive&&(p+=q.groupNumber>-1?q.groupNumber:"-",p+=":"),p+=" ",b+=`${p+t.rules[z[c]].name}
`,S=!0,P=0,m=b.length,b+=p,L=0;L<t.ruleCount;L+=1)q.refersTo[z[L]]&&(S?(b+=I,S=!1,b+=t.ruleDeps[z[L]].rule.name):b+=`, ${t.ruleDeps[z[L]].rule.name}`,P+=1),b.length-m>H&&L!==d&&(b+=`
${p}${I}`,m=b.length);if(t.udtCount)for(L=0;L<t.udtCount;L+=1)q.refersToUdt[J[L]]&&(S?(b+=I,S=!1,b+=t.udts[J[L]].name):b+=`, ${t.udts[J[L]].name}`,P+=1),b.length-m>H&&L!==O&&(b+=`
${p}${I}`,m=b.length);for(P===0&&(b+=`=> <none>
`),S===!1&&(b+=`
`),S=!0,P=0,m=b.length,b+=p,L=0;L<t.ruleCount;L+=1)q.referencedBy[z[L]]&&(S?(b+=l,S=!1,b+=t.ruleDeps[z[L]].rule.name):b+=`, ${t.ruleDeps[z[L]].rule.name}`,P+=1),b.length-m>H&&L!==d&&(b+=`
${p}${I}`,m=b.length);P===0&&(b+=`<= <none>
`),S===!1&&(b+=`
`),b+=`
`}return b};return{ruleDependencies:n,showRuleDependencies:(h="index")=>{let c=`RULE DEPENDENCIES(index:type:[group number:])
`;return c+=`=> refers to rule names
`,c+=`<= referenced by rule names
`,t.dependenciesComplete&&(h.charCodeAt(0)===97?(c+=`alphabetical by rule name
`,c+=s(97)):h.charCodeAt(0)===116?(c+=`ordered by rule type
`,c+=s(116)):(c+=`ordered by rule index
`,c+=s(null))),c}}})()),ct}var ut,Ot;function on(){return Ot||(Ot=1,ut=function(){const t=$e,{ruleAttributes:e,showAttributes:n,showAttributeErrors:s}=sn(),{ruleDependencies:a,showRuleDependencies:h}=rn();class c{constructor(m,d){this.rules=m,this.udts=d,this.ruleCount=m.length,this.udtCount=d.length,this.startRule=0,this.dependenciesComplete=!1,this.attributesComplete=!1,this.isMutuallyRecursive=!1,this.ruleIndexes=this.indexArray(this.ruleCount),this.ruleAlphaIndexes=this.indexArray(this.ruleCount),this.ruleTypeIndexes=this.indexArray(this.ruleCount),this.udtIndexes=this.indexArray(this.udtCount),this.udtAlphaIndexes=this.indexArray(this.udtCount),this.attrsErrorCount=0,this.attrs=[],this.attrsErrors=[],this.attrsWorking=[],this.ruleDeps=[];for(let O=0;O<this.ruleCount;O+=1)this.attrs.push(this.attrGen(this.rules[O])),this.attrsWorking.push(this.attrGen(this.rules[O])),this.ruleDeps.push(this.rdGen(m[O],this.ruleCount,this.udtCount));this.compRulesAlpha=this.compRulesAlpha.bind(this),this.compUdtsAlpha=this.compUdtsAlpha.bind(this),this.compRulesType=this.compRulesType.bind(this),this.compRulesGroup=this.compRulesGroup.bind(this)}attrGen(m){return{left:!1,nested:!1,right:!1,empty:!1,finite:!1,cyclic:!1,leaf:!1,isOpen:!1,isComplete:!1,rule:m}}attrInit(m){m.left=!1,m.nested=!1,m.right=!1,m.empty=!1,m.finite=!1,m.cyclic=!1,m.leaf=!1,m.isOpen=!1,m.isComplete=!1}attrCopy(m,d){m.left=d.left,m.nested=d.nested,m.right=d.right,m.empty=d.empty,m.finite=d.finite,m.cyclic=d.cyclic,m.leaf=d.leaf,m.isOpen=d.isOpen,m.isComplete=d.isComplete,m.rule=d.rule}rdGen(m,d,O){return{rule:m,recursiveType:t.ATTR_N,groupNumber:-1,refersTo:this.falseArray(d),refersToUdt:this.falseArray(O),referencedBy:this.falseArray(d)}}typeToString(m){switch(m){case t.ATTR_N:return" N";case t.ATTR_R:return" R";case t.ATTR_MR:return"MR";default:return"UNKNOWN"}}falseArray(m){const d=[];if(m>0)for(let O=0;O<m;O+=1)d.push(!1);return d}falsifyArray(m){for(let d=0;d<m.length;d+=1)m[d]=!1}indexArray(m){const d=[];if(m>0)for(let O=0;O<m;O+=1)d.push(O);return d}compRulesAlpha(m,d){return this.rules[m].lower<this.rules[d].lower?-1:this.rules[m].lower>this.rules[d].lower?1:0}compUdtsAlpha(m,d){return this.udts[m].lower<this.udts[d].lower?-1:this.udts[m].lower>this.udts[d].lower?1:0}compRulesType(m,d){return this.ruleDeps[m].recursiveType<this.ruleDeps[d].recursiveType?-1:this.ruleDeps[m].recursiveType>this.ruleDeps[d].recursiveType?1:0}compRulesGroup(m,d){if(this.ruleDeps[m].recursiveType===t.ATTR_MR&&this.ruleDeps[d].recursiveType===t.ATTR_MR){if(this.ruleDeps[m].groupNumber<this.ruleDeps[d].groupNumber)return-1;if(this.ruleDeps[m].groupNumber>this.ruleDeps[d].groupNumber)return 1}return 0}}return{attributes:function(m=[],d=[],O=[],H=[]){const b=new c(m,d);return a(b),e(b),b.attrsErrorCount&&H.push({line:0,char:0,msg:`${b.attrsErrorCount} attribute errors`}),b.attrsErrorCount},showAttributes:n,showAttributeErrors:s,showRuleDependencies:h}}()),ut}var ht,Lt;function ln(){return Lt||(Lt=1,ht=function(){const t="show-rules.js";return function(s=[],a=[],h="index"){const c="showRules";let L=[],P=[];const m=[],d=[],O=s,H=a,b=s.length,p=a.length;let I="RULE/UDT NAMES",l;function S(z,J){return O[z].lower<O[J].lower?-1:O[z].lower>O[J].lower?1:0}function q(z,J){return H[z].lower<H[J].lower?-1:H[z].lower>H[J].lower?1:0}if(!(Array.isArray(s)&&s.length))throw new Error(`${t}:${c}: rules arg must be array with length > 0`);if(!Array.isArray(a))throw new Error(`${t}:${c}: udts arg must be array`);for(l=0;l<b;l+=1)m.push(l);if(L=m.slice(0),L.sort(S),p){for(l=0;l<p;l+=1)d.push(l);P=d.slice(0),P.sort(q)}if(h.charCodeAt(0)===97){for(I+=` - alphabetical by rule/UDT name
`,l=0;l<b;l+=1)I+=`${l}: ${L[l]}: ${O[L[l]].name}
`;if(p)for(l=0;l<p;l+=1)I+=`${l}: ${P[l]}: ${H[P[l]].name}
`}else{for(I+=` - ordered by rule/UDT index
`,l=0;l<b;l+=1)I+=`${l}: ${O[l].name}
`;if(p)for(l=0;l<p;l+=1)I+=`${l}: ${H[l].name}
`}return I}}()),ht}var cn=function(t){const e="api.js: ",n=this,s=Ve,a=De,h=Qt(),c=new(nn()),{attributes:L,showAttributes:P,showAttributeErrors:m,showRuleDependencies:d}=on(),O=ln(),H=function(C,$,M){const le=`<span class="${s.style.CLASS_CTRLCHAR}">`,se="</span>",ge=`<span class="${s.style.CLASS_NOMATCH}">`,ye="</span>";let Y,X="";const V=!0;for(;V&&!(!Array.isArray(C)||C.length===0);){if(typeof $!="number")throw new Error("abnfToHtml: beg must be type number");if($>=C.length)break;typeof M!="number"||$+M>=C.length?Y=C.length:Y=$+M;let T=0;for(let he=$;he<Y;he+=1){const Te=C[he];if(Te>=32&&Te<=126)switch(T===1?(X+=se,T=0):T===2&&(X+=ye,T=0),Te){case 32:X+="&nbsp;";break;case 60:X+="&lt;";break;case 62:X+="&gt;";break;case 38:X+="&amp;";break;case 34:X+="&quot;";break;case 39:X+="&#039;";break;case 92:X+="&#092;";break;default:X+=String.fromCharCode(Te);break}else Te===9||Te===10||Te===13?(T===0?(X+=le,T=1):T===2&&(X+=ye+le,T=1),Te===9&&(X+="TAB"),Te===10&&(X+="LF"),Te===13&&(X+="CR")):(T===0?(X+=ge,T=2):T===1&&(X+=se+ge,T=2),X+=`\\x${s.utils.charToHex(Te)}`)}T===2&&(X+=ye),T===1&&(X+=se);break}return X},b=function(C,$,M){let w="";for(let K=$;K<$+M;K+=1){const ie=C[K];if(ie>=32&&ie<=126)w+=String.fromCharCode(ie);else switch(ie){case 9:w+="\\t";break;case 10:w+="\\n";break;case 13:w+="\\r";break;default:w+="\\unknown";break}}return w},p=function(C){let $="Annotated Input Grammar";return C.forEach(M=>{$+=`
`,$+=`line no: ${M.lineNo}`,$+=` : char index: ${M.beginChar}`,$+=` : length: ${M.length}`,$+=` : abnf: ${b(n.chars,M.beginChar,M.length)}`}),$+=`
`,$},I=function(C){let $="";return $+=`<table class="${s.style.CLASS_GRAMMAR}">
`,$+=`<caption>Annotated Input Grammar</caption>
`,$+="<tr>",$+="<th>line<br>no.</th><th>first<br>char</th><th><br>length</th><th><br>text</th>",$+=`</tr>
`,C.forEach(w=>{$+="<tr>",$+=`<td>${w.lineNo}`,$+=`</td><td>${w.beginChar}`,$+=`</td><td>${w.length}`,$+=`</td><td>${H(n.chars,w.beginChar,w.length)}`,$+="</td>",$+=`</tr>
`}),$+=`</table>
`,$},l=function(C,$,M,w){const[K]=s;let ie="";const le=`<span class="${K.CLASS_NOMATCH}">&raquo;</span>`;return ie+=`<p><table class="${K.CLASS_GRAMMAR}">
`,w&&typeof w=="string"&&(ie+=`<caption>${w}</caption>
`),ie+=`<tr><th>line<br>no.</th><th>line<br>offset</th><th>error<br>offset</th><th><br>text</th></tr>
`,C.forEach(se=>{let ge,ye,Y,X,V,T="",he="";$.length===0?(V=le,ye=0):(ge=$[se.line],Y=ge.beginChar,se.char>Y&&(T=H(M,Y,se.char-Y)),Y=se.char,X=ge.beginChar+ge.length,Y<X&&(he=H(M,Y,X-Y)),V=T+le+he,ye=se.char-ge.beginChar,ie+="<tr>",ie+=`<td>${se.line}</td><td>${ge.beginChar}</td><td>${ye}</td><td>${V}</td>`,ie+=`</tr>
`,ie+="<tr>",ie+=`<td colspan="3"></td><td>&uarr;:&nbsp;${s.utils.stringToAsciiHtml(se.msg)}</td>`,ie+=`</tr>
`)}),ie+=`</table></p>
`,ie},S=function(C,$,M){let w,K,ie,le;return w="",C.forEach(se=>{K=$[se.line],w+=`${K.lineNo}: `,w+=`${K.beginChar}: `,w+=`${se.char-K.beginChar}: `,ie=K.beginChar,le=se.char-K.beginChar,w+=b(M,ie,le),w+=" >> ",ie=se.char,le=K.beginChar+K.length-se.char,w+=b(M,ie,le),w+=`
`,w+=`${K.lineNo}: `,w+=`${K.beginChar}: `,w+=`${se.char-K.beginChar}: `,w+="error: ",w+=se.msg,w+=`
`}),w};let q=!1,z=!1,J=!1,k=!1,D=0,ee;if(this.errors=[],Buffer.isBuffer(t))this.chars=a.decode("BINARY",t);else if(Array.isArray(t))this.chars=t.slice();else if(typeof t=="string")this.chars=a.decode("STRING",t);else throw new Error(`${e}input source is not a string, byte Buffer or character array`);this.sabnf=a.encode("STRING",this.chars),this.scan=function(C,$){this.lines=h(this.chars,this.errors,C,$),q=!0},this.parse=function(C,$){if(!q)throw new Error(`${e}grammar not scanned`);c.syntax(this.chars,this.lines,this.errors,C,$),z=!0},this.translate=function(){if(!z)throw new Error(`${e}grammar not scanned and parsed`);const C=c.semantic(this.chars,this.lines,this.errors);this.errors.length===0&&(this.rules=C.rules,this.udts=C.udts,ee=C.lineMap,J=!0)},this.attributes=function(){if(!J)throw new Error(`${e}grammar not scanned, parsed and translated`);return D=L(this.rules,this.udts,ee,this.errors),k=!0,D},this.generate=function(C){if(this.lines=h(this.chars,this.errors,C),this.errors.length||(c.syntax(this.chars,this.lines,this.errors,C),this.errors.length))return;const $=c.semantic(this.chars,this.lines,this.errors);this.errors.length||(this.rules=$.rules,this.udts=$.udts,ee=$.lineMap,D=L(this.rules,this.udts,ee,this.errors),k=!0)},this.displayRules=function(C="index"){if(!J)throw new Error(`${e}grammar not scanned, parsed and translated`);return O(this.rules,this.udts,C)},this.displayRuleDependencies=function(C="index"){if(!k)throw new Error(`${e}no attributes - must be preceeded by call to attributes()`);return d(C)},this.displayAttributes=function(C="index"){if(!k)throw new Error(`${e}no attributes - must be preceeded by call to attributes()`);return D&&m(C),P(C)},this.displayAttributeErrors=function(){if(!k)throw new Error(`${e}no attributes - must be preceeded by call to attributes()`);return m()},this.toSource=function(C){if(!k)throw new Error(`${e}can't generate parser source - must be preceeded by call to attributes()`);if(D)throw new Error(`${e}can't generate parser source - attributes have ${D} errors`);return c.generateSource(this.chars,this.lines,this.rules,this.udts,C)},this.toObject=function(){if(!k)throw new Error(`${e}can't generate parser source - must be preceeded by call to attributes()`);if(D)throw new Error(`${e}can't generate parser source - attributes have ${D} errors`);return c.generateObject(this.sabnf,this.rules,this.udts)},this.errorsToAscii=function(){return S(this.errors,this.lines,this.chars)},this.errorsToHtml=function(C){return l(this.errors,this.lines,this.chars,C)},this.linesToAscii=function(){return p(this.lines)},this.linesToHtml=function(){return I(this.lines)}};export{cn as a,Ve as n};
