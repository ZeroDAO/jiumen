import{r as yr}from"./@ethersproject-c84a39ae.js";function gr(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Lr={},z={},ar={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function i(o,s){var b=o>>>16&65535,w=o&65535,C=s>>>16&65535,B=s&65535;return w*B+(b*B+w*C<<16>>>0)|0}e.mul=Math.imul||i;function a(o,s){return o+s|0}e.add=a;function g(o,s){return o-s|0}e.sub=g;function L(o,s){return o<<s|o>>>32-s}e.rotl=L;function F(o,s){return o<<32-s|o>>>s}e.rotr=F;function X(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}e.isInteger=Number.isInteger||X,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(o){return e.isInteger(o)&&o>=-e.MAX_SAFE_INTEGER&&o<=e.MAX_SAFE_INTEGER}})(ar);Object.defineProperty(z,"__esModule",{value:!0});var hr=ar;function Ur(e,i){return i===void 0&&(i=0),(e[i+0]<<8|e[i+1])<<16>>16}z.readInt16BE=Ur;function Ar(e,i){return i===void 0&&(i=0),(e[i+0]<<8|e[i+1])>>>0}z.readUint16BE=Ar;function Sr(e,i){return i===void 0&&(i=0),(e[i+1]<<8|e[i])<<16>>16}z.readInt16LE=Sr;function Mr(e,i){return i===void 0&&(i=0),(e[i+1]<<8|e[i])>>>0}z.readUint16LE=Mr;function or(e,i,a){return i===void 0&&(i=new Uint8Array(2)),a===void 0&&(a=0),i[a+0]=e>>>8,i[a+1]=e>>>0,i}z.writeUint16BE=or;z.writeInt16BE=or;function sr(e,i,a){return i===void 0&&(i=new Uint8Array(2)),a===void 0&&(a=0),i[a+0]=e>>>0,i[a+1]=e>>>8,i}z.writeUint16LE=sr;z.writeInt16LE=sr;function Wt(e,i){return i===void 0&&(i=0),e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]}z.readInt32BE=Wt;function kt(e,i){return i===void 0&&(i=0),(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])>>>0}z.readUint32BE=kt;function tr(e,i){return i===void 0&&(i=0),e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]}z.readInt32LE=tr;function rr(e,i){return i===void 0&&(i=0),(e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i])>>>0}z.readUint32LE=rr;function qt(e,i,a){return i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0),i[a+0]=e>>>24,i[a+1]=e>>>16,i[a+2]=e>>>8,i[a+3]=e>>>0,i}z.writeUint32BE=qt;z.writeInt32BE=qt;function $t(e,i,a){return i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0),i[a+0]=e>>>0,i[a+1]=e>>>8,i[a+2]=e>>>16,i[a+3]=e>>>24,i}z.writeUint32LE=$t;z.writeInt32LE=$t;function Hr(e,i){i===void 0&&(i=0);var a=Wt(e,i),g=Wt(e,i+4);return a*4294967296+g-(g>>31)*4294967296}z.readInt64BE=Hr;function Br(e,i){i===void 0&&(i=0);var a=kt(e,i),g=kt(e,i+4);return a*4294967296+g}z.readUint64BE=Br;function Tr(e,i){i===void 0&&(i=0);var a=tr(e,i),g=tr(e,i+4);return g*4294967296+a-(a>>31)*4294967296}z.readInt64LE=Tr;function mr(e,i){i===void 0&&(i=0);var a=rr(e,i),g=rr(e,i+4);return g*4294967296+a}z.readUint64LE=mr;function cr(e,i,a){return i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0),qt(e/4294967296>>>0,i,a),qt(e>>>0,i,a+4),i}z.writeUint64BE=cr;z.writeInt64BE=cr;function ur(e,i,a){return i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0),$t(e>>>0,i,a),$t(e/4294967296>>>0,i,a+4),i}z.writeUint64LE=ur;z.writeInt64LE=ur;function Nr(e,i,a){if(a===void 0&&(a=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>i.length-a)throw new Error("readUintBE: array is too short for the given bitLength");for(var g=0,L=1,F=e/8+a-1;F>=a;F--)g+=i[F]*L,L*=256;return g}z.readUintBE=Nr;function Cr(e,i,a){if(a===void 0&&(a=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>i.length-a)throw new Error("readUintLE: array is too short for the given bitLength");for(var g=0,L=1,F=a;F<a+e/8;F++)g+=i[F]*L,L*=256;return g}z.readUintLE=Cr;function Pr(e,i,a,g){if(a===void 0&&(a=new Uint8Array(e/8)),g===void 0&&(g=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!hr.isSafeInteger(i))throw new Error("writeUintBE value must be an integer");for(var L=1,F=e/8+g-1;F>=g;F--)a[F]=i/L&255,L*=256;return a}z.writeUintBE=Pr;function Gr(e,i,a,g){if(a===void 0&&(a=new Uint8Array(e/8)),g===void 0&&(g=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!hr.isSafeInteger(i))throw new Error("writeUintLE value must be an integer");for(var L=1,F=g;F<g+e/8;F++)a[F]=i/L&255,L*=256;return a}z.writeUintLE=Gr;function Ir(e,i){i===void 0&&(i=0);var a=new DataView(e.buffer,e.byteOffset,e.byteLength);return a.getFloat32(i)}z.readFloat32BE=Ir;function Kr(e,i){i===void 0&&(i=0);var a=new DataView(e.buffer,e.byteOffset,e.byteLength);return a.getFloat32(i,!0)}z.readFloat32LE=Kr;function Rr(e,i){i===void 0&&(i=0);var a=new DataView(e.buffer,e.byteOffset,e.byteLength);return a.getFloat64(i)}z.readFloat64BE=Rr;function jr(e,i){i===void 0&&(i=0);var a=new DataView(e.buffer,e.byteOffset,e.byteLength);return a.getFloat64(i,!0)}z.readFloat64LE=jr;function Or(e,i,a){i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0);var g=new DataView(i.buffer,i.byteOffset,i.byteLength);return g.setFloat32(a,e),i}z.writeFloat32BE=Or;function Fr(e,i,a){i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0);var g=new DataView(i.buffer,i.byteOffset,i.byteLength);return g.setFloat32(a,e,!0),i}z.writeFloat32LE=Fr;function pr(e,i,a){i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0);var g=new DataView(i.buffer,i.byteOffset,i.byteLength);return g.setFloat64(a,e),i}z.writeFloat64BE=pr;function Xr(e,i,a){i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0);var g=new DataView(i.buffer,i.byteOffset,i.byteLength);return g.setFloat64(a,e,!0),i}z.writeFloat64LE=Xr;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});function Dr(e){for(var i=0;i<e.length;i++)e[i]=0;return e}Kt.wipe=Dr;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var i=z,a=Kt;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var g=function(){function o(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){a.wipe(this._buffer),a.wipe(this._temp),this.reset()},o.prototype.update=function(s,b){if(b===void 0&&(b=s.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this._bytesHashed+=b,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&b>0;)this._buffer[this._bufferLength++]=s[w++],b--;this._bufferLength===this.blockSize&&(F(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(b>=this.blockSize&&(w=F(this._temp,this._state,s,w,b),b%=this.blockSize);b>0;)this._buffer[this._bufferLength++]=s[w++],b--;return this},o.prototype.finish=function(s){if(!this._finished){var b=this._bytesHashed,w=this._bufferLength,C=b/536870912|0,B=b<<3,d=b%64<56?64:128;this._buffer[w]=128;for(var m=w+1;m<d-8;m++)this._buffer[m]=0;i.writeUint32BE(C,this._buffer,d-8),i.writeUint32BE(B,this._buffer,d-4),F(this._temp,this._state,this._buffer,0,d),this._finished=!0}for(var m=0;m<this.digestLength/4;m++)i.writeUint32BE(this._state[m],s,m*4);return this},o.prototype.digest=function(){var s=new Uint8Array(this.digestLength);return this.finish(s),s},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(s){return this._state.set(s.state),this._bufferLength=s.bufferLength,s.buffer&&this._buffer.set(s.buffer),this._bytesHashed=s.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(s){a.wipe(s.state),s.buffer&&a.wipe(s.buffer),s.bufferLength=0,s.bytesHashed=0},o}();e.SHA256=g;var L=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function F(o,s,b,w,C){for(;C>=64;){for(var B=s[0],d=s[1],m=s[2],D=s[3],K=s[4],q=s[5],$=s[6],p=s[7],E=0;E<16;E++){var y=w+E*4;o[E]=i.readUint32BE(b,y)}for(var E=16;E<64;E++){var _=o[E-2],r=(_>>>17|_<<32-17)^(_>>>19|_<<32-19)^_>>>10;_=o[E-15];var f=(_>>>7|_<<32-7)^(_>>>18|_<<32-18)^_>>>3;o[E]=(r+o[E-7]|0)+(f+o[E-16]|0)}for(var E=0;E<64;E++){var r=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&q^~K&$)|0)+(p+(L[E]+o[E]|0)|0)|0,f=((B>>>2|B<<32-2)^(B>>>13|B<<32-13)^(B>>>22|B<<32-22))+(B&d^B&m^d&m)|0;p=$,$=q,q=K,K=D+r|0,D=m,m=d,d=B,B=r+f|0}s[0]+=B,s[1]+=d,s[2]+=m,s[3]+=D,s[4]+=K,s[5]+=q,s[6]+=$,s[7]+=p,w+=64,C-=64}return w}function X(o){var s=new g;s.update(o);var b=s.digest();return s.clean(),b}e.hash=X})(Lr);var ir={},Vt={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.BrowserRandomSource=void 0;const nr=65536;class Yr{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const i=typeof self<"u"?self.crypto||self.msCrypto:null;i&&i.getRandomValues!==void 0&&(this._crypto=i,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(i){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const a=new Uint8Array(i);for(let g=0;g<a.length;g+=nr)this._crypto.getRandomValues(a.subarray(g,g+Math.min(a.length-g,nr)));return a}}Zt.BrowserRandomSource=Yr;var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.NodeRandomSource=void 0;const zr=Kt;class qr{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof gr<"u"){const i=yr;i&&i.randomBytes&&(this._crypto=i,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(i){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let a=this._crypto.randomBytes(i);if(a.length!==i)throw new Error("NodeRandomSource: got fewer bytes than requested");const g=new Uint8Array(i);for(let L=0;L<g.length;L++)g[L]=a[L];return(0,zr.wipe)(a),g}}Qt.NodeRandomSource=qr;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.SystemRandomSource=void 0;const $r=Zt,Vr=Qt;class Zr{constructor(){if(this.isAvailable=!1,this.name="",this._source=new $r.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Vr.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(i){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(i)}}Vt.SystemRandomSource=Zr;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const i=Vt,a=z,g=Kt;e.defaultRandomSource=new i.SystemRandomSource;function L(b,w=e.defaultRandomSource){return w.randomBytes(b)}e.randomBytes=L;function F(b=e.defaultRandomSource){const w=L(4,b),C=(0,a.readUint32LE)(w);return(0,g.wipe)(w),C}e.randomUint32=F;const X="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o(b,w=X,C=e.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let B="";const d=w.length,m=256-256%d;for(;b>0;){const D=L(Math.ceil(b*256/m),C);for(let K=0;K<D.length&&b>0;K++){const q=D[K];q<m&&(B+=w.charAt(q%d),b--)}(0,g.wipe)(D)}return B}e.randomString=o;function s(b,w=X,C=e.defaultRandomSource){const B=Math.ceil(b/(Math.log(w.length)/Math.LN2));return o(B,w,C)}e.randomStringForEntropy=s})(ir);var Qr={},lr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var i=z,a=Kt;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var g=function(){function o(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){a.wipe(this._buffer),a.wipe(this._tempHi),a.wipe(this._tempLo),this.reset()},o.prototype.update=function(s,b){if(b===void 0&&(b=s.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=b,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&b>0;)this._buffer[this._bufferLength++]=s[w++],b--;this._bufferLength===this.blockSize&&(F(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(b>=this.blockSize&&(w=F(this._tempHi,this._tempLo,this._stateHi,this._stateLo,s,w,b),b%=this.blockSize);b>0;)this._buffer[this._bufferLength++]=s[w++],b--;return this},o.prototype.finish=function(s){if(!this._finished){var b=this._bytesHashed,w=this._bufferLength,C=b/536870912|0,B=b<<3,d=b%128<112?128:256;this._buffer[w]=128;for(var m=w+1;m<d-8;m++)this._buffer[m]=0;i.writeUint32BE(C,this._buffer,d-8),i.writeUint32BE(B,this._buffer,d-4),F(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,d),this._finished=!0}for(var m=0;m<this.digestLength/8;m++)i.writeUint32BE(this._stateHi[m],s,m*8),i.writeUint32BE(this._stateLo[m],s,m*8+4);return this},o.prototype.digest=function(){var s=new Uint8Array(this.digestLength);return this.finish(s),s},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(s){return this._stateHi.set(s.stateHi),this._stateLo.set(s.stateLo),this._bufferLength=s.bufferLength,s.buffer&&this._buffer.set(s.buffer),this._bytesHashed=s.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(s){a.wipe(s.stateHi),a.wipe(s.stateLo),s.buffer&&a.wipe(s.buffer),s.bufferLength=0,s.bytesHashed=0},o}();e.SHA512=g;var L=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function F(o,s,b,w,C,B,d){for(var m=b[0],D=b[1],K=b[2],q=b[3],$=b[4],p=b[5],E=b[6],y=b[7],_=w[0],r=w[1],f=w[2],M=w[3],A=w[4],I=w[5],j=w[6],O=w[7],x,c,T,U,v,S,H,N;d>=128;){for(var V=0;V<16;V++){var P=8*V+B;o[V]=i.readUint32BE(C,P),s[V]=i.readUint32BE(C,P+4)}for(var V=0;V<80;V++){var Y=m,J=D,tt=K,u=q,l=$,h=p,t=E,n=y,G=_,R=r,it=f,st=M,ft=A,lt=I,Et=j,wt=O;if(x=y,c=O,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=($>>>14|A<<32-14)^($>>>18|A<<32-18)^(A>>>41-32|$<<32-(41-32)),c=(A>>>14|$<<32-14)^(A>>>18|$<<32-18)^($>>>41-32|A<<32-(41-32)),v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,x=$&p^~$&E,c=A&I^~A&j,v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,x=L[V*2],c=L[V*2+1],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,x=o[V%16],c=s[V%16],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,T=H&65535|N<<16,U=v&65535|S<<16,x=T,c=U,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=(m>>>28|_<<32-28)^(_>>>34-32|m<<32-(34-32))^(_>>>39-32|m<<32-(39-32)),c=(_>>>28|m<<32-28)^(m>>>34-32|_<<32-(34-32))^(m>>>39-32|_<<32-(39-32)),v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,x=m&D^m&K^D&K,c=_&r^_&f^r&f,v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,n=H&65535|N<<16,wt=v&65535|S<<16,x=u,c=st,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=T,c=U,v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,u=H&65535|N<<16,st=v&65535|S<<16,D=Y,K=J,q=tt,$=u,p=l,E=h,y=t,m=n,r=G,f=R,M=it,A=st,I=ft,j=lt,O=Et,_=wt,V%16===15)for(var P=0;P<16;P++)x=o[P],c=s[P],v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=o[(P+9)%16],c=s[(P+9)%16],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,T=o[(P+1)%16],U=s[(P+1)%16],x=(T>>>1|U<<32-1)^(T>>>8|U<<32-8)^T>>>7,c=(U>>>1|T<<32-1)^(U>>>8|T<<32-8)^(U>>>7|T<<32-7),v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,T=o[(P+14)%16],U=s[(P+14)%16],x=(T>>>19|U<<32-19)^(U>>>61-32|T<<32-(61-32))^T>>>6,c=(U>>>19|T<<32-19)^(T>>>61-32|U<<32-(61-32))^(U>>>6|T<<32-6),v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,o[P]=H&65535|N<<16,s[P]=v&65535|S<<16}x=m,c=_,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[0],c=w[0],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[0]=m=H&65535|N<<16,w[0]=_=v&65535|S<<16,x=D,c=r,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[1],c=w[1],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[1]=D=H&65535|N<<16,w[1]=r=v&65535|S<<16,x=K,c=f,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[2],c=w[2],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[2]=K=H&65535|N<<16,w[2]=f=v&65535|S<<16,x=q,c=M,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[3],c=w[3],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[3]=q=H&65535|N<<16,w[3]=M=v&65535|S<<16,x=$,c=A,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[4],c=w[4],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[4]=$=H&65535|N<<16,w[4]=A=v&65535|S<<16,x=p,c=I,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[5],c=w[5],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[5]=p=H&65535|N<<16,w[5]=I=v&65535|S<<16,x=E,c=j,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[6],c=w[6],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[6]=E=H&65535|N<<16,w[6]=j=v&65535|S<<16,x=y,c=O,v=c&65535,S=c>>>16,H=x&65535,N=x>>>16,x=b[7],c=w[7],v+=c&65535,S+=c>>>16,H+=x&65535,N+=x>>>16,S+=v>>>16,H+=S>>>16,N+=H>>>16,b[7]=y=H&65535|N<<16,w[7]=O=v&65535|S<<16,B+=128,d-=128}return B}function X(o){var s=new g;s.update(o);var b=s.digest();return s.clean(),b}e.hash=X})(lr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const i=ir,a=lr,g=Kt;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function L(u){const l=new Float64Array(16);if(u)for(let h=0;h<u.length;h++)l[h]=u[h];return l}const F=new Uint8Array(32);F[0]=9;const X=L(),o=L([1]),s=L([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),b=L([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=L([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),C=L([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),B=L([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(u,l){for(let h=0;h<16;h++)u[h]=l[h]|0}function m(u){let l=1;for(let h=0;h<16;h++){let t=u[h]+l+65535;l=Math.floor(t/65536),u[h]=t-l*65536}u[0]+=l-1+37*(l-1)}function D(u,l,h){const t=~(h-1);for(let n=0;n<16;n++){const G=t&(u[n]^l[n]);u[n]^=G,l[n]^=G}}function K(u,l){const h=L(),t=L();for(let n=0;n<16;n++)t[n]=l[n];m(t),m(t),m(t);for(let n=0;n<2;n++){h[0]=t[0]-65517;for(let R=1;R<15;R++)h[R]=t[R]-65535-(h[R-1]>>16&1),h[R-1]&=65535;h[15]=t[15]-32767-(h[14]>>16&1);const G=h[15]>>16&1;h[14]&=65535,D(t,h,1-G)}for(let n=0;n<16;n++)u[2*n]=t[n]&255,u[2*n+1]=t[n]>>8}function q(u,l){let h=0;for(let t=0;t<32;t++)h|=u[t]^l[t];return(1&h-1>>>8)-1}function $(u,l){const h=new Uint8Array(32),t=new Uint8Array(32);return K(h,u),K(t,l),q(h,t)}function p(u){const l=new Uint8Array(32);return K(l,u),l[0]&1}function E(u,l){for(let h=0;h<16;h++)u[h]=l[2*h]+(l[2*h+1]<<8);u[15]&=32767}function y(u,l,h){for(let t=0;t<16;t++)u[t]=l[t]+h[t]}function _(u,l,h){for(let t=0;t<16;t++)u[t]=l[t]-h[t]}function r(u,l,h){let t,n,G=0,R=0,it=0,st=0,ft=0,lt=0,Et=0,wt=0,ht=0,nt=0,et=0,rt=0,k=0,W=0,Z=0,Q=0,at=0,ot=0,ct=0,ut=0,xt=0,_t=0,bt=0,vt=0,Rt=0,Ot=0,pt=0,Xt=0,zt=0,Jt=0,fr=0,dt=h[0],yt=h[1],gt=h[2],Lt=h[3],Ut=h[4],At=h[5],St=h[6],Mt=h[7],Ht=h[8],Bt=h[9],Tt=h[10],mt=h[11],Nt=h[12],Ct=h[13],Pt=h[14],Gt=h[15];t=l[0],G+=t*dt,R+=t*yt,it+=t*gt,st+=t*Lt,ft+=t*Ut,lt+=t*At,Et+=t*St,wt+=t*Mt,ht+=t*Ht,nt+=t*Bt,et+=t*Tt,rt+=t*mt,k+=t*Nt,W+=t*Ct,Z+=t*Pt,Q+=t*Gt,t=l[1],R+=t*dt,it+=t*yt,st+=t*gt,ft+=t*Lt,lt+=t*Ut,Et+=t*At,wt+=t*St,ht+=t*Mt,nt+=t*Ht,et+=t*Bt,rt+=t*Tt,k+=t*mt,W+=t*Nt,Z+=t*Ct,Q+=t*Pt,at+=t*Gt,t=l[2],it+=t*dt,st+=t*yt,ft+=t*gt,lt+=t*Lt,Et+=t*Ut,wt+=t*At,ht+=t*St,nt+=t*Mt,et+=t*Ht,rt+=t*Bt,k+=t*Tt,W+=t*mt,Z+=t*Nt,Q+=t*Ct,at+=t*Pt,ot+=t*Gt,t=l[3],st+=t*dt,ft+=t*yt,lt+=t*gt,Et+=t*Lt,wt+=t*Ut,ht+=t*At,nt+=t*St,et+=t*Mt,rt+=t*Ht,k+=t*Bt,W+=t*Tt,Z+=t*mt,Q+=t*Nt,at+=t*Ct,ot+=t*Pt,ct+=t*Gt,t=l[4],ft+=t*dt,lt+=t*yt,Et+=t*gt,wt+=t*Lt,ht+=t*Ut,nt+=t*At,et+=t*St,rt+=t*Mt,k+=t*Ht,W+=t*Bt,Z+=t*Tt,Q+=t*mt,at+=t*Nt,ot+=t*Ct,ct+=t*Pt,ut+=t*Gt,t=l[5],lt+=t*dt,Et+=t*yt,wt+=t*gt,ht+=t*Lt,nt+=t*Ut,et+=t*At,rt+=t*St,k+=t*Mt,W+=t*Ht,Z+=t*Bt,Q+=t*Tt,at+=t*mt,ot+=t*Nt,ct+=t*Ct,ut+=t*Pt,xt+=t*Gt,t=l[6],Et+=t*dt,wt+=t*yt,ht+=t*gt,nt+=t*Lt,et+=t*Ut,rt+=t*At,k+=t*St,W+=t*Mt,Z+=t*Ht,Q+=t*Bt,at+=t*Tt,ot+=t*mt,ct+=t*Nt,ut+=t*Ct,xt+=t*Pt,_t+=t*Gt,t=l[7],wt+=t*dt,ht+=t*yt,nt+=t*gt,et+=t*Lt,rt+=t*Ut,k+=t*At,W+=t*St,Z+=t*Mt,Q+=t*Ht,at+=t*Bt,ot+=t*Tt,ct+=t*mt,ut+=t*Nt,xt+=t*Ct,_t+=t*Pt,bt+=t*Gt,t=l[8],ht+=t*dt,nt+=t*yt,et+=t*gt,rt+=t*Lt,k+=t*Ut,W+=t*At,Z+=t*St,Q+=t*Mt,at+=t*Ht,ot+=t*Bt,ct+=t*Tt,ut+=t*mt,xt+=t*Nt,_t+=t*Ct,bt+=t*Pt,vt+=t*Gt,t=l[9],nt+=t*dt,et+=t*yt,rt+=t*gt,k+=t*Lt,W+=t*Ut,Z+=t*At,Q+=t*St,at+=t*Mt,ot+=t*Ht,ct+=t*Bt,ut+=t*Tt,xt+=t*mt,_t+=t*Nt,bt+=t*Ct,vt+=t*Pt,Rt+=t*Gt,t=l[10],et+=t*dt,rt+=t*yt,k+=t*gt,W+=t*Lt,Z+=t*Ut,Q+=t*At,at+=t*St,ot+=t*Mt,ct+=t*Ht,ut+=t*Bt,xt+=t*Tt,_t+=t*mt,bt+=t*Nt,vt+=t*Ct,Rt+=t*Pt,Ot+=t*Gt,t=l[11],rt+=t*dt,k+=t*yt,W+=t*gt,Z+=t*Lt,Q+=t*Ut,at+=t*At,ot+=t*St,ct+=t*Mt,ut+=t*Ht,xt+=t*Bt,_t+=t*Tt,bt+=t*mt,vt+=t*Nt,Rt+=t*Ct,Ot+=t*Pt,pt+=t*Gt,t=l[12],k+=t*dt,W+=t*yt,Z+=t*gt,Q+=t*Lt,at+=t*Ut,ot+=t*At,ct+=t*St,ut+=t*Mt,xt+=t*Ht,_t+=t*Bt,bt+=t*Tt,vt+=t*mt,Rt+=t*Nt,Ot+=t*Ct,pt+=t*Pt,Xt+=t*Gt,t=l[13],W+=t*dt,Z+=t*yt,Q+=t*gt,at+=t*Lt,ot+=t*Ut,ct+=t*At,ut+=t*St,xt+=t*Mt,_t+=t*Ht,bt+=t*Bt,vt+=t*Tt,Rt+=t*mt,Ot+=t*Nt,pt+=t*Ct,Xt+=t*Pt,zt+=t*Gt,t=l[14],Z+=t*dt,Q+=t*yt,at+=t*gt,ot+=t*Lt,ct+=t*Ut,ut+=t*At,xt+=t*St,_t+=t*Mt,bt+=t*Ht,vt+=t*Bt,Rt+=t*Tt,Ot+=t*mt,pt+=t*Nt,Xt+=t*Ct,zt+=t*Pt,Jt+=t*Gt,t=l[15],Q+=t*dt,at+=t*yt,ot+=t*gt,ct+=t*Lt,ut+=t*Ut,xt+=t*At,_t+=t*St,bt+=t*Mt,vt+=t*Ht,Rt+=t*Bt,Ot+=t*Tt,pt+=t*mt,Xt+=t*Nt,zt+=t*Ct,Jt+=t*Pt,fr+=t*Gt,G+=38*at,R+=38*ot,it+=38*ct,st+=38*ut,ft+=38*xt,lt+=38*_t,Et+=38*bt,wt+=38*vt,ht+=38*Rt,nt+=38*Ot,et+=38*pt,rt+=38*Xt,k+=38*zt,W+=38*Jt,Z+=38*fr,n=1,t=G+n+65535,n=Math.floor(t/65536),G=t-n*65536,t=R+n+65535,n=Math.floor(t/65536),R=t-n*65536,t=it+n+65535,n=Math.floor(t/65536),it=t-n*65536,t=st+n+65535,n=Math.floor(t/65536),st=t-n*65536,t=ft+n+65535,n=Math.floor(t/65536),ft=t-n*65536,t=lt+n+65535,n=Math.floor(t/65536),lt=t-n*65536,t=Et+n+65535,n=Math.floor(t/65536),Et=t-n*65536,t=wt+n+65535,n=Math.floor(t/65536),wt=t-n*65536,t=ht+n+65535,n=Math.floor(t/65536),ht=t-n*65536,t=nt+n+65535,n=Math.floor(t/65536),nt=t-n*65536,t=et+n+65535,n=Math.floor(t/65536),et=t-n*65536,t=rt+n+65535,n=Math.floor(t/65536),rt=t-n*65536,t=k+n+65535,n=Math.floor(t/65536),k=t-n*65536,t=W+n+65535,n=Math.floor(t/65536),W=t-n*65536,t=Z+n+65535,n=Math.floor(t/65536),Z=t-n*65536,t=Q+n+65535,n=Math.floor(t/65536),Q=t-n*65536,G+=n-1+37*(n-1),n=1,t=G+n+65535,n=Math.floor(t/65536),G=t-n*65536,t=R+n+65535,n=Math.floor(t/65536),R=t-n*65536,t=it+n+65535,n=Math.floor(t/65536),it=t-n*65536,t=st+n+65535,n=Math.floor(t/65536),st=t-n*65536,t=ft+n+65535,n=Math.floor(t/65536),ft=t-n*65536,t=lt+n+65535,n=Math.floor(t/65536),lt=t-n*65536,t=Et+n+65535,n=Math.floor(t/65536),Et=t-n*65536,t=wt+n+65535,n=Math.floor(t/65536),wt=t-n*65536,t=ht+n+65535,n=Math.floor(t/65536),ht=t-n*65536,t=nt+n+65535,n=Math.floor(t/65536),nt=t-n*65536,t=et+n+65535,n=Math.floor(t/65536),et=t-n*65536,t=rt+n+65535,n=Math.floor(t/65536),rt=t-n*65536,t=k+n+65535,n=Math.floor(t/65536),k=t-n*65536,t=W+n+65535,n=Math.floor(t/65536),W=t-n*65536,t=Z+n+65535,n=Math.floor(t/65536),Z=t-n*65536,t=Q+n+65535,n=Math.floor(t/65536),Q=t-n*65536,G+=n-1+37*(n-1),u[0]=G,u[1]=R,u[2]=it,u[3]=st,u[4]=ft,u[5]=lt,u[6]=Et,u[7]=wt,u[8]=ht,u[9]=nt,u[10]=et,u[11]=rt,u[12]=k,u[13]=W,u[14]=Z,u[15]=Q}function f(u,l){r(u,l,l)}function M(u,l){const h=L();let t;for(t=0;t<16;t++)h[t]=l[t];for(t=253;t>=0;t--)f(h,h),t!==2&&t!==4&&r(h,h,l);for(t=0;t<16;t++)u[t]=h[t]}function A(u,l){const h=L();let t;for(t=0;t<16;t++)h[t]=l[t];for(t=250;t>=0;t--)f(h,h),t!==1&&r(h,h,l);for(t=0;t<16;t++)u[t]=h[t]}function I(u,l){const h=L(),t=L(),n=L(),G=L(),R=L(),it=L(),st=L(),ft=L(),lt=L();_(h,u[1],u[0]),_(lt,l[1],l[0]),r(h,h,lt),y(t,u[0],u[1]),y(lt,l[0],l[1]),r(t,t,lt),r(n,u[3],l[3]),r(n,n,b),r(G,u[2],l[2]),y(G,G,G),_(R,t,h),_(it,G,n),y(st,G,n),y(ft,t,h),r(u[0],R,it),r(u[1],ft,st),r(u[2],st,it),r(u[3],R,ft)}function j(u,l,h){for(let t=0;t<4;t++)D(u[t],l[t],h)}function O(u,l){const h=L(),t=L(),n=L();M(n,l[2]),r(h,l[0],n),r(t,l[1],n),K(u,t),u[31]^=p(h)<<7}function x(u,l,h){d(u[0],X),d(u[1],o),d(u[2],o),d(u[3],X);for(let t=255;t>=0;--t){const n=h[t/8|0]>>(t&7)&1;j(u,l,n),I(l,u),I(u,u),j(u,l,n)}}function c(u,l){const h=[L(),L(),L(),L()];d(h[0],w),d(h[1],C),d(h[2],o),r(h[3],w,C),x(u,h,l)}function T(u){if(u.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const l=(0,a.hash)(u);l[0]&=248,l[31]&=127,l[31]|=64;const h=new Uint8Array(32),t=[L(),L(),L(),L()];c(t,l),O(h,t);const n=new Uint8Array(64);return n.set(u),n.set(h,32),{publicKey:h,secretKey:n}}e.generateKeyPairFromSeed=T;function U(u){const l=(0,i.randomBytes)(32,u),h=T(l);return(0,g.wipe)(l),h}e.generateKeyPair=U;function v(u){if(u.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(u.subarray(32))}e.extractPublicKeyFromSecretKey=v;const S=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function H(u,l){let h,t,n,G;for(t=63;t>=32;--t){for(h=0,n=t-32,G=t-12;n<G;++n)l[n]+=h-16*l[t]*S[n-(t-32)],h=Math.floor((l[n]+128)/256),l[n]-=h*256;l[n]+=h,l[t]=0}for(h=0,n=0;n<32;n++)l[n]+=h-(l[31]>>4)*S[n],h=l[n]>>8,l[n]&=255;for(n=0;n<32;n++)l[n]-=h*S[n];for(t=0;t<32;t++)l[t+1]+=l[t]>>8,u[t]=l[t]&255}function N(u){const l=new Float64Array(64);for(let h=0;h<64;h++)l[h]=u[h];for(let h=0;h<64;h++)u[h]=0;H(u,l)}function V(u,l){const h=new Float64Array(64),t=[L(),L(),L(),L()],n=(0,a.hash)(u.subarray(0,32));n[0]&=248,n[31]&=127,n[31]|=64;const G=new Uint8Array(64);G.set(n.subarray(32),32);const R=new a.SHA512;R.update(G.subarray(32)),R.update(l);const it=R.digest();R.clean(),N(it),c(t,it),O(G,t),R.reset(),R.update(G.subarray(0,32)),R.update(u.subarray(32)),R.update(l);const st=R.digest();N(st);for(let ft=0;ft<32;ft++)h[ft]=it[ft];for(let ft=0;ft<32;ft++)for(let lt=0;lt<32;lt++)h[ft+lt]+=st[ft]*n[lt];return H(G.subarray(32),h),G}e.sign=V;function P(u,l){const h=L(),t=L(),n=L(),G=L(),R=L(),it=L(),st=L();return d(u[2],o),E(u[1],l),f(n,u[1]),r(G,n,s),_(n,n,u[2]),y(G,u[2],G),f(R,G),f(it,R),r(st,it,R),r(h,st,n),r(h,h,G),A(h,h),r(h,h,n),r(h,h,G),r(h,h,G),r(u[0],h,G),f(t,u[0]),r(t,t,G),$(t,n)&&r(u[0],u[0],B),f(t,u[0]),r(t,t,G),$(t,n)?-1:(p(u[0])===l[31]>>7&&_(u[0],X,u[0]),r(u[3],u[0],u[1]),0)}function Y(u,l,h){const t=new Uint8Array(32),n=[L(),L(),L(),L()],G=[L(),L(),L(),L()];if(h.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(P(G,u))return!1;const R=new a.SHA512;R.update(h.subarray(0,32)),R.update(u),R.update(l);const it=R.digest();return N(it),x(n,G,it),c(G,h.subarray(32)),I(n,G),O(t,n),!q(h,t)}e.verify=Y;function J(u){let l=[L(),L(),L(),L()];if(P(l,u))throw new Error("Ed25519: invalid public key");let h=L(),t=L(),n=l[1];y(h,o,n),_(t,o,n),M(t,t),r(h,h,t);let G=new Uint8Array(32);return K(G,h),G}e.convertPublicKeyToX25519=J;function tt(u){const l=(0,a.hash)(u.subarray(0,32));l[0]&=248,l[31]&=127,l[31]|=64;const h=new Uint8Array(l.subarray(0,32));return(0,g.wipe)(l),h}e.convertSecretKeyToX25519=tt})(Qr);var Jr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const i=ir,a=Kt;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function g(E){const y=new Float64Array(16);if(E)for(let _=0;_<E.length;_++)y[_]=E[_];return y}const L=new Uint8Array(32);L[0]=9;const F=g([56129,1]);function X(E){let y=1;for(let _=0;_<16;_++){let r=E[_]+y+65535;y=Math.floor(r/65536),E[_]=r-y*65536}E[0]+=y-1+37*(y-1)}function o(E,y,_){const r=~(_-1);for(let f=0;f<16;f++){const M=r&(E[f]^y[f]);E[f]^=M,y[f]^=M}}function s(E,y){const _=g(),r=g();for(let f=0;f<16;f++)r[f]=y[f];X(r),X(r),X(r);for(let f=0;f<2;f++){_[0]=r[0]-65517;for(let A=1;A<15;A++)_[A]=r[A]-65535-(_[A-1]>>16&1),_[A-1]&=65535;_[15]=r[15]-32767-(_[14]>>16&1);const M=_[15]>>16&1;_[14]&=65535,o(r,_,1-M)}for(let f=0;f<16;f++)E[2*f]=r[f]&255,E[2*f+1]=r[f]>>8}function b(E,y){for(let _=0;_<16;_++)E[_]=y[2*_]+(y[2*_+1]<<8);E[15]&=32767}function w(E,y,_){for(let r=0;r<16;r++)E[r]=y[r]+_[r]}function C(E,y,_){for(let r=0;r<16;r++)E[r]=y[r]-_[r]}function B(E,y,_){let r,f,M=0,A=0,I=0,j=0,O=0,x=0,c=0,T=0,U=0,v=0,S=0,H=0,N=0,V=0,P=0,Y=0,J=0,tt=0,u=0,l=0,h=0,t=0,n=0,G=0,R=0,it=0,st=0,ft=0,lt=0,Et=0,wt=0,ht=_[0],nt=_[1],et=_[2],rt=_[3],k=_[4],W=_[5],Z=_[6],Q=_[7],at=_[8],ot=_[9],ct=_[10],ut=_[11],xt=_[12],_t=_[13],bt=_[14],vt=_[15];r=y[0],M+=r*ht,A+=r*nt,I+=r*et,j+=r*rt,O+=r*k,x+=r*W,c+=r*Z,T+=r*Q,U+=r*at,v+=r*ot,S+=r*ct,H+=r*ut,N+=r*xt,V+=r*_t,P+=r*bt,Y+=r*vt,r=y[1],A+=r*ht,I+=r*nt,j+=r*et,O+=r*rt,x+=r*k,c+=r*W,T+=r*Z,U+=r*Q,v+=r*at,S+=r*ot,H+=r*ct,N+=r*ut,V+=r*xt,P+=r*_t,Y+=r*bt,J+=r*vt,r=y[2],I+=r*ht,j+=r*nt,O+=r*et,x+=r*rt,c+=r*k,T+=r*W,U+=r*Z,v+=r*Q,S+=r*at,H+=r*ot,N+=r*ct,V+=r*ut,P+=r*xt,Y+=r*_t,J+=r*bt,tt+=r*vt,r=y[3],j+=r*ht,O+=r*nt,x+=r*et,c+=r*rt,T+=r*k,U+=r*W,v+=r*Z,S+=r*Q,H+=r*at,N+=r*ot,V+=r*ct,P+=r*ut,Y+=r*xt,J+=r*_t,tt+=r*bt,u+=r*vt,r=y[4],O+=r*ht,x+=r*nt,c+=r*et,T+=r*rt,U+=r*k,v+=r*W,S+=r*Z,H+=r*Q,N+=r*at,V+=r*ot,P+=r*ct,Y+=r*ut,J+=r*xt,tt+=r*_t,u+=r*bt,l+=r*vt,r=y[5],x+=r*ht,c+=r*nt,T+=r*et,U+=r*rt,v+=r*k,S+=r*W,H+=r*Z,N+=r*Q,V+=r*at,P+=r*ot,Y+=r*ct,J+=r*ut,tt+=r*xt,u+=r*_t,l+=r*bt,h+=r*vt,r=y[6],c+=r*ht,T+=r*nt,U+=r*et,v+=r*rt,S+=r*k,H+=r*W,N+=r*Z,V+=r*Q,P+=r*at,Y+=r*ot,J+=r*ct,tt+=r*ut,u+=r*xt,l+=r*_t,h+=r*bt,t+=r*vt,r=y[7],T+=r*ht,U+=r*nt,v+=r*et,S+=r*rt,H+=r*k,N+=r*W,V+=r*Z,P+=r*Q,Y+=r*at,J+=r*ot,tt+=r*ct,u+=r*ut,l+=r*xt,h+=r*_t,t+=r*bt,n+=r*vt,r=y[8],U+=r*ht,v+=r*nt,S+=r*et,H+=r*rt,N+=r*k,V+=r*W,P+=r*Z,Y+=r*Q,J+=r*at,tt+=r*ot,u+=r*ct,l+=r*ut,h+=r*xt,t+=r*_t,n+=r*bt,G+=r*vt,r=y[9],v+=r*ht,S+=r*nt,H+=r*et,N+=r*rt,V+=r*k,P+=r*W,Y+=r*Z,J+=r*Q,tt+=r*at,u+=r*ot,l+=r*ct,h+=r*ut,t+=r*xt,n+=r*_t,G+=r*bt,R+=r*vt,r=y[10],S+=r*ht,H+=r*nt,N+=r*et,V+=r*rt,P+=r*k,Y+=r*W,J+=r*Z,tt+=r*Q,u+=r*at,l+=r*ot,h+=r*ct,t+=r*ut,n+=r*xt,G+=r*_t,R+=r*bt,it+=r*vt,r=y[11],H+=r*ht,N+=r*nt,V+=r*et,P+=r*rt,Y+=r*k,J+=r*W,tt+=r*Z,u+=r*Q,l+=r*at,h+=r*ot,t+=r*ct,n+=r*ut,G+=r*xt,R+=r*_t,it+=r*bt,st+=r*vt,r=y[12],N+=r*ht,V+=r*nt,P+=r*et,Y+=r*rt,J+=r*k,tt+=r*W,u+=r*Z,l+=r*Q,h+=r*at,t+=r*ot,n+=r*ct,G+=r*ut,R+=r*xt,it+=r*_t,st+=r*bt,ft+=r*vt,r=y[13],V+=r*ht,P+=r*nt,Y+=r*et,J+=r*rt,tt+=r*k,u+=r*W,l+=r*Z,h+=r*Q,t+=r*at,n+=r*ot,G+=r*ct,R+=r*ut,it+=r*xt,st+=r*_t,ft+=r*bt,lt+=r*vt,r=y[14],P+=r*ht,Y+=r*nt,J+=r*et,tt+=r*rt,u+=r*k,l+=r*W,h+=r*Z,t+=r*Q,n+=r*at,G+=r*ot,R+=r*ct,it+=r*ut,st+=r*xt,ft+=r*_t,lt+=r*bt,Et+=r*vt,r=y[15],Y+=r*ht,J+=r*nt,tt+=r*et,u+=r*rt,l+=r*k,h+=r*W,t+=r*Z,n+=r*Q,G+=r*at,R+=r*ot,it+=r*ct,st+=r*ut,ft+=r*xt,lt+=r*_t,Et+=r*bt,wt+=r*vt,M+=38*J,A+=38*tt,I+=38*u,j+=38*l,O+=38*h,x+=38*t,c+=38*n,T+=38*G,U+=38*R,v+=38*it,S+=38*st,H+=38*ft,N+=38*lt,V+=38*Et,P+=38*wt,f=1,r=M+f+65535,f=Math.floor(r/65536),M=r-f*65536,r=A+f+65535,f=Math.floor(r/65536),A=r-f*65536,r=I+f+65535,f=Math.floor(r/65536),I=r-f*65536,r=j+f+65535,f=Math.floor(r/65536),j=r-f*65536,r=O+f+65535,f=Math.floor(r/65536),O=r-f*65536,r=x+f+65535,f=Math.floor(r/65536),x=r-f*65536,r=c+f+65535,f=Math.floor(r/65536),c=r-f*65536,r=T+f+65535,f=Math.floor(r/65536),T=r-f*65536,r=U+f+65535,f=Math.floor(r/65536),U=r-f*65536,r=v+f+65535,f=Math.floor(r/65536),v=r-f*65536,r=S+f+65535,f=Math.floor(r/65536),S=r-f*65536,r=H+f+65535,f=Math.floor(r/65536),H=r-f*65536,r=N+f+65535,f=Math.floor(r/65536),N=r-f*65536,r=V+f+65535,f=Math.floor(r/65536),V=r-f*65536,r=P+f+65535,f=Math.floor(r/65536),P=r-f*65536,r=Y+f+65535,f=Math.floor(r/65536),Y=r-f*65536,M+=f-1+37*(f-1),f=1,r=M+f+65535,f=Math.floor(r/65536),M=r-f*65536,r=A+f+65535,f=Math.floor(r/65536),A=r-f*65536,r=I+f+65535,f=Math.floor(r/65536),I=r-f*65536,r=j+f+65535,f=Math.floor(r/65536),j=r-f*65536,r=O+f+65535,f=Math.floor(r/65536),O=r-f*65536,r=x+f+65535,f=Math.floor(r/65536),x=r-f*65536,r=c+f+65535,f=Math.floor(r/65536),c=r-f*65536,r=T+f+65535,f=Math.floor(r/65536),T=r-f*65536,r=U+f+65535,f=Math.floor(r/65536),U=r-f*65536,r=v+f+65535,f=Math.floor(r/65536),v=r-f*65536,r=S+f+65535,f=Math.floor(r/65536),S=r-f*65536,r=H+f+65535,f=Math.floor(r/65536),H=r-f*65536,r=N+f+65535,f=Math.floor(r/65536),N=r-f*65536,r=V+f+65535,f=Math.floor(r/65536),V=r-f*65536,r=P+f+65535,f=Math.floor(r/65536),P=r-f*65536,r=Y+f+65535,f=Math.floor(r/65536),Y=r-f*65536,M+=f-1+37*(f-1),E[0]=M,E[1]=A,E[2]=I,E[3]=j,E[4]=O,E[5]=x,E[6]=c,E[7]=T,E[8]=U,E[9]=v,E[10]=S,E[11]=H,E[12]=N,E[13]=V,E[14]=P,E[15]=Y}function d(E,y){B(E,y,y)}function m(E,y){const _=g();for(let r=0;r<16;r++)_[r]=y[r];for(let r=253;r>=0;r--)d(_,_),r!==2&&r!==4&&B(_,_,y);for(let r=0;r<16;r++)E[r]=_[r]}function D(E,y){const _=new Uint8Array(32),r=new Float64Array(80),f=g(),M=g(),A=g(),I=g(),j=g(),O=g();for(let U=0;U<31;U++)_[U]=E[U];_[31]=E[31]&127|64,_[0]&=248,b(r,y);for(let U=0;U<16;U++)M[U]=r[U];f[0]=I[0]=1;for(let U=254;U>=0;--U){const v=_[U>>>3]>>>(U&7)&1;o(f,M,v),o(A,I,v),w(j,f,A),C(f,f,A),w(A,M,I),C(M,M,I),d(I,j),d(O,f),B(f,A,f),B(A,M,j),w(j,f,A),C(f,f,A),d(M,f),C(A,I,O),B(f,A,F),w(f,f,I),B(A,A,f),B(f,I,O),B(I,M,r),d(M,j),o(f,M,v),o(A,I,v)}for(let U=0;U<16;U++)r[U+16]=f[U],r[U+32]=A[U],r[U+48]=M[U],r[U+64]=I[U];const x=r.subarray(32),c=r.subarray(16);m(x,x),B(c,c,x);const T=new Uint8Array(32);return s(T,c),T}e.scalarMult=D;function K(E){return D(E,L)}e.scalarMultBase=K;function q(E){if(E.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const y=new Uint8Array(E);return{publicKey:K(y),secretKey:y}}e.generateKeyPairFromSeed=q;function $(E){const y=(0,i.randomBytes)(32,E),_=q(y);return(0,a.wipe)(y),_}e.generateKeyPair=$;function p(E,y,_=!1){if(E.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(y.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const r=D(E,y);if(_){let f=0;for(let M=0;M<r.length;M++)f|=r[M];if(f===0)throw new Error("X25519: invalid shared key")}return r}e.sharedKey=p})(Jr);var Wr={},Dt={},Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});var It=z,er=Kt,kr=20;function t0(e,i,a){for(var g=1634760805,L=857760878,F=2036477234,X=1797285236,o=a[3]<<24|a[2]<<16|a[1]<<8|a[0],s=a[7]<<24|a[6]<<16|a[5]<<8|a[4],b=a[11]<<24|a[10]<<16|a[9]<<8|a[8],w=a[15]<<24|a[14]<<16|a[13]<<8|a[12],C=a[19]<<24|a[18]<<16|a[17]<<8|a[16],B=a[23]<<24|a[22]<<16|a[21]<<8|a[20],d=a[27]<<24|a[26]<<16|a[25]<<8|a[24],m=a[31]<<24|a[30]<<16|a[29]<<8|a[28],D=i[3]<<24|i[2]<<16|i[1]<<8|i[0],K=i[7]<<24|i[6]<<16|i[5]<<8|i[4],q=i[11]<<24|i[10]<<16|i[9]<<8|i[8],$=i[15]<<24|i[14]<<16|i[13]<<8|i[12],p=g,E=L,y=F,_=X,r=o,f=s,M=b,A=w,I=C,j=B,O=d,x=m,c=D,T=K,U=q,v=$,S=0;S<kr;S+=2)p=p+r|0,c^=p,c=c>>>32-16|c<<16,I=I+c|0,r^=I,r=r>>>32-12|r<<12,E=E+f|0,T^=E,T=T>>>32-16|T<<16,j=j+T|0,f^=j,f=f>>>32-12|f<<12,y=y+M|0,U^=y,U=U>>>32-16|U<<16,O=O+U|0,M^=O,M=M>>>32-12|M<<12,_=_+A|0,v^=_,v=v>>>32-16|v<<16,x=x+v|0,A^=x,A=A>>>32-12|A<<12,y=y+M|0,U^=y,U=U>>>32-8|U<<8,O=O+U|0,M^=O,M=M>>>32-7|M<<7,_=_+A|0,v^=_,v=v>>>32-8|v<<8,x=x+v|0,A^=x,A=A>>>32-7|A<<7,E=E+f|0,T^=E,T=T>>>32-8|T<<8,j=j+T|0,f^=j,f=f>>>32-7|f<<7,p=p+r|0,c^=p,c=c>>>32-8|c<<8,I=I+c|0,r^=I,r=r>>>32-7|r<<7,p=p+f|0,v^=p,v=v>>>32-16|v<<16,O=O+v|0,f^=O,f=f>>>32-12|f<<12,E=E+M|0,c^=E,c=c>>>32-16|c<<16,x=x+c|0,M^=x,M=M>>>32-12|M<<12,y=y+A|0,T^=y,T=T>>>32-16|T<<16,I=I+T|0,A^=I,A=A>>>32-12|A<<12,_=_+r|0,U^=_,U=U>>>32-16|U<<16,j=j+U|0,r^=j,r=r>>>32-12|r<<12,y=y+A|0,T^=y,T=T>>>32-8|T<<8,I=I+T|0,A^=I,A=A>>>32-7|A<<7,_=_+r|0,U^=_,U=U>>>32-8|U<<8,j=j+U|0,r^=j,r=r>>>32-7|r<<7,E=E+M|0,c^=E,c=c>>>32-8|c<<8,x=x+c|0,M^=x,M=M>>>32-7|M<<7,p=p+f|0,v^=p,v=v>>>32-8|v<<8,O=O+v|0,f^=O,f=f>>>32-7|f<<7;It.writeUint32LE(p+g|0,e,0),It.writeUint32LE(E+L|0,e,4),It.writeUint32LE(y+F|0,e,8),It.writeUint32LE(_+X|0,e,12),It.writeUint32LE(r+o|0,e,16),It.writeUint32LE(f+s|0,e,20),It.writeUint32LE(M+b|0,e,24),It.writeUint32LE(A+w|0,e,28),It.writeUint32LE(I+C|0,e,32),It.writeUint32LE(j+B|0,e,36),It.writeUint32LE(O+d|0,e,40),It.writeUint32LE(x+m|0,e,44),It.writeUint32LE(c+D|0,e,48),It.writeUint32LE(T+K|0,e,52),It.writeUint32LE(U+q|0,e,56),It.writeUint32LE(v+$|0,e,60)}function xr(e,i,a,g,L){if(L===void 0&&(L=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(g.length<a.length)throw new Error("ChaCha: destination is shorter than source");var F,X;if(L===0){if(i.length!==8&&i.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");F=new Uint8Array(16),X=F.length-i.length,F.set(i,X)}else{if(i.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");F=i,X=L}for(var o=new Uint8Array(64),s=0;s<a.length;s+=64){t0(o,F,e);for(var b=s;b<s+64&&b<a.length;b++)g[b]=a[b]^o[b-s];e0(F,0,X)}return er.wipe(o),L===0&&er.wipe(F),g}Yt.streamXOR=xr;function r0(e,i,a,g){return g===void 0&&(g=0),er.wipe(a),xr(e,i,a,a,g)}Yt.stream=r0;function e0(e,i,a){for(var g=1;a--;)g=g+(e[i]&255)|0,e[i]=g&255,g>>>=8,i++;if(g>0)throw new Error("ChaCha: counter overflow")}Object.defineProperty(Dt,"__esModule",{value:!0});var jt=z,_r=Kt,i0=Yt,f0=20;function br(e,i,a,g){if(i.length!==24)throw new Error("XChaCha20 nonce must be 24 bytes");var L=vr(e,i.subarray(0,16),new Uint8Array(32)),F=new Uint8Array(12);F.set(i.subarray(16),4);var X=i0.streamXOR(L,F,a,g);return _r.wipe(L),X}Dt.streamXOR=br;function n0(e,i,a){return _r.wipe(a),br(e,i,a,a)}Dt.stream=n0;function vr(e,i,a){for(var g=1634760805,L=857760878,F=2036477234,X=1797285236,o=e[3]<<24|e[2]<<16|e[1]<<8|e[0],s=e[7]<<24|e[6]<<16|e[5]<<8|e[4],b=e[11]<<24|e[10]<<16|e[9]<<8|e[8],w=e[15]<<24|e[14]<<16|e[13]<<8|e[12],C=e[19]<<24|e[18]<<16|e[17]<<8|e[16],B=e[23]<<24|e[22]<<16|e[21]<<8|e[20],d=e[27]<<24|e[26]<<16|e[25]<<8|e[24],m=e[31]<<24|e[30]<<16|e[29]<<8|e[28],D=i[3]<<24|i[2]<<16|i[1]<<8|i[0],K=i[7]<<24|i[6]<<16|i[5]<<8|i[4],q=i[11]<<24|i[10]<<16|i[9]<<8|i[8],$=i[15]<<24|i[14]<<16|i[13]<<8|i[12],p=g,E=L,y=F,_=X,r=o,f=s,M=b,A=w,I=C,j=B,O=d,x=m,c=D,T=K,U=q,v=$,S=0;S<f0;S+=2)p=p+r|0,c^=p,c=c>>>32-16|c<<16,I=I+c|0,r^=I,r=r>>>32-12|r<<12,E=E+f|0,T^=E,T=T>>>32-16|T<<16,j=j+T|0,f^=j,f=f>>>32-12|f<<12,y=y+M|0,U^=y,U=U>>>32-16|U<<16,O=O+U|0,M^=O,M=M>>>32-12|M<<12,_=_+A|0,v^=_,v=v>>>32-16|v<<16,x=x+v|0,A^=x,A=A>>>32-12|A<<12,y=y+M|0,U^=y,U=U>>>32-8|U<<8,O=O+U|0,M^=O,M=M>>>32-7|M<<7,_=_+A|0,v^=_,v=v>>>32-8|v<<8,x=x+v|0,A^=x,A=A>>>32-7|A<<7,E=E+f|0,T^=E,T=T>>>32-8|T<<8,j=j+T|0,f^=j,f=f>>>32-7|f<<7,p=p+r|0,c^=p,c=c>>>32-8|c<<8,I=I+c|0,r^=I,r=r>>>32-7|r<<7,p=p+f|0,v^=p,v=v>>>32-16|v<<16,O=O+v|0,f^=O,f=f>>>32-12|f<<12,E=E+M|0,c^=E,c=c>>>32-16|c<<16,x=x+c|0,M^=x,M=M>>>32-12|M<<12,y=y+A|0,T^=y,T=T>>>32-16|T<<16,I=I+T|0,A^=I,A=A>>>32-12|A<<12,_=_+r|0,U^=_,U=U>>>32-16|U<<16,j=j+U|0,r^=j,r=r>>>32-12|r<<12,y=y+A|0,T^=y,T=T>>>32-8|T<<8,I=I+T|0,A^=I,A=A>>>32-7|A<<7,_=_+r|0,U^=_,U=U>>>32-8|U<<8,j=j+U|0,r^=j,r=r>>>32-7|r<<7,E=E+M|0,c^=E,c=c>>>32-8|c<<8,x=x+c|0,M^=x,M=M>>>32-7|M<<7,p=p+f|0,v^=p,v=v>>>32-8|v<<8,O=O+v|0,f^=O,f=f>>>32-7|f<<7;return jt.writeUint32LE(p,a,0),jt.writeUint32LE(E,a,4),jt.writeUint32LE(y,a,8),jt.writeUint32LE(_,a,12),jt.writeUint32LE(c,a,16),jt.writeUint32LE(T,a,20),jt.writeUint32LE(U,a,24),jt.writeUint32LE(v,a,28),a}Dt.hchacha=vr;var wr={},Er={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});function a0(e,i,a){return~(e-1)&i|e-1&a}Ft.select=a0;function h0(e,i){return(e|0)-(i|0)-1>>>31&1}Ft.lessOrEqual=h0;function dr(e,i){if(e.length!==i.length)return 0;for(var a=0,g=0;g<e.length;g++)a|=e[g]^i[g];return 1&a-1>>>8}Ft.compare=dr;function o0(e,i){return e.length===0||i.length===0?!1:dr(e,i)!==0}Ft.equal=o0;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var i=Ft,a=Kt;e.DIGEST_LENGTH=16;var g=function(){function X(o){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var s=o[0]|o[1]<<8;this._r[0]=s&8191;var b=o[2]|o[3]<<8;this._r[1]=(s>>>13|b<<3)&8191;var w=o[4]|o[5]<<8;this._r[2]=(b>>>10|w<<6)&7939;var C=o[6]|o[7]<<8;this._r[3]=(w>>>7|C<<9)&8191;var B=o[8]|o[9]<<8;this._r[4]=(C>>>4|B<<12)&255,this._r[5]=B>>>1&8190;var d=o[10]|o[11]<<8;this._r[6]=(B>>>14|d<<2)&8191;var m=o[12]|o[13]<<8;this._r[7]=(d>>>11|m<<5)&8065;var D=o[14]|o[15]<<8;this._r[8]=(m>>>8|D<<8)&8191,this._r[9]=D>>>5&127,this._pad[0]=o[16]|o[17]<<8,this._pad[1]=o[18]|o[19]<<8,this._pad[2]=o[20]|o[21]<<8,this._pad[3]=o[22]|o[23]<<8,this._pad[4]=o[24]|o[25]<<8,this._pad[5]=o[26]|o[27]<<8,this._pad[6]=o[28]|o[29]<<8,this._pad[7]=o[30]|o[31]<<8}return X.prototype._blocks=function(o,s,b){for(var w=this._fin?0:2048,C=this._h[0],B=this._h[1],d=this._h[2],m=this._h[3],D=this._h[4],K=this._h[5],q=this._h[6],$=this._h[7],p=this._h[8],E=this._h[9],y=this._r[0],_=this._r[1],r=this._r[2],f=this._r[3],M=this._r[4],A=this._r[5],I=this._r[6],j=this._r[7],O=this._r[8],x=this._r[9];b>=16;){var c=o[s+0]|o[s+1]<<8;C+=c&8191;var T=o[s+2]|o[s+3]<<8;B+=(c>>>13|T<<3)&8191;var U=o[s+4]|o[s+5]<<8;d+=(T>>>10|U<<6)&8191;var v=o[s+6]|o[s+7]<<8;m+=(U>>>7|v<<9)&8191;var S=o[s+8]|o[s+9]<<8;D+=(v>>>4|S<<12)&8191,K+=S>>>1&8191;var H=o[s+10]|o[s+11]<<8;q+=(S>>>14|H<<2)&8191;var N=o[s+12]|o[s+13]<<8;$+=(H>>>11|N<<5)&8191;var V=o[s+14]|o[s+15]<<8;p+=(N>>>8|V<<8)&8191,E+=V>>>5|w;var P=0,Y=P;Y+=C*y,Y+=B*(5*x),Y+=d*(5*O),Y+=m*(5*j),Y+=D*(5*I),P=Y>>>13,Y&=8191,Y+=K*(5*A),Y+=q*(5*M),Y+=$*(5*f),Y+=p*(5*r),Y+=E*(5*_),P+=Y>>>13,Y&=8191;var J=P;J+=C*_,J+=B*y,J+=d*(5*x),J+=m*(5*O),J+=D*(5*j),P=J>>>13,J&=8191,J+=K*(5*I),J+=q*(5*A),J+=$*(5*M),J+=p*(5*f),J+=E*(5*r),P+=J>>>13,J&=8191;var tt=P;tt+=C*r,tt+=B*_,tt+=d*y,tt+=m*(5*x),tt+=D*(5*O),P=tt>>>13,tt&=8191,tt+=K*(5*j),tt+=q*(5*I),tt+=$*(5*A),tt+=p*(5*M),tt+=E*(5*f),P+=tt>>>13,tt&=8191;var u=P;u+=C*f,u+=B*r,u+=d*_,u+=m*y,u+=D*(5*x),P=u>>>13,u&=8191,u+=K*(5*O),u+=q*(5*j),u+=$*(5*I),u+=p*(5*A),u+=E*(5*M),P+=u>>>13,u&=8191;var l=P;l+=C*M,l+=B*f,l+=d*r,l+=m*_,l+=D*y,P=l>>>13,l&=8191,l+=K*(5*x),l+=q*(5*O),l+=$*(5*j),l+=p*(5*I),l+=E*(5*A),P+=l>>>13,l&=8191;var h=P;h+=C*A,h+=B*M,h+=d*f,h+=m*r,h+=D*_,P=h>>>13,h&=8191,h+=K*y,h+=q*(5*x),h+=$*(5*O),h+=p*(5*j),h+=E*(5*I),P+=h>>>13,h&=8191;var t=P;t+=C*I,t+=B*A,t+=d*M,t+=m*f,t+=D*r,P=t>>>13,t&=8191,t+=K*_,t+=q*y,t+=$*(5*x),t+=p*(5*O),t+=E*(5*j),P+=t>>>13,t&=8191;var n=P;n+=C*j,n+=B*I,n+=d*A,n+=m*M,n+=D*f,P=n>>>13,n&=8191,n+=K*r,n+=q*_,n+=$*y,n+=p*(5*x),n+=E*(5*O),P+=n>>>13,n&=8191;var G=P;G+=C*O,G+=B*j,G+=d*I,G+=m*A,G+=D*M,P=G>>>13,G&=8191,G+=K*f,G+=q*r,G+=$*_,G+=p*y,G+=E*(5*x),P+=G>>>13,G&=8191;var R=P;R+=C*x,R+=B*O,R+=d*j,R+=m*I,R+=D*A,P=R>>>13,R&=8191,R+=K*M,R+=q*f,R+=$*r,R+=p*_,R+=E*y,P+=R>>>13,R&=8191,P=(P<<2)+P|0,P=P+Y|0,Y=P&8191,P=P>>>13,J+=P,C=Y,B=J,d=tt,m=u,D=l,K=h,q=t,$=n,p=G,E=R,s+=16,b-=16}this._h[0]=C,this._h[1]=B,this._h[2]=d,this._h[3]=m,this._h[4]=D,this._h[5]=K,this._h[6]=q,this._h[7]=$,this._h[8]=p,this._h[9]=E},X.prototype.finish=function(o,s){s===void 0&&(s=0);var b=new Uint16Array(10),w,C,B,d;if(this._leftover){for(d=this._leftover,this._buffer[d++]=1;d<16;d++)this._buffer[d]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(w=this._h[1]>>>13,this._h[1]&=8191,d=2;d<10;d++)this._h[d]+=w,w=this._h[d]>>>13,this._h[d]&=8191;for(this._h[0]+=w*5,w=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=w,w=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=w,b[0]=this._h[0]+5,w=b[0]>>>13,b[0]&=8191,d=1;d<10;d++)b[d]=this._h[d]+w,w=b[d]>>>13,b[d]&=8191;for(b[9]-=1<<13,C=(w^1)-1,d=0;d<10;d++)b[d]&=C;for(C=~C,d=0;d<10;d++)this._h[d]=this._h[d]&C|b[d];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,B=this._h[0]+this._pad[0],this._h[0]=B&65535,d=1;d<8;d++)B=(this._h[d]+this._pad[d]|0)+(B>>>16)|0,this._h[d]=B&65535;return o[s+0]=this._h[0]>>>0,o[s+1]=this._h[0]>>>8,o[s+2]=this._h[1]>>>0,o[s+3]=this._h[1]>>>8,o[s+4]=this._h[2]>>>0,o[s+5]=this._h[2]>>>8,o[s+6]=this._h[3]>>>0,o[s+7]=this._h[3]>>>8,o[s+8]=this._h[4]>>>0,o[s+9]=this._h[4]>>>8,o[s+10]=this._h[5]>>>0,o[s+11]=this._h[5]>>>8,o[s+12]=this._h[6]>>>0,o[s+13]=this._h[6]>>>8,o[s+14]=this._h[7]>>>0,o[s+15]=this._h[7]>>>8,this._finished=!0,this},X.prototype.update=function(o){var s=0,b=o.length,w;if(this._leftover){w=16-this._leftover,w>b&&(w=b);for(var C=0;C<w;C++)this._buffer[this._leftover+C]=o[s+C];if(b-=w,s+=w,this._leftover+=w,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(b>=16&&(w=b-b%16,this._blocks(o,s,w),s+=w,b-=w),b){for(var C=0;C<b;C++)this._buffer[this._leftover+C]=o[s+C];this._leftover+=b}return this},X.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var o=new Uint8Array(16);return this.finish(o),o},X.prototype.clean=function(){return a.wipe(this._buffer),a.wipe(this._r),a.wipe(this._h),a.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},X}();e.Poly1305=g;function L(X,o){var s=new g(X);s.update(o);var b=s.digest();return s.clean(),b}e.oneTimeAuth=L;function F(X,o){return X.length!==e.DIGEST_LENGTH||o.length!==e.DIGEST_LENGTH?!1:i.equal(X,o)}e.equal=F})(Er);(function(e){Object.defineProperty(e,"__esModule",{value:!0});var i=Yt,a=Er,g=Kt,L=z,F=Ft;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var X=new Uint8Array(16),o=function(){function s(b){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,b.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(b)}return s.prototype.seal=function(b,w,C,B){if(b.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var d=new Uint8Array(16);d.set(b,d.length-b.length);var m=new Uint8Array(32);i.stream(this._key,d,m,4);var D=w.length+this.tagLength,K;if(B){if(B.length!==D)throw new Error("ChaCha20Poly1305: incorrect destination length");K=B}else K=new Uint8Array(D);return i.streamXOR(this._key,d,w,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),m,K.subarray(0,K.length-this.tagLength),C),g.wipe(d),K},s.prototype.open=function(b,w,C,B){if(b.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(w.length<this.tagLength)return null;var d=new Uint8Array(16);d.set(b,d.length-b.length);var m=new Uint8Array(32);i.stream(this._key,d,m,4);var D=new Uint8Array(this.tagLength);if(this._authenticate(D,m,w.subarray(0,w.length-this.tagLength),C),!F.equal(D,w.subarray(w.length-this.tagLength,w.length)))return null;var K=w.length-this.tagLength,q;if(B){if(B.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");q=B}else q=new Uint8Array(K);return i.streamXOR(this._key,d,w.subarray(0,w.length-this.tagLength),q,4),g.wipe(d),q},s.prototype.clean=function(){return g.wipe(this._key),this},s.prototype._authenticate=function(b,w,C,B){var d=new a.Poly1305(w);B&&(d.update(B),B.length%16>0&&d.update(X.subarray(B.length%16))),d.update(C),C.length%16>0&&d.update(X.subarray(C.length%16));var m=new Uint8Array(8);B&&L.writeUint64LE(B.length,m),d.update(m),L.writeUint64LE(C.length,m),d.update(m);for(var D=d.digest(),K=0;K<D.length;K++)b[K]=D[K];d.clean(),g.wipe(D),g.wipe(m)},s}();e.ChaCha20Poly1305=o})(wr);(function(e){Object.defineProperty(e,"__esModule",{value:!0});var i=Dt,a=wr,g=Kt;e.KEY_LENGTH=32,e.NONCE_LENGTH=24,e.TAG_LENGTH=16;var L=function(){function F(X){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,X.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(X)}return F.prototype.seal=function(X,o,s,b){if(X.length!==24)throw new Error("XChaCha20Poly1305: incorrect nonce length");var w=i.hchacha(this._key,X.subarray(0,16),new Uint8Array(32)),C=new Uint8Array(12);C.set(X.subarray(16),4);var B=new a.ChaCha20Poly1305(w),d=B.seal(C,o,s,b);return g.wipe(w),g.wipe(C),B.clean(),d},F.prototype.open=function(X,o,s,b){if(X.length!==24)throw new Error("XChaCha20Poly1305: incorrect nonce length");if(o.length<this.tagLength)return null;var w=i.hchacha(this._key,X.subarray(0,16),new Uint8Array(32)),C=new Uint8Array(12);C.set(X.subarray(16),4);var B=new a.ChaCha20Poly1305(w),d=B.open(C,o,s,b);return g.wipe(w),g.wipe(C),B.clean(),d},F.prototype.clean=function(){return g.wipe(this._key),this},F}();e.XChaCha20Poly1305=L})(Wr);export{Wr as a,gr as c,Qr as e,ir as r,Lr as s,Jr as x};
