import{v as b}from"./varint-034dba75.js";import{g as h}from"./multiformats-1a570ced.js";import{t as s,f as y}from"./uint8arrays-1b95a8ae.js";import{e as $}from"./@stablelib-91de8d10.js";import{t as l,p as u,a,E as v,b as p,c as g,d as x}from"./nist-weierstrauss-ca86d121.js";function _(i,e){const o=`did:key:${e}`,t=`${o}#${e}`;return{id:o,verificationMethod:[{id:t,type:"Secp256k1VerificationKey2018",controller:o,publicKeyBase58:s(i,"base58btc")}],authentication:[t],assertionMethod:[t],capabilityDelegation:[t],capabilityInvocation:[t]}}const M=Object.freeze(Object.defineProperty({__proto__:null,keyToDidDoc:_},Symbol.toStringTag,{value:"Module"}));function w(i){const e=new Uint8Array(i.length+2);return e[0]=236,e[1]=1,e.set(i,2),`z${s(e,"base58btc")}`}function S(i,e){const o=`did:key:${e}`,t=`${o}#${e}`,n=$.convertPublicKeyToX25519(i),c=`${o}#${w(n)}`;return{id:o,verificationMethod:[{id:t,type:"Ed25519VerificationKey2018",controller:o,publicKeyBase58:s(i,"base58btc")}],authentication:[t],assertionMethod:[t],capabilityDelegation:[t],capabilityInvocation:[t],keyAgreement:[{id:c,type:"X25519KeyAgreementKey2019",controller:o,publicKeyBase58:s(n,"base58btc")}]}}const E=Object.freeze(Object.defineProperty({__proto__:null,keyToDidDoc:S},Symbol.toStringTag,{value:"Module"}));function I(i,e){const o=`did:key:${e}`,t=`${o}#${e}`,n=D(i);return{id:o,verificationMethod:[{id:t,type:"JsonWebKey2020",controller:o,publicKeyJwk:{kty:"EC",crv:"P-256",x:n.xm,y:n.ym}}],authentication:[t],assertionMethod:[t],capabilityDelegation:[t],capabilityInvocation:[t]}}function D(i){if(!l(i))throw new TypeError("input must be a Uint8Array");const e=u(i),o=e.length/2;if(o==64)return a(e);if(o==65&&e.slice(0,2)=="04"){const t=e.slice(2);return a(t)}if(o==33&&(e.slice(0,2)=="03"||e.slice(0,2)=="02")){const t=y(e,"base16"),n=v(t);return p(n)}throw new Error("Unexpected pubKeyBytes")}const P=Object.freeze(Object.defineProperty({__proto__:null,keyToDidDoc:I,pubKeyBytesToXY:D},Symbol.toStringTag,{value:"Module"}));function j(i,e){const o=`did:key:${e}`,t=`${o}#${e}`,n=m(i);return{id:o,verificationMethod:[{id:t,type:"JsonWebKey2020",controller:o,publicKeyJwk:{kty:"EC",crv:"P-384",x:n.xm,y:n.ym}}],authentication:[t],assertionMethod:[t],capabilityDelegation:[t],capabilityInvocation:[t]}}function m(i){if(!l(i))throw new TypeError("input must be a Uint8Array");const e=u(i),o=e.length/2;if(o==96)return a(e);if(o==97&&e.slice(0,2)=="04"){const t=e.slice(2);return a(t)}if(o==49&&(e.slice(0,2)=="03"||e.slice(0,2)=="02")){const t=y(e,"base16"),n=g(t);return p(n)}throw new Error("Unexpected pubKeyBytes")}const O=Object.freeze(Object.defineProperty({__proto__:null,keyToDidDoc:j,pubKeyBytesToXY:m},Symbol.toStringTag,{value:"Module"}));function B(i,e){const o=`did:key:${e}`,t=`${o}#${e}`,n=K(i);return{id:o,verificationMethod:[{id:t,type:"JsonWebKey2020",controller:o,publicKeyJwk:{kty:"EC",crv:"P-521",x:n.xm,y:n.ym}}],authentication:[t],assertionMethod:[t],capabilityDelegation:[t],capabilityInvocation:[t]}}function K(i){if(!l(i))throw new TypeError("input must be a Uint8Array");const e=u(i);if(132<=e.length&&e.length<=134&&(e.slice(0,2)=="03"||e.slice(0,2)=="02")){const o=y(e,"base16"),t=x(o);return p(t)}throw new Error("Unexpected pubKeyBytes")}const X=Object.freeze(Object.defineProperty({__proto__:null,keyToDidDoc:B,pubKeyBytesToXY:K},Symbol.toStringTag,{value:"Module"})),C="application/did+ld+json",f="application/did+json",J={231:M,237:E,4608:P,4609:O,4610:X};function U(){return{key:async(i,e,o,t)=>{const n=t.accept||f,c={didResolutionMetadata:{contentType:n},didDocument:null,didDocumentMetadata:{}};try{const r=h.decode(e.id),k=b.decode(r),T=r.slice(b.decode.bytes),d=await J[k].keyToDidDoc(T,e.id);n===C?(d["@context"]="https://w3id.org/did/v1",c.didDocument=d):n===f?c.didDocument=d:(delete c.didResolutionMetadata.contentType,c.didResolutionMetadata.error="representationNotSupported")}catch(r){c.didResolutionMetadata.error="invalidDid",c.didResolutionMetadata.message=r.toString()}return c}}}const N={getResolver:U};export{N as K,U as g};
